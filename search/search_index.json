{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u76ee\u5f55 \u9996\u5148\u611f\u8c22\u60a8\u4f5c\u4e3a\u8bfb\u8005\u9605\u8bfb\u672c\u8bfe\u7a0b\uff0c\u6211\u4eec\u7684\u56e2\u961f\u5e0c\u671b\u80fd\u901a\u8fc7 100H \u7cfb\u5217\u8bfe\u7a0b\u7ed9\u4e88\u65b0\u4eba\u4ee5\u6307\u5f15\uff0c\u521d\u7248\u8bfe\u7a0b\u5c06\u5c3d\u5feb\u53d1\u5e03\uff0c\u656c\u8bf7\u671f\u5f85 \u4ee5\u4e0b\u4e3a\u672c\u8bfe\u7a0b\u7684\u57fa\u672c\u76ee\u5f55\uff0c\u6bcf\u7bc7\u8bfe\u7a0b\u90fd\u5c06\u4ece\u5b9e\u8df5\u64cd\u4f5c\u51fa\u53d1\u8fdb\u884c\u5b66\u4e60\uff0c\u4f60\u53ef\u4ee5\u5728\u7b2c\u56db\u4e2a\u7ae0\u8282 \u4f7f\u7528 Minikube \u642d\u5efa\u5355\u8282\u70b9\u96c6\u7fa4 \u5b66\u4e60\u5982\u4f55\u642d\u5efa\u5355\u8282\u70b9\u96c6\u7fa4 \u6587\u7ae0\u5217\u8868 \u5b8c\u6210\u60c5\u51b5 \u7ae0\u8282\u63cf\u8ff0 \u6700\u540e\u66f4\u65b0 Kubernetes \u6982\u8ff0 \u7b80\u5355\u4ecb\u7ecd Kubernetes \u7684\u6f14\u8fdb\u5386\u53f2\uff0c\u5e76\u8bf4\u660e Kubernetes \u80fd\u505a\u548c\u4e0d\u80fd\u505a\u7684\u4e8b\u60c5 20221026 Kubernetes \u67b6\u6784 \u4ece Node \u8282\u70b9\u8bb2\u8d77\uff0c\u7ed9\u521d\u5b66\u8005\u8be6\u7ec6\u8bb2\u6e05\u695a Kubernetes \u5e95\u5c42\u8bbe\u8ba1\u903b\u8f91\uff0c\u65b9\u4fbf\u8fdb\u884c\u540e\u7eed\u7684\u5b66\u4e60\u7406\u89e3 20221027 Kubernetes \u7ec4\u4ef6 Kubernetes \u7684\u8fd0\u884c\u79bb\u4e0d\u5f00\u591a\u79cd\u7ec4\u4ef6\u7684\u652f\u6491\uff0c\u672c\u6587\u8f83\u4e3a\u8be6\u7ec6\u7684\u4ecb\u7ecd\u4e86 Kubernetes \u4f7f\u7528\u7684\u51e0\u4e2a\u5173\u952e\u7ec4\u4ef6 20221026 \u4f7f\u7528 Minikube \u642d\u5efa\u5355\u8282\u70b9\u96c6\u7fa4 \u4f7f\u7528 Minikube \u4f5c\u4e3a\u672c\u8bfe\u7a0b\u7684\u7684\u57fa\u7840\u5b66\u4e60\u73af\u5883\uff0c\u5b8c\u6574\u642d\u5efa\u73af\u5883\u5e76\u90e8\u7f72\u4e00\u4e2a\u7b80\u5355\u7684\u670d\u52a1\u8fdb\u884c\u5b9e\u8df5 20221025 Kubernetes \u5bb9\u5668 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u5de5\u4f5c\u8d1f\u8f7d \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u7f51\u7edc\u6a21\u578b \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u670d\u52a1 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u8d1f\u8f7d\u5747\u8861 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u5377\u7ba1\u7406 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes ConfigMap \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes Secret \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u8d44\u6e90\u7ba1\u7406 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u8c03\u5ea6 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u6700\u4f73\u5b9e\u8df5 \u5185\u5bb9\u5f85\u8865\u5145","title":"Index"},{"location":"#_1","text":"\u9996\u5148\u611f\u8c22\u60a8\u4f5c\u4e3a\u8bfb\u8005\u9605\u8bfb\u672c\u8bfe\u7a0b\uff0c\u6211\u4eec\u7684\u56e2\u961f\u5e0c\u671b\u80fd\u901a\u8fc7 100H \u7cfb\u5217\u8bfe\u7a0b\u7ed9\u4e88\u65b0\u4eba\u4ee5\u6307\u5f15\uff0c\u521d\u7248\u8bfe\u7a0b\u5c06\u5c3d\u5feb\u53d1\u5e03\uff0c\u656c\u8bf7\u671f\u5f85 \u4ee5\u4e0b\u4e3a\u672c\u8bfe\u7a0b\u7684\u57fa\u672c\u76ee\u5f55\uff0c\u6bcf\u7bc7\u8bfe\u7a0b\u90fd\u5c06\u4ece\u5b9e\u8df5\u64cd\u4f5c\u51fa\u53d1\u8fdb\u884c\u5b66\u4e60\uff0c\u4f60\u53ef\u4ee5\u5728\u7b2c\u56db\u4e2a\u7ae0\u8282 \u4f7f\u7528 Minikube \u642d\u5efa\u5355\u8282\u70b9\u96c6\u7fa4 \u5b66\u4e60\u5982\u4f55\u642d\u5efa\u5355\u8282\u70b9\u96c6\u7fa4 \u6587\u7ae0\u5217\u8868 \u5b8c\u6210\u60c5\u51b5 \u7ae0\u8282\u63cf\u8ff0 \u6700\u540e\u66f4\u65b0 Kubernetes \u6982\u8ff0 \u7b80\u5355\u4ecb\u7ecd Kubernetes \u7684\u6f14\u8fdb\u5386\u53f2\uff0c\u5e76\u8bf4\u660e Kubernetes \u80fd\u505a\u548c\u4e0d\u80fd\u505a\u7684\u4e8b\u60c5 20221026 Kubernetes \u67b6\u6784 \u4ece Node \u8282\u70b9\u8bb2\u8d77\uff0c\u7ed9\u521d\u5b66\u8005\u8be6\u7ec6\u8bb2\u6e05\u695a Kubernetes \u5e95\u5c42\u8bbe\u8ba1\u903b\u8f91\uff0c\u65b9\u4fbf\u8fdb\u884c\u540e\u7eed\u7684\u5b66\u4e60\u7406\u89e3 20221027 Kubernetes \u7ec4\u4ef6 Kubernetes \u7684\u8fd0\u884c\u79bb\u4e0d\u5f00\u591a\u79cd\u7ec4\u4ef6\u7684\u652f\u6491\uff0c\u672c\u6587\u8f83\u4e3a\u8be6\u7ec6\u7684\u4ecb\u7ecd\u4e86 Kubernetes \u4f7f\u7528\u7684\u51e0\u4e2a\u5173\u952e\u7ec4\u4ef6 20221026 \u4f7f\u7528 Minikube \u642d\u5efa\u5355\u8282\u70b9\u96c6\u7fa4 \u4f7f\u7528 Minikube \u4f5c\u4e3a\u672c\u8bfe\u7a0b\u7684\u7684\u57fa\u7840\u5b66\u4e60\u73af\u5883\uff0c\u5b8c\u6574\u642d\u5efa\u73af\u5883\u5e76\u90e8\u7f72\u4e00\u4e2a\u7b80\u5355\u7684\u670d\u52a1\u8fdb\u884c\u5b9e\u8df5 20221025 Kubernetes \u5bb9\u5668 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u5de5\u4f5c\u8d1f\u8f7d \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u7f51\u7edc\u6a21\u578b \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u670d\u52a1 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u8d1f\u8f7d\u5747\u8861 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u5377\u7ba1\u7406 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes ConfigMap \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes Secret \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u8d44\u6e90\u7ba1\u7406 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u8c03\u5ea6 \u5185\u5bb9\u5f85\u8865\u5145 Kubernetes \u6700\u4f73\u5b9e\u8df5 \u5185\u5bb9\u5f85\u8865\u5145","title":"\u76ee\u5f55"},{"location":"Chapter01/chapter01/","text":"Kubernetes \u6982\u8ff0 \u7ae0\u8282\u8bf4\u660e \u4ecb\u7ecd\u6982\u5ff5\u4e0d\u662f\u672c\u9879\u76ee\u7684\u521d\u8877\uff0c\u672c\u9879\u76ee\u66f4\u7c7b\u4f3c\u4e8e \u6700\u4f73\u5b9e\u8df5\u624b\u518c \u3002\u5bf9\u4e8e Kubernetes \u6982\u8ff0 \u3001 Kubernetes \u67b6\u6784 \u3001 Kubernetes \u7ec4\u4ef6 \u4e09\u7bc7\u6587\u7ae0\uff0c\u6211\u4eec\u63a8\u8350\u9605\u8bfb Kubernetes \u6982\u5ff5 \u4f5c\u4e3a\u4e3b\u8981\u5b66\u4e60\u65b9\u5f0f \u6982\u8ff0\u3001\u67b6\u6784\u3001\u7ec4\u4ef6\u4e09\u7bc7\u6587\u7ae0\u5c06\u6458\u5f55\u5b98\u65b9\u6587\u6863\u4e2d\u7684\u5185\u5bb9\uff0c\u4ee5\u4fbf\u672c\u9879\u76ee\u7684\u9605\u8bfb\u5b8c\u6574\u6027\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u66f4\u6539\u6587\u672c\u4e2d\u7684\u4efb\u4f55\u5185\u5bb9\uff0c\u4ec5\u4f1a\u4fee\u6539\u660e\u663e\u51fa\u73b0\u9519\u8bef\u7684\u5730\u65b9\uff0c\u4fee\u6539\u5185\u5bb9\u4f1a\u4f7f\u7528 \u811a\u6ce8 \u7279\u522b\u6807\u6ce8 \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 \u6982\u8ff0 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a B73393F Kubernetes \u662f\u4e00\u4e2a\u53ef\u79fb\u690d\u3001\u53ef\u6269\u5c55\u7684\u5f00\u6e90\u5e73\u53f0\uff0c\u7528\u4e8e\u7ba1\u7406\u5bb9\u5668\u5316\u7684\u5de5\u4f5c\u8d1f\u8f7d\u548c\u670d\u52a1\uff0c\u53ef\u4fc3\u8fdb\u58f0\u660e\u5f0f\u914d\u7f6e\u548c\u81ea\u52a8\u5316 Kubernetes \u62e5\u6709\u4e00\u4e2a\u5e9e\u5927\u4e14\u5feb\u901f\u589e\u957f\u7684\u751f\u6001\uff0c\u5176\u670d\u52a1\u3001\u652f\u6301\u548c\u5de5\u5177\u7684\u4f7f\u7528\u8303\u56f4\u76f8\u5f53\u5e7f\u6cdb Kubernetes \u8fd9\u4e2a\u540d\u5b57\u6e90\u4e8e\u5e0c\u814a\u8bed\uff0c\u610f\u4e3a\u201c\u8235\u624b\u201d\u6216\u201c\u98de\u884c\u5458\u201d\u3002k8s \u8fd9\u4e2a\u7f29\u5199\u662f\u56e0\u4e3a k \u548c s \u4e4b\u95f4\u6709\u516b\u4e2a\u5b57\u7b26\u7684\u5173\u7cfb\u3002Google \u5728 2014 \u5e74\u5f00\u6e90\u4e86 Kubernetes \u9879\u76ee\u3002Kubernetes \u5efa\u7acb\u5728 Google \u5927\u89c4\u6a21\u8fd0\u884c\u751f\u4ea7\u5de5\u4f5c\u8d1f\u8f7d\u5341\u51e0\u5e74\u7ecf\u9a8c \u7684\u57fa\u7840\u4e0a\uff0c\u7ed3\u5408\u4e86\u793e\u533a\u4e2d\u6700\u4f18\u79c0\u7684\u60f3\u6cd5\u548c\u5b9e\u8df5 \u65f6\u5149\u56de\u6eaf \u8ba9\u6211\u4eec\u56de\u987e\u4e00\u4e0b\u4e3a\u4f55 Kubernetes \u80fd\u591f\u88e8\u76ca\u56db\u65b9 \u4f20\u7edf\u90e8\u7f72\u65f6\u4ee3\uff1a \u65e9\u671f\uff0c\u5404\u4e2a\u7ec4\u7ec7\u662f\u5728\u7269\u7406\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u3002\u7531\u4e8e\u65e0\u6cd5\u9650\u5236\u5728\u7269\u7406\u670d\u52a1\u5668\u4e2d\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u8d44\u6e90\u4f7f\u7528\uff0c\u56e0\u6b64\u4f1a\u5bfc\u81f4\u8d44\u6e90\u5206\u914d\u95ee\u9898\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5728\u540c\u4e00\u53f0\u7269\u7406\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff0c\u5219\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5360\u7528\u5927\u90e8\u5206\u8d44\u6e90\u7684\u60c5\u51b5\uff0c\u800c\u5bfc\u81f4\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684\u6027\u80fd\u4e0b\u964d\u3002\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\u662f\u5c06\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u8fd0\u884c\u5728\u4e0d\u540c\u7684\u7269\u7406\u670d\u52a1\u5668\u4e0a\uff0c\u4f46\u662f\u5f53\u67d0\u4e2a\u5e94\u7528\u7a0b\u5f0f\u8d44\u6e90\u5229\u7528\u7387\u4e0d\u9ad8\u65f6\uff0c\u5269\u4f59\u8d44\u6e90\u65e0\u6cd5\u88ab\u5206\u914d\u7ed9\u5176\u4ed6\u5e94\u7528\u7a0b\u5f0f\uff0c\u800c\u4e14\u7ef4\u62a4\u8bb8\u591a\u7269\u7406\u670d\u52a1\u5668\u7684\u6210\u672c\u5f88\u9ad8 \u865a\u62df\u5316\u90e8\u7f72\u65f6\u4ee3\uff1a \u56e0\u6b64\uff0c\u865a\u62df\u5316\u6280\u672f\u88ab\u5f15\u5165\u4e86\u3002\u865a\u62df\u5316\u6280\u672f\u5141\u8bb8\u4f60\u5728\u5355\u4e2a\u7269\u7406\u670d\u52a1\u5668\u7684 CPU \u4e0a\u8fd0\u884c\u591a\u53f0\u865a\u62df\u673a\uff08VM\uff09\u3002\u865a\u62df\u5316\u80fd\u4f7f\u5e94\u7528\u7a0b\u5e8f\u5728\u4e0d\u540c VM \u4e4b\u95f4\u88ab\u5f7c\u6b64\u9694\u79bb\uff0c\u4e14\u80fd\u63d0\u4f9b\u4e00\u5b9a\u7a0b\u5ea6\u7684\u5b89\u5168\u6027\uff0c\u56e0\u4e3a\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684\u4fe1\u606f\u4e0d\u80fd\u88ab\u53e6\u4e00\u5e94\u7528\u7a0b\u5e8f\u968f\u610f\u8bbf\u95ee \u865a\u62df\u5316\u6280\u672f\u80fd\u591f\u66f4\u597d\u5730\u5229\u7528\u7269\u7406\u670d\u52a1\u5668\u7684\u8d44\u6e90\uff0c\u5e76\u4e14\u56e0\u4e3a\u53ef\u8f7b\u677e\u5730\u6dfb\u52a0\u6216\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\uff0c\u800c\u56e0\u6b64\u53ef\u4ee5\u5177\u6709\u66f4\u9ad8\u7684\u53ef\u6269\u7f29\u6027\uff0c\u4ee5\u53ca\u964d\u4f4e\u786c\u4ef6\u6210\u672c\u7b49\u7b49\u7684\u597d\u5904\u3002\u901a\u8fc7\u865a\u62df\u5316\uff0c\u4f60\u53ef\u4ee5\u5c06\u4e00\u7ec4\u7269\u7406\u8d44\u6e90\u5448\u73b0\u4e3a\u53ef\u4e22\u5f03\u7684\u865a\u62df\u673a\u96c6\u7fa4 \u6bcf\u4e2a VM \u662f\u4e00\u53f0\u5b8c\u6574\u7684\u8ba1\u7b97\u673a\uff0c\u5728\u865a\u62df\u5316\u786c\u4ef6\u4e4b\u4e0a\u8fd0\u884c\u6240\u6709\u7ec4\u4ef6\uff0c\u5305\u62ec\u5176\u81ea\u5df1\u7684\u64cd\u4f5c\u7cfb\u7edf \u5bb9\u5668\u90e8\u7f72\u65f6\u4ee3\uff1a \u5bb9\u5668\u7c7b\u4f3c\u4e8e VM\uff0c\u4f46\u662f\u66f4\u5bbd\u677e\u7684\u9694\u79bb\u7279\u6027\uff0c\u4f7f\u5bb9\u5668\u4e4b\u95f4\u53ef\u4ee5\u5171\u4eab\u64cd\u4f5c\u7cfb\u7edf\uff08OS\uff09\u3002\u56e0\u6b64\uff0c\u5bb9\u5668\u6bd4\u8d77 VM \u88ab\u8ba4\u4e3a\u662f\u66f4\u8f7b\u91cf\u7ea7\u7684\u3002\u4e14\u4e0e VM \u7c7b\u4f3c\uff0c\u6bcf\u4e2a\u5bb9\u5668\u90fd\u5177\u6709\u81ea\u5df1\u7684\u6587\u4ef6\u7cfb\u7edf\u3001CPU\u3001\u5185\u5b58\u3001\u8fdb\u7a0b\u7a7a\u95f4\u7b49\u3002\u7531\u4e8e\u5b83\u4eec\u4e0e\u57fa\u7840\u67b6\u6784\u5206\u79bb\uff0c\u56e0\u6b64\u53ef\u4ee5\u8de8\u4e91\u548c OS \u53d1\u884c\u7248\u672c\u8fdb\u884c\u79fb\u690d \u5bb9\u5668\u56e0\u5177\u6709\u8bb8\u591a\u4f18\u52bf\u800c\u53d8\u5f97\u6d41\u884c\u8d77\u6765\uff0c\u4f8b\u5982\uff1a \u654f\u6377\u5e94\u7528\u7a0b\u5e8f\u7684\u521b\u5efa\u548c\u90e8\u7f72\uff1a\u4e0e\u4f7f\u7528 VM \u955c\u50cf\u76f8\u6bd4\uff0c\u63d0\u9ad8\u4e86\u5bb9\u5668\u955c\u50cf\u521b\u5efa\u7684\u7b80\u4fbf\u6027\u548c\u6548\u7387 \u6301\u7eed\u5f00\u53d1\u3001\u96c6\u6210\u548c\u90e8\u7f72\uff1a\u901a\u8fc7\u5feb\u901f\u7b80\u5355\u7684\u56de\u6eda\uff08\u7531\u4e8e\u955c\u50cf\u4e0d\u53ef\u53d8\u6027\uff09\uff0c\u63d0\u4f9b\u53ef\u9760\u4e14\u9891\u7e41\u7684\u5bb9\u5668\u955c\u50cf\u6784\u5efa\u548c\u90e8\u7f72 \u5173\u6ce8\u5f00\u53d1\u4e0e\u8fd0\u7ef4\u7684\u5206\u79bb\uff1a\u5728\u6784\u5efa\u3001\u53d1\u5e03\u65f6\u521b\u5efa\u5e94\u7528\u7a0b\u5e8f\u5bb9\u5668\u955c\u50cf\uff0c\u800c\u4e0d\u662f\u5728\u90e8\u7f72\u65f6\uff0c\u4ece\u800c\u5c06\u5e94\u7528\u7a0b\u5e8f\u4e0e\u57fa\u7840\u67b6\u6784\u5206\u79bb \u53ef\u89c2\u5bdf\u6027\uff1a\u4e0d\u4ec5\u53ef\u4ee5\u663e\u793a OS \u7ea7\u522b\u7684\u4fe1\u606f\u548c\u6307\u6807\uff0c\u8fd8\u53ef\u4ee5\u663e\u793a\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\u72b6\u51b5\u548c\u5176\u4ed6\u6307\u6807\u4fe1\u53f7 \u8de8\u5f00\u53d1\u3001\u6d4b\u8bd5\u548c\u751f\u4ea7\u7684\u73af\u5883\u4e00\u81f4\u6027\uff1a\u5728\u7b14\u8bb0\u672c\u8ba1\u7b97\u673a\u4e0a\u4e5f\u53ef\u4ee5\u548c\u5728\u4e91\u4e2d\u8fd0\u884c\u4e00\u6837\u7684\u5e94\u7528\u7a0b\u5e8f \u8de8\u4e91\u548c\u64cd\u4f5c\u7cfb\u7edf\u53d1\u884c\u7248\u672c\u7684\u53ef\u79fb\u690d\u6027\uff1a\u53ef\u5728 Ubuntu\u3001RHEL\u3001CoreOS\u3001\u672c\u5730\u3001Google Kubernetes Engine \u548c\u5176\u4ed6\u4efb\u4f55\u5730\u65b9\u8fd0\u884c \u4ee5\u5e94\u7528\u7a0b\u5e8f\u4e3a\u4e2d\u5fc3\u7684\u7ba1\u7406\uff1a\u63d0\u9ad8\u62bd\u8c61\u7ea7\u522b\uff0c\u4ece\u5728\u865a\u62df\u786c\u4ef6\u4e0a\u8fd0\u884c OS \u5230\u4f7f\u7528\u903b\u8f91\u8d44\u6e90\u5728 OS \u4e0a\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f \u677e\u6563\u8026\u5408\u3001\u5206\u5e03\u5f0f\u3001\u5f39\u6027\u3001\u89e3\u653e\u7684\u5fae\u670d\u52a1\uff1a\u5e94\u7528\u7a0b\u5e8f\u88ab\u5206\u89e3\u6210\u8f83\u5c0f\u7684\u72ec\u7acb\u90e8\u5206\uff0c\u5e76\u4e14\u53ef\u4ee5\u52a8\u6001\u90e8\u7f72\u548c\u7ba1\u7406 - \u800c\u4e0d\u662f\u5728\u4e00\u53f0\u5927\u578b\u5355\u673a\u4e0a\u6574\u4f53\u8fd0\u884c \u8d44\u6e90\u9694\u79bb\uff1a\u53ef\u9884\u6d4b\u7684\u5e94\u7528\u7a0b\u5e8f\u6027\u80fd \u8d44\u6e90\u5229\u7528\uff1a\u9ad8\u6548\u7387\u548c\u9ad8\u5bc6\u5ea6 \u4e3a\u4ec0\u4e48\u9700\u8981 Kubernetes\uff0c\u5b83\u80fd\u505a\u4ec0\u4e48\uff1f \u5bb9\u5668\u662f\u6253\u5305\u548c\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u7684\u597d\u65b9\u5f0f\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u4f60\u9700\u8981\u7ba1\u7406\u8fd0\u884c\u7740\u5e94\u7528\u7a0b\u5e8f\u7684\u5bb9\u5668\uff0c\u5e76\u786e\u4fdd\u670d\u52a1\u4e0d\u4f1a\u4e0b\u7ebf\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2a\u5bb9\u5668\u53d1\u751f\u6545\u969c\uff0c\u5219\u4f60\u9700\u8981\u542f\u52a8\u53e6\u4e00\u4e2a\u5bb9\u5668\u3002\u5982\u679c\u6b64\u884c\u4e3a\u4ea4\u7531\u7ed9\u7cfb\u7edf\u5904\u7406\uff0c\u662f\u4e0d\u662f\u4f1a\u66f4\u5bb9\u6613\u4e00\u4e9b\uff1f \u8fd9\u5c31\u662f Kubernetes \u8981\u6765\u505a\u7684\u4e8b\u60c5\uff01Kubernetes \u4e3a\u4f60\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53ef\u5f39\u6027\u8fd0\u884c\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6846\u67b6\u3002Kubernetes \u4f1a\u6ee1\u8db3\u4f60\u7684\u6269\u5c55\u8981\u6c42\u3001\u6545\u969c\u8f6c\u79fb\u4f60\u7684\u5e94\u7528\u3001\u63d0\u4f9b\u90e8\u7f72\u6a21\u5f0f\u7b49\u3002\u4f8b\u5982\uff0cKubernetes \u53ef\u4ee5\u8f7b\u677e\u7ba1\u7406\u7cfb\u7edf\u7684 Canary \u90e8\u7f72 Kubernetes \u4e3a\u4f60\u63d0\u4f9b\uff1a \u670d\u52a1\u53d1\u73b0\u548c\u8d1f\u8f7d\u5747\u8861 Kubernetes \u53ef\u4ee5\u4f7f\u7528 DNS \u540d\u79f0\u6216\u81ea\u5df1\u7684 IP \u5730\u5740\u6765\u66dd\u9732\u5bb9\u5668\u3002\u5982\u679c\u8fdb\u5165\u5bb9\u5668\u7684\u6d41\u91cf\u5f88\u5927\uff0cKubernetes \u53ef\u4ee5\u8d1f\u8f7d\u5747\u8861\u5e76\u5206\u914d\u7f51\u7edc\u6d41\u91cf\uff0c\u4ece\u800c\u4f7f\u90e8\u7f72\u7a33\u5b9a \u5b58\u50a8\u7f16\u6392 Kubernetes \u5141\u8bb8\u4f60\u81ea\u52a8\u6302\u8f7d\u4f60\u9009\u62e9\u7684\u5b58\u50a8\u7cfb\u7edf\uff0c\u4f8b\u5982\u672c\u5730\u5b58\u50a8\u3001\u516c\u5171\u4e91\u63d0\u4f9b\u5546\u7b49 \u81ea\u52a8\u90e8\u7f72\u548c\u56de\u6eda \u4f60\u53ef\u4ee5\u4f7f\u7528 Kubernetes \u63cf\u8ff0\u5df2\u90e8\u7f72\u5bb9\u5668\u7684\u6240\u9700\u72b6\u6001\uff0c\u5b83\u53ef\u4ee5\u4ee5\u53d7\u63a7\u7684\u901f\u7387\u5c06\u5b9e\u9645\u72b6\u6001\u66f4\u6539\u4e3a\u671f\u671b\u72b6\u6001\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u81ea\u52a8\u5316 Kubernetes \u6765\u4e3a\u4f60\u7684\u90e8\u7f72\u521b\u5efa\u65b0\u5bb9\u5668\uff0c\u5220\u9664\u73b0\u6709\u5bb9\u5668\u5e76\u5c06\u5b83\u4eec\u7684\u6240\u6709\u8d44\u6e90\u7528\u4e8e\u65b0\u5bb9\u5668 \u81ea\u52a8\u5b8c\u6210\u88c5\u7bb1\u8ba1\u7b97 \u4f60\u4e3a Kubernetes \u63d0\u4f9b\u8bb8\u591a\u8282\u70b9\u7ec4\u6210\u7684\u96c6\u7fa4\uff0c\u5728\u8fd9\u4e2a\u96c6\u7fa4\u4e0a\u8fd0\u884c\u5bb9\u5668\u5316\u7684\u4efb\u52a1\u3002\u4f60\u544a\u8bc9 Kubernetes \u6bcf\u4e2a\u5bb9\u5668\u9700\u8981\u591a\u5c11 CPU \u548c\u5185\u5b58 (RAM)\u3002Kubernetes \u53ef\u4ee5\u5c06\u8fd9\u4e9b\u5bb9\u5668\u6309\u5b9e\u9645\u60c5\u51b5\u8c03\u5ea6\u5230\u4f60\u7684\u8282\u70b9\u4e0a\uff0c\u4ee5\u6700\u4f73\u65b9\u5f0f\u5229\u7528\u4f60\u7684\u8d44\u6e90 \u81ea\u6211\u4fee\u590d Kubernetes \u5c06\u91cd\u65b0\u542f\u52a8\u5931\u8d25\u7684\u5bb9\u5668\u3001\u66ff\u6362\u5bb9\u5668\u3001\u6740\u6b7b\u4e0d\u54cd\u5e94\u7528\u6237\u5b9a\u4e49\u7684\u8fd0\u884c\u72b6\u51b5\u68c0\u67e5\u7684\u5bb9\u5668\uff0c\u5e76\u4e14\u5728\u51c6\u5907\u597d\u670d\u52a1\u4e4b\u524d\u4e0d\u5c06\u5176\u901a\u544a\u7ed9\u5ba2\u6237\u7aef \u5bc6\u94a5\u4e0e\u914d\u7f6e\u7ba1\u7406 Kubernetes \u5141\u8bb8\u4f60\u5b58\u50a8\u548c\u7ba1\u7406\u654f\u611f\u4fe1\u606f\uff0c\u4f8b\u5982\u5bc6\u7801\u3001OAuth \u4ee4\u724c\u548c ssh \u5bc6\u94a5\u3002\u4f60\u53ef\u4ee5\u5728\u4e0d\u91cd\u5efa\u5bb9\u5668\u955c\u50cf\u7684\u60c5\u51b5\u4e0b\u90e8\u7f72\u548c\u66f4\u65b0\u5bc6\u94a5\u548c\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\uff0c\u4e5f\u65e0\u9700\u5728\u5806\u6808\u914d\u7f6e\u4e2d\u66b4\u9732\u5bc6\u94a5 Kubernetes \u4e0d\u662f\u4ec0\u4e48 Kubernetes \u4e0d\u662f\u4f20\u7edf\u7684\u3001\u5305\u7f57\u4e07\u8c61\u7684 PaaS\uff08\u5e73\u53f0\u5373\u670d\u52a1\uff09\u7cfb\u7edf\u3002\u7531\u4e8e Kubernetes \u662f\u5728\u5bb9\u5668\u7ea7\u522b\u8fd0\u884c\uff0c\u800c\u975e\u5728\u786c\u4ef6\u7ea7\u522b\uff0c\u5b83\u63d0\u4f9b\u4e86 PaaS \u4ea7\u54c1\u5171\u6709\u7684\u4e00\u4e9b\u666e\u904d\u9002\u7528\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u90e8\u7f72\u3001\u6269\u5c55\u3001\u8d1f\u8f7d\u5747\u8861\uff0c\u5141\u8bb8\u7528\u6237\u96c6\u6210\u4ed6\u4eec\u7684\u65e5\u5fd7\u8bb0\u5f55\u3001\u76d1\u63a7\u548c\u8b66\u62a5\u65b9\u6848\u3002\u4f46\u662f\uff0cKubernetes \u4e0d\u662f\u5355\u4f53\u5f0f\uff08monolithic\uff09\u7cfb\u7edf\uff0c\u90a3\u4e9b\u9ed8\u8ba4\u89e3\u51b3\u65b9\u6848\u90fd\u662f\u53ef\u9009\u3001\u53ef\u63d2\u62d4\u7684\u3002Kubernetes \u4e3a\u6784\u5efa\u5f00\u53d1\u4eba\u5458\u5e73\u53f0\u63d0\u4f9b\u4e86\u57fa\u7840\uff0c\u4f46\u662f\u5728\u91cd\u8981\u7684\u5730\u65b9\u4fdd\u7559\u4e86\u7528\u6237\u9009\u62e9\u6743\uff0c\u80fd\u6709\u66f4\u9ad8\u7684\u7075\u6d3b\u6027 Kubernetes\uff1a \u4e0d\u9650\u5236\u652f\u6301\u7684\u5e94\u7528\u7a0b\u5e8f\u7c7b\u578b Kubernetes \u65e8\u5728\u652f\u6301\u6781\u5176\u591a\u79cd\u591a\u6837\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5305\u62ec\u65e0\u72b6\u6001\u3001\u6709\u72b6\u6001\u548c\u6570\u636e\u5904\u7406\u5de5\u4f5c\u8d1f\u8f7d\u3002\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\uff0c\u90a3\u4e48\u5b83\u5e94\u8be5\u53ef\u4ee5\u5728 Kubernetes \u4e0a\u5f88\u597d\u5730\u8fd0\u884c \u4e0d\u90e8\u7f72\u6e90\u4ee3\u7801\uff0c\u4e5f\u4e0d\u6784\u5efa\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f \u6301\u7eed\u96c6\u6210\uff08CI\uff09\u3001\u4ea4\u4ed8\u548c\u90e8\u7f72\uff08CI/CD\uff09\u5de5\u4f5c\u6d41\u53d6\u51b3\u4e8e\u7ec4\u7ec7\u7684\u6587\u5316\u548c\u504f\u597d\u4ee5\u53ca\u6280\u672f\u8981\u6c42 \u4e0d\u63d0\u4f9b\u5e94\u7528\u7a0b\u5e8f\u7ea7\u522b\u7684\u670d\u52a1\u4f5c\u4e3a\u5185\u7f6e\u670d\u52a1 \u4f8b\u5982\u4e2d\u95f4\u4ef6\uff08\u4f8b\u5982\u6d88\u606f\u4e2d\u95f4\u4ef6\uff09\u3001\u6570\u636e\u5904\u7406\u6846\u67b6\uff08\u4f8b\u5982 Spark\uff09\u3001\u6570\u636e\u5e93\uff08\u4f8b\u5982 MySQL\uff09\u3001\u7f13\u5b58\u3001\u96c6\u7fa4\u5b58\u50a8\u7cfb\u7edf\uff08\u4f8b\u5982 Ceph\uff09\u3002\u8fd9\u6837\u7684\u7ec4\u4ef6\u53ef\u4ee5\u5728 Kubernetes \u4e0a\u8fd0\u884c\uff0c\u5e76\u4e14/\u6216\u8005\u53ef\u4ee5\u7531\u8fd0\u884c\u5728Kubernetes \u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u53ef\u79fb\u690d\u673a\u5236\uff08\u4f8b\u5982 \u5f00\u653e\u670d\u52a1\u4ee3\u7406 \uff09\u6765\u8bbf\u95ee \u4e0d\u662f\u65e5\u5fd7\u8bb0\u5f55\u3001\u76d1\u89c6\u6216\u8b66\u62a5\u7684\u89e3\u51b3\u65b9\u6848 \u5b83\u96c6\u6210\u4e86\u4e00\u4e9b\u529f\u80fd\u4f5c\u4e3a\u6982\u5ff5\u8bc1\u660e\uff0c\u5e76\u63d0\u4f9b\u4e86\u6536\u96c6\u548c\u5bfc\u51fa\u6307\u6807\u7684\u673a\u5236 \u4e0d\u63d0\u4f9b\u4e5f\u4e0d\u8981\u6c42\u914d\u7f6e\u7528\u7684\u8bed\u8a00\u3001\u7cfb\u7edf\uff08\u4f8b\u5982 jsonnet\uff09 \u5b83\u63d0\u4f9b\u4e86\u58f0\u660e\u6027 API\uff0c\u8be5\u58f0\u660e\u6027 API \u53ef\u4ee5\u7531\u4efb\u610f\u5f62\u5f0f\u7684\u58f0\u660e\u6027\u89c4\u8303\u6240\u6784\u6210 \u4e0d\u63d0\u4f9b\u4e5f\u4e0d\u91c7\u7528\u4efb\u4f55\u5168\u9762\u7684\u673a\u5668\u914d\u7f6e\u3001\u7ef4\u62a4\u3001\u7ba1\u7406\u6216\u81ea\u6211\u4fee\u590d\u7cfb\u7edf \u6b64\u5916\uff0c Kubernetes \u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u7f16\u6392\u7cfb\u7edf \u5b9e\u9645\u4e0a\u5b83\u6d88\u9664\u4e86\u7f16\u6392\u7684\u9700\u8981\u3002\u7f16\u6392\u7684\u6280\u672f\u5b9a\u4e49\u662f\u6267\u884c\u5df2\u5b9a\u4e49\u7684\u5de5\u4f5c\u6d41\u7a0b\uff1a\u9996\u5148\u6267\u884c A\uff0c\u7136\u540e\u6267\u884c B\uff0c\u518d\u6267\u884c C\u3002\u800c Kubernetes \u5305\u542b\u4e86\u4e00\u7ec4\u72ec\u7acb\u53ef\u7ec4\u5408\u7684\u63a7\u5236\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u8fde\u7eed\u5730\u5c06\u5f53\u524d\u72b6\u6001\u9a71\u52a8\u5230\u6240\u63d0\u4f9b\u7684\u9884\u671f\u72b6\u6001\u3002\u4f60\u4e0d\u9700\u8981\u5728\u4e4e\u5982\u4f55\u4ece A \u79fb\u52a8\u5230 C\uff0c\u4e5f\u4e0d\u9700\u8981\u96c6\u4e2d\u63a7\u5236\uff0c\u8fd9\u4f7f\u5f97\u7cfb\u7edf\u66f4\u6613\u4e8e\u4f7f\u7528\u4e14\u529f\u80fd\u66f4\u5f3a\u5927\u3001\u7cfb\u7edf\u66f4\u5065\u58ee\uff0c\u66f4\u4e3a\u5f39\u6027\u548c\u53ef\u6269\u5c55","title":"Kubernetes \u6982\u8ff0"},{"location":"Chapter01/chapter01/#kubernetes","text":"\u7ae0\u8282\u8bf4\u660e \u4ecb\u7ecd\u6982\u5ff5\u4e0d\u662f\u672c\u9879\u76ee\u7684\u521d\u8877\uff0c\u672c\u9879\u76ee\u66f4\u7c7b\u4f3c\u4e8e \u6700\u4f73\u5b9e\u8df5\u624b\u518c \u3002\u5bf9\u4e8e Kubernetes \u6982\u8ff0 \u3001 Kubernetes \u67b6\u6784 \u3001 Kubernetes \u7ec4\u4ef6 \u4e09\u7bc7\u6587\u7ae0\uff0c\u6211\u4eec\u63a8\u8350\u9605\u8bfb Kubernetes \u6982\u5ff5 \u4f5c\u4e3a\u4e3b\u8981\u5b66\u4e60\u65b9\u5f0f \u6982\u8ff0\u3001\u67b6\u6784\u3001\u7ec4\u4ef6\u4e09\u7bc7\u6587\u7ae0\u5c06\u6458\u5f55\u5b98\u65b9\u6587\u6863\u4e2d\u7684\u5185\u5bb9\uff0c\u4ee5\u4fbf\u672c\u9879\u76ee\u7684\u9605\u8bfb\u5b8c\u6574\u6027\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u66f4\u6539\u6587\u672c\u4e2d\u7684\u4efb\u4f55\u5185\u5bb9\uff0c\u4ec5\u4f1a\u4fee\u6539\u660e\u663e\u51fa\u73b0\u9519\u8bef\u7684\u5730\u65b9\uff0c\u4fee\u6539\u5185\u5bb9\u4f1a\u4f7f\u7528 \u811a\u6ce8 \u7279\u522b\u6807\u6ce8 \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 \u6982\u8ff0 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a B73393F Kubernetes \u662f\u4e00\u4e2a\u53ef\u79fb\u690d\u3001\u53ef\u6269\u5c55\u7684\u5f00\u6e90\u5e73\u53f0\uff0c\u7528\u4e8e\u7ba1\u7406\u5bb9\u5668\u5316\u7684\u5de5\u4f5c\u8d1f\u8f7d\u548c\u670d\u52a1\uff0c\u53ef\u4fc3\u8fdb\u58f0\u660e\u5f0f\u914d\u7f6e\u548c\u81ea\u52a8\u5316 Kubernetes \u62e5\u6709\u4e00\u4e2a\u5e9e\u5927\u4e14\u5feb\u901f\u589e\u957f\u7684\u751f\u6001\uff0c\u5176\u670d\u52a1\u3001\u652f\u6301\u548c\u5de5\u5177\u7684\u4f7f\u7528\u8303\u56f4\u76f8\u5f53\u5e7f\u6cdb Kubernetes \u8fd9\u4e2a\u540d\u5b57\u6e90\u4e8e\u5e0c\u814a\u8bed\uff0c\u610f\u4e3a\u201c\u8235\u624b\u201d\u6216\u201c\u98de\u884c\u5458\u201d\u3002k8s \u8fd9\u4e2a\u7f29\u5199\u662f\u56e0\u4e3a k \u548c s \u4e4b\u95f4\u6709\u516b\u4e2a\u5b57\u7b26\u7684\u5173\u7cfb\u3002Google \u5728 2014 \u5e74\u5f00\u6e90\u4e86 Kubernetes \u9879\u76ee\u3002Kubernetes \u5efa\u7acb\u5728 Google \u5927\u89c4\u6a21\u8fd0\u884c\u751f\u4ea7\u5de5\u4f5c\u8d1f\u8f7d\u5341\u51e0\u5e74\u7ecf\u9a8c \u7684\u57fa\u7840\u4e0a\uff0c\u7ed3\u5408\u4e86\u793e\u533a\u4e2d\u6700\u4f18\u79c0\u7684\u60f3\u6cd5\u548c\u5b9e\u8df5","title":"Kubernetes \u6982\u8ff0"},{"location":"Chapter01/chapter01/#going-back-in-time","text":"\u8ba9\u6211\u4eec\u56de\u987e\u4e00\u4e0b\u4e3a\u4f55 Kubernetes \u80fd\u591f\u88e8\u76ca\u56db\u65b9 \u4f20\u7edf\u90e8\u7f72\u65f6\u4ee3\uff1a \u65e9\u671f\uff0c\u5404\u4e2a\u7ec4\u7ec7\u662f\u5728\u7269\u7406\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u3002\u7531\u4e8e\u65e0\u6cd5\u9650\u5236\u5728\u7269\u7406\u670d\u52a1\u5668\u4e2d\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u8d44\u6e90\u4f7f\u7528\uff0c\u56e0\u6b64\u4f1a\u5bfc\u81f4\u8d44\u6e90\u5206\u914d\u95ee\u9898\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5728\u540c\u4e00\u53f0\u7269\u7406\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff0c\u5219\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5360\u7528\u5927\u90e8\u5206\u8d44\u6e90\u7684\u60c5\u51b5\uff0c\u800c\u5bfc\u81f4\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684\u6027\u80fd\u4e0b\u964d\u3002\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\u662f\u5c06\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u8fd0\u884c\u5728\u4e0d\u540c\u7684\u7269\u7406\u670d\u52a1\u5668\u4e0a\uff0c\u4f46\u662f\u5f53\u67d0\u4e2a\u5e94\u7528\u7a0b\u5f0f\u8d44\u6e90\u5229\u7528\u7387\u4e0d\u9ad8\u65f6\uff0c\u5269\u4f59\u8d44\u6e90\u65e0\u6cd5\u88ab\u5206\u914d\u7ed9\u5176\u4ed6\u5e94\u7528\u7a0b\u5f0f\uff0c\u800c\u4e14\u7ef4\u62a4\u8bb8\u591a\u7269\u7406\u670d\u52a1\u5668\u7684\u6210\u672c\u5f88\u9ad8 \u865a\u62df\u5316\u90e8\u7f72\u65f6\u4ee3\uff1a \u56e0\u6b64\uff0c\u865a\u62df\u5316\u6280\u672f\u88ab\u5f15\u5165\u4e86\u3002\u865a\u62df\u5316\u6280\u672f\u5141\u8bb8\u4f60\u5728\u5355\u4e2a\u7269\u7406\u670d\u52a1\u5668\u7684 CPU \u4e0a\u8fd0\u884c\u591a\u53f0\u865a\u62df\u673a\uff08VM\uff09\u3002\u865a\u62df\u5316\u80fd\u4f7f\u5e94\u7528\u7a0b\u5e8f\u5728\u4e0d\u540c VM \u4e4b\u95f4\u88ab\u5f7c\u6b64\u9694\u79bb\uff0c\u4e14\u80fd\u63d0\u4f9b\u4e00\u5b9a\u7a0b\u5ea6\u7684\u5b89\u5168\u6027\uff0c\u56e0\u4e3a\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684\u4fe1\u606f\u4e0d\u80fd\u88ab\u53e6\u4e00\u5e94\u7528\u7a0b\u5e8f\u968f\u610f\u8bbf\u95ee \u865a\u62df\u5316\u6280\u672f\u80fd\u591f\u66f4\u597d\u5730\u5229\u7528\u7269\u7406\u670d\u52a1\u5668\u7684\u8d44\u6e90\uff0c\u5e76\u4e14\u56e0\u4e3a\u53ef\u8f7b\u677e\u5730\u6dfb\u52a0\u6216\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\uff0c\u800c\u56e0\u6b64\u53ef\u4ee5\u5177\u6709\u66f4\u9ad8\u7684\u53ef\u6269\u7f29\u6027\uff0c\u4ee5\u53ca\u964d\u4f4e\u786c\u4ef6\u6210\u672c\u7b49\u7b49\u7684\u597d\u5904\u3002\u901a\u8fc7\u865a\u62df\u5316\uff0c\u4f60\u53ef\u4ee5\u5c06\u4e00\u7ec4\u7269\u7406\u8d44\u6e90\u5448\u73b0\u4e3a\u53ef\u4e22\u5f03\u7684\u865a\u62df\u673a\u96c6\u7fa4 \u6bcf\u4e2a VM \u662f\u4e00\u53f0\u5b8c\u6574\u7684\u8ba1\u7b97\u673a\uff0c\u5728\u865a\u62df\u5316\u786c\u4ef6\u4e4b\u4e0a\u8fd0\u884c\u6240\u6709\u7ec4\u4ef6\uff0c\u5305\u62ec\u5176\u81ea\u5df1\u7684\u64cd\u4f5c\u7cfb\u7edf \u5bb9\u5668\u90e8\u7f72\u65f6\u4ee3\uff1a \u5bb9\u5668\u7c7b\u4f3c\u4e8e VM\uff0c\u4f46\u662f\u66f4\u5bbd\u677e\u7684\u9694\u79bb\u7279\u6027\uff0c\u4f7f\u5bb9\u5668\u4e4b\u95f4\u53ef\u4ee5\u5171\u4eab\u64cd\u4f5c\u7cfb\u7edf\uff08OS\uff09\u3002\u56e0\u6b64\uff0c\u5bb9\u5668\u6bd4\u8d77 VM \u88ab\u8ba4\u4e3a\u662f\u66f4\u8f7b\u91cf\u7ea7\u7684\u3002\u4e14\u4e0e VM \u7c7b\u4f3c\uff0c\u6bcf\u4e2a\u5bb9\u5668\u90fd\u5177\u6709\u81ea\u5df1\u7684\u6587\u4ef6\u7cfb\u7edf\u3001CPU\u3001\u5185\u5b58\u3001\u8fdb\u7a0b\u7a7a\u95f4\u7b49\u3002\u7531\u4e8e\u5b83\u4eec\u4e0e\u57fa\u7840\u67b6\u6784\u5206\u79bb\uff0c\u56e0\u6b64\u53ef\u4ee5\u8de8\u4e91\u548c OS \u53d1\u884c\u7248\u672c\u8fdb\u884c\u79fb\u690d \u5bb9\u5668\u56e0\u5177\u6709\u8bb8\u591a\u4f18\u52bf\u800c\u53d8\u5f97\u6d41\u884c\u8d77\u6765\uff0c\u4f8b\u5982\uff1a \u654f\u6377\u5e94\u7528\u7a0b\u5e8f\u7684\u521b\u5efa\u548c\u90e8\u7f72\uff1a\u4e0e\u4f7f\u7528 VM \u955c\u50cf\u76f8\u6bd4\uff0c\u63d0\u9ad8\u4e86\u5bb9\u5668\u955c\u50cf\u521b\u5efa\u7684\u7b80\u4fbf\u6027\u548c\u6548\u7387 \u6301\u7eed\u5f00\u53d1\u3001\u96c6\u6210\u548c\u90e8\u7f72\uff1a\u901a\u8fc7\u5feb\u901f\u7b80\u5355\u7684\u56de\u6eda\uff08\u7531\u4e8e\u955c\u50cf\u4e0d\u53ef\u53d8\u6027\uff09\uff0c\u63d0\u4f9b\u53ef\u9760\u4e14\u9891\u7e41\u7684\u5bb9\u5668\u955c\u50cf\u6784\u5efa\u548c\u90e8\u7f72 \u5173\u6ce8\u5f00\u53d1\u4e0e\u8fd0\u7ef4\u7684\u5206\u79bb\uff1a\u5728\u6784\u5efa\u3001\u53d1\u5e03\u65f6\u521b\u5efa\u5e94\u7528\u7a0b\u5e8f\u5bb9\u5668\u955c\u50cf\uff0c\u800c\u4e0d\u662f\u5728\u90e8\u7f72\u65f6\uff0c\u4ece\u800c\u5c06\u5e94\u7528\u7a0b\u5e8f\u4e0e\u57fa\u7840\u67b6\u6784\u5206\u79bb \u53ef\u89c2\u5bdf\u6027\uff1a\u4e0d\u4ec5\u53ef\u4ee5\u663e\u793a OS \u7ea7\u522b\u7684\u4fe1\u606f\u548c\u6307\u6807\uff0c\u8fd8\u53ef\u4ee5\u663e\u793a\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\u72b6\u51b5\u548c\u5176\u4ed6\u6307\u6807\u4fe1\u53f7 \u8de8\u5f00\u53d1\u3001\u6d4b\u8bd5\u548c\u751f\u4ea7\u7684\u73af\u5883\u4e00\u81f4\u6027\uff1a\u5728\u7b14\u8bb0\u672c\u8ba1\u7b97\u673a\u4e0a\u4e5f\u53ef\u4ee5\u548c\u5728\u4e91\u4e2d\u8fd0\u884c\u4e00\u6837\u7684\u5e94\u7528\u7a0b\u5e8f \u8de8\u4e91\u548c\u64cd\u4f5c\u7cfb\u7edf\u53d1\u884c\u7248\u672c\u7684\u53ef\u79fb\u690d\u6027\uff1a\u53ef\u5728 Ubuntu\u3001RHEL\u3001CoreOS\u3001\u672c\u5730\u3001Google Kubernetes Engine \u548c\u5176\u4ed6\u4efb\u4f55\u5730\u65b9\u8fd0\u884c \u4ee5\u5e94\u7528\u7a0b\u5e8f\u4e3a\u4e2d\u5fc3\u7684\u7ba1\u7406\uff1a\u63d0\u9ad8\u62bd\u8c61\u7ea7\u522b\uff0c\u4ece\u5728\u865a\u62df\u786c\u4ef6\u4e0a\u8fd0\u884c OS \u5230\u4f7f\u7528\u903b\u8f91\u8d44\u6e90\u5728 OS \u4e0a\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f \u677e\u6563\u8026\u5408\u3001\u5206\u5e03\u5f0f\u3001\u5f39\u6027\u3001\u89e3\u653e\u7684\u5fae\u670d\u52a1\uff1a\u5e94\u7528\u7a0b\u5e8f\u88ab\u5206\u89e3\u6210\u8f83\u5c0f\u7684\u72ec\u7acb\u90e8\u5206\uff0c\u5e76\u4e14\u53ef\u4ee5\u52a8\u6001\u90e8\u7f72\u548c\u7ba1\u7406 - \u800c\u4e0d\u662f\u5728\u4e00\u53f0\u5927\u578b\u5355\u673a\u4e0a\u6574\u4f53\u8fd0\u884c \u8d44\u6e90\u9694\u79bb\uff1a\u53ef\u9884\u6d4b\u7684\u5e94\u7528\u7a0b\u5e8f\u6027\u80fd \u8d44\u6e90\u5229\u7528\uff1a\u9ad8\u6548\u7387\u548c\u9ad8\u5bc6\u5ea6","title":"\u65f6\u5149\u56de\u6eaf"},{"location":"Chapter01/chapter01/#why-you-need-kubernetes-and-what-can-it-do","text":"\u5bb9\u5668\u662f\u6253\u5305\u548c\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u7684\u597d\u65b9\u5f0f\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u4f60\u9700\u8981\u7ba1\u7406\u8fd0\u884c\u7740\u5e94\u7528\u7a0b\u5e8f\u7684\u5bb9\u5668\uff0c\u5e76\u786e\u4fdd\u670d\u52a1\u4e0d\u4f1a\u4e0b\u7ebf\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2a\u5bb9\u5668\u53d1\u751f\u6545\u969c\uff0c\u5219\u4f60\u9700\u8981\u542f\u52a8\u53e6\u4e00\u4e2a\u5bb9\u5668\u3002\u5982\u679c\u6b64\u884c\u4e3a\u4ea4\u7531\u7ed9\u7cfb\u7edf\u5904\u7406\uff0c\u662f\u4e0d\u662f\u4f1a\u66f4\u5bb9\u6613\u4e00\u4e9b\uff1f \u8fd9\u5c31\u662f Kubernetes \u8981\u6765\u505a\u7684\u4e8b\u60c5\uff01Kubernetes \u4e3a\u4f60\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53ef\u5f39\u6027\u8fd0\u884c\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6846\u67b6\u3002Kubernetes \u4f1a\u6ee1\u8db3\u4f60\u7684\u6269\u5c55\u8981\u6c42\u3001\u6545\u969c\u8f6c\u79fb\u4f60\u7684\u5e94\u7528\u3001\u63d0\u4f9b\u90e8\u7f72\u6a21\u5f0f\u7b49\u3002\u4f8b\u5982\uff0cKubernetes \u53ef\u4ee5\u8f7b\u677e\u7ba1\u7406\u7cfb\u7edf\u7684 Canary \u90e8\u7f72 Kubernetes \u4e3a\u4f60\u63d0\u4f9b\uff1a \u670d\u52a1\u53d1\u73b0\u548c\u8d1f\u8f7d\u5747\u8861 Kubernetes \u53ef\u4ee5\u4f7f\u7528 DNS \u540d\u79f0\u6216\u81ea\u5df1\u7684 IP \u5730\u5740\u6765\u66dd\u9732\u5bb9\u5668\u3002\u5982\u679c\u8fdb\u5165\u5bb9\u5668\u7684\u6d41\u91cf\u5f88\u5927\uff0cKubernetes \u53ef\u4ee5\u8d1f\u8f7d\u5747\u8861\u5e76\u5206\u914d\u7f51\u7edc\u6d41\u91cf\uff0c\u4ece\u800c\u4f7f\u90e8\u7f72\u7a33\u5b9a \u5b58\u50a8\u7f16\u6392 Kubernetes \u5141\u8bb8\u4f60\u81ea\u52a8\u6302\u8f7d\u4f60\u9009\u62e9\u7684\u5b58\u50a8\u7cfb\u7edf\uff0c\u4f8b\u5982\u672c\u5730\u5b58\u50a8\u3001\u516c\u5171\u4e91\u63d0\u4f9b\u5546\u7b49 \u81ea\u52a8\u90e8\u7f72\u548c\u56de\u6eda \u4f60\u53ef\u4ee5\u4f7f\u7528 Kubernetes \u63cf\u8ff0\u5df2\u90e8\u7f72\u5bb9\u5668\u7684\u6240\u9700\u72b6\u6001\uff0c\u5b83\u53ef\u4ee5\u4ee5\u53d7\u63a7\u7684\u901f\u7387\u5c06\u5b9e\u9645\u72b6\u6001\u66f4\u6539\u4e3a\u671f\u671b\u72b6\u6001\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u81ea\u52a8\u5316 Kubernetes \u6765\u4e3a\u4f60\u7684\u90e8\u7f72\u521b\u5efa\u65b0\u5bb9\u5668\uff0c\u5220\u9664\u73b0\u6709\u5bb9\u5668\u5e76\u5c06\u5b83\u4eec\u7684\u6240\u6709\u8d44\u6e90\u7528\u4e8e\u65b0\u5bb9\u5668 \u81ea\u52a8\u5b8c\u6210\u88c5\u7bb1\u8ba1\u7b97 \u4f60\u4e3a Kubernetes \u63d0\u4f9b\u8bb8\u591a\u8282\u70b9\u7ec4\u6210\u7684\u96c6\u7fa4\uff0c\u5728\u8fd9\u4e2a\u96c6\u7fa4\u4e0a\u8fd0\u884c\u5bb9\u5668\u5316\u7684\u4efb\u52a1\u3002\u4f60\u544a\u8bc9 Kubernetes \u6bcf\u4e2a\u5bb9\u5668\u9700\u8981\u591a\u5c11 CPU \u548c\u5185\u5b58 (RAM)\u3002Kubernetes \u53ef\u4ee5\u5c06\u8fd9\u4e9b\u5bb9\u5668\u6309\u5b9e\u9645\u60c5\u51b5\u8c03\u5ea6\u5230\u4f60\u7684\u8282\u70b9\u4e0a\uff0c\u4ee5\u6700\u4f73\u65b9\u5f0f\u5229\u7528\u4f60\u7684\u8d44\u6e90 \u81ea\u6211\u4fee\u590d Kubernetes \u5c06\u91cd\u65b0\u542f\u52a8\u5931\u8d25\u7684\u5bb9\u5668\u3001\u66ff\u6362\u5bb9\u5668\u3001\u6740\u6b7b\u4e0d\u54cd\u5e94\u7528\u6237\u5b9a\u4e49\u7684\u8fd0\u884c\u72b6\u51b5\u68c0\u67e5\u7684\u5bb9\u5668\uff0c\u5e76\u4e14\u5728\u51c6\u5907\u597d\u670d\u52a1\u4e4b\u524d\u4e0d\u5c06\u5176\u901a\u544a\u7ed9\u5ba2\u6237\u7aef \u5bc6\u94a5\u4e0e\u914d\u7f6e\u7ba1\u7406 Kubernetes \u5141\u8bb8\u4f60\u5b58\u50a8\u548c\u7ba1\u7406\u654f\u611f\u4fe1\u606f\uff0c\u4f8b\u5982\u5bc6\u7801\u3001OAuth \u4ee4\u724c\u548c ssh \u5bc6\u94a5\u3002\u4f60\u53ef\u4ee5\u5728\u4e0d\u91cd\u5efa\u5bb9\u5668\u955c\u50cf\u7684\u60c5\u51b5\u4e0b\u90e8\u7f72\u548c\u66f4\u65b0\u5bc6\u94a5\u548c\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\uff0c\u4e5f\u65e0\u9700\u5728\u5806\u6808\u914d\u7f6e\u4e2d\u66b4\u9732\u5bc6\u94a5","title":"\u4e3a\u4ec0\u4e48\u9700\u8981 Kubernetes\uff0c\u5b83\u80fd\u505a\u4ec0\u4e48\uff1f"},{"location":"Chapter01/chapter01/#what-kubernetes-is-not","text":"Kubernetes \u4e0d\u662f\u4f20\u7edf\u7684\u3001\u5305\u7f57\u4e07\u8c61\u7684 PaaS\uff08\u5e73\u53f0\u5373\u670d\u52a1\uff09\u7cfb\u7edf\u3002\u7531\u4e8e Kubernetes \u662f\u5728\u5bb9\u5668\u7ea7\u522b\u8fd0\u884c\uff0c\u800c\u975e\u5728\u786c\u4ef6\u7ea7\u522b\uff0c\u5b83\u63d0\u4f9b\u4e86 PaaS \u4ea7\u54c1\u5171\u6709\u7684\u4e00\u4e9b\u666e\u904d\u9002\u7528\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u90e8\u7f72\u3001\u6269\u5c55\u3001\u8d1f\u8f7d\u5747\u8861\uff0c\u5141\u8bb8\u7528\u6237\u96c6\u6210\u4ed6\u4eec\u7684\u65e5\u5fd7\u8bb0\u5f55\u3001\u76d1\u63a7\u548c\u8b66\u62a5\u65b9\u6848\u3002\u4f46\u662f\uff0cKubernetes \u4e0d\u662f\u5355\u4f53\u5f0f\uff08monolithic\uff09\u7cfb\u7edf\uff0c\u90a3\u4e9b\u9ed8\u8ba4\u89e3\u51b3\u65b9\u6848\u90fd\u662f\u53ef\u9009\u3001\u53ef\u63d2\u62d4\u7684\u3002Kubernetes \u4e3a\u6784\u5efa\u5f00\u53d1\u4eba\u5458\u5e73\u53f0\u63d0\u4f9b\u4e86\u57fa\u7840\uff0c\u4f46\u662f\u5728\u91cd\u8981\u7684\u5730\u65b9\u4fdd\u7559\u4e86\u7528\u6237\u9009\u62e9\u6743\uff0c\u80fd\u6709\u66f4\u9ad8\u7684\u7075\u6d3b\u6027 Kubernetes\uff1a \u4e0d\u9650\u5236\u652f\u6301\u7684\u5e94\u7528\u7a0b\u5e8f\u7c7b\u578b Kubernetes \u65e8\u5728\u652f\u6301\u6781\u5176\u591a\u79cd\u591a\u6837\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5305\u62ec\u65e0\u72b6\u6001\u3001\u6709\u72b6\u6001\u548c\u6570\u636e\u5904\u7406\u5de5\u4f5c\u8d1f\u8f7d\u3002\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\uff0c\u90a3\u4e48\u5b83\u5e94\u8be5\u53ef\u4ee5\u5728 Kubernetes \u4e0a\u5f88\u597d\u5730\u8fd0\u884c \u4e0d\u90e8\u7f72\u6e90\u4ee3\u7801\uff0c\u4e5f\u4e0d\u6784\u5efa\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f \u6301\u7eed\u96c6\u6210\uff08CI\uff09\u3001\u4ea4\u4ed8\u548c\u90e8\u7f72\uff08CI/CD\uff09\u5de5\u4f5c\u6d41\u53d6\u51b3\u4e8e\u7ec4\u7ec7\u7684\u6587\u5316\u548c\u504f\u597d\u4ee5\u53ca\u6280\u672f\u8981\u6c42 \u4e0d\u63d0\u4f9b\u5e94\u7528\u7a0b\u5e8f\u7ea7\u522b\u7684\u670d\u52a1\u4f5c\u4e3a\u5185\u7f6e\u670d\u52a1 \u4f8b\u5982\u4e2d\u95f4\u4ef6\uff08\u4f8b\u5982\u6d88\u606f\u4e2d\u95f4\u4ef6\uff09\u3001\u6570\u636e\u5904\u7406\u6846\u67b6\uff08\u4f8b\u5982 Spark\uff09\u3001\u6570\u636e\u5e93\uff08\u4f8b\u5982 MySQL\uff09\u3001\u7f13\u5b58\u3001\u96c6\u7fa4\u5b58\u50a8\u7cfb\u7edf\uff08\u4f8b\u5982 Ceph\uff09\u3002\u8fd9\u6837\u7684\u7ec4\u4ef6\u53ef\u4ee5\u5728 Kubernetes \u4e0a\u8fd0\u884c\uff0c\u5e76\u4e14/\u6216\u8005\u53ef\u4ee5\u7531\u8fd0\u884c\u5728Kubernetes \u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u53ef\u79fb\u690d\u673a\u5236\uff08\u4f8b\u5982 \u5f00\u653e\u670d\u52a1\u4ee3\u7406 \uff09\u6765\u8bbf\u95ee \u4e0d\u662f\u65e5\u5fd7\u8bb0\u5f55\u3001\u76d1\u89c6\u6216\u8b66\u62a5\u7684\u89e3\u51b3\u65b9\u6848 \u5b83\u96c6\u6210\u4e86\u4e00\u4e9b\u529f\u80fd\u4f5c\u4e3a\u6982\u5ff5\u8bc1\u660e\uff0c\u5e76\u63d0\u4f9b\u4e86\u6536\u96c6\u548c\u5bfc\u51fa\u6307\u6807\u7684\u673a\u5236 \u4e0d\u63d0\u4f9b\u4e5f\u4e0d\u8981\u6c42\u914d\u7f6e\u7528\u7684\u8bed\u8a00\u3001\u7cfb\u7edf\uff08\u4f8b\u5982 jsonnet\uff09 \u5b83\u63d0\u4f9b\u4e86\u58f0\u660e\u6027 API\uff0c\u8be5\u58f0\u660e\u6027 API \u53ef\u4ee5\u7531\u4efb\u610f\u5f62\u5f0f\u7684\u58f0\u660e\u6027\u89c4\u8303\u6240\u6784\u6210 \u4e0d\u63d0\u4f9b\u4e5f\u4e0d\u91c7\u7528\u4efb\u4f55\u5168\u9762\u7684\u673a\u5668\u914d\u7f6e\u3001\u7ef4\u62a4\u3001\u7ba1\u7406\u6216\u81ea\u6211\u4fee\u590d\u7cfb\u7edf \u6b64\u5916\uff0c Kubernetes \u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u7f16\u6392\u7cfb\u7edf \u5b9e\u9645\u4e0a\u5b83\u6d88\u9664\u4e86\u7f16\u6392\u7684\u9700\u8981\u3002\u7f16\u6392\u7684\u6280\u672f\u5b9a\u4e49\u662f\u6267\u884c\u5df2\u5b9a\u4e49\u7684\u5de5\u4f5c\u6d41\u7a0b\uff1a\u9996\u5148\u6267\u884c A\uff0c\u7136\u540e\u6267\u884c B\uff0c\u518d\u6267\u884c C\u3002\u800c Kubernetes \u5305\u542b\u4e86\u4e00\u7ec4\u72ec\u7acb\u53ef\u7ec4\u5408\u7684\u63a7\u5236\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u8fde\u7eed\u5730\u5c06\u5f53\u524d\u72b6\u6001\u9a71\u52a8\u5230\u6240\u63d0\u4f9b\u7684\u9884\u671f\u72b6\u6001\u3002\u4f60\u4e0d\u9700\u8981\u5728\u4e4e\u5982\u4f55\u4ece A \u79fb\u52a8\u5230 C\uff0c\u4e5f\u4e0d\u9700\u8981\u96c6\u4e2d\u63a7\u5236\uff0c\u8fd9\u4f7f\u5f97\u7cfb\u7edf\u66f4\u6613\u4e8e\u4f7f\u7528\u4e14\u529f\u80fd\u66f4\u5f3a\u5927\u3001\u7cfb\u7edf\u66f4\u5065\u58ee\uff0c\u66f4\u4e3a\u5f39\u6027\u548c\u53ef\u6269\u5c55","title":"Kubernetes \u4e0d\u662f\u4ec0\u4e48"},{"location":"Chapter02/chapter02-01/","text":"Kubernetes \u67b6\u6784 - \u8282\u70b9 \u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u8282\u70b9 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 44CF6E6 Kubernetes \u901a\u8fc7\u5c06\u5bb9\u5668\u653e\u5165\u5728\u8282\u70b9\uff08Node\uff09\u4e0a\u8fd0\u884c\u7684 Pod \u4e2d\u6765\u6267\u884c\u4f60\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002\u8282\u70b9\u53ef\u4ee5\u662f\u4e00\u4e2a\u865a\u62df\u673a\u6216\u8005\u7269\u7406\u673a\u5668\uff0c\u53d6\u51b3\u4e8e\u6240\u5728\u7684\u96c6\u7fa4\u914d\u7f6e\u3002\u6bcf\u4e2a\u8282\u70b9\u5305\u542b\u8fd0\u884c Pod \u6240\u9700\u7684\u670d\u52a1\uff1b\u8fd9\u4e9b\u8282\u70b9\u7531\u63a7\u5236\u9762\u8d1f\u8d23\u7ba1\u7406 \u901a\u5e38\u96c6\u7fa4\u4e2d\u4f1a\u6709\u82e5\u5e72\u4e2a\u8282\u70b9\uff1b\u800c\u5728\u4e00\u4e2a\u5b66\u4e60\u6240\u7528\u6216\u8005\u8d44\u6e90\u53d7\u9650\u7684\u73af\u5883\u4e2d\uff0c\u4f60\u7684\u96c6\u7fa4\u4e2d\u4e5f\u53ef\u80fd\u53ea\u6709\u4e00\u4e2a\u8282\u70b9 \u8282\u70b9\u4e0a\u7684 \u7ec4\u4ef6 \u5305\u62ec kubelet\u3001\u5bb9\u5668\u8fd0\u884c\u65f6\u4ee5\u53ca kube-proxy \u7ba1\u7406 \u5411 API \u670d\u52a1\u5668\u6dfb\u52a0\u8282\u70b9\u7684\u65b9\u5f0f\u4e3b\u8981\u6709\u4e24\u79cd\uff1a \u8282\u70b9\u4e0a\u7684 kubelet \u5411\u63a7\u5236\u9762\u6267\u884c\u81ea\u6ce8\u518c \u4f60\uff08\u6216\u8005\u522b\u7684\u4ec0\u4e48\u4eba\uff09\u624b\u52a8\u6dfb\u52a0\u4e00\u4e2a Node \u5bf9\u8c61 \u5728\u4f60\u521b\u5efa\u4e86 Node \u5bf9\u8c61\u6216\u8005\u8282\u70b9\u4e0a\u7684 kubelet \u6267\u884c\u4e86\u81ea\u6ce8\u518c\u64cd\u4f5c\u4e4b\u540e\uff0c\u63a7\u5236\u9762\u4f1a\u68c0\u67e5\u65b0\u7684 Node \u5bf9\u8c61\u662f\u5426\u5408\u6cd5\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u5c1d\u8bd5\u4f7f\u7528\u4e0b\u9762\u7684 JSON \u5bf9\u8c61\u6765\u521b\u5efa Node \u5bf9\u8c61\uff1a { \"kind\" : \"Node\" , \"apiVersion\" : \"v1\" , \"metadata\" : { \"name\" : \"10.240.79.157\" , \"labels\" : { \"name\" : \"my-first-k8s-node\" } } } Kubernetes \u4f1a\u5728\u5185\u90e8\u521b\u5efa\u4e00\u4e2a Node \u5bf9\u8c61\u4f5c\u4e3a\u8282\u70b9\u7684\u8868\u793a\u3002Kubernetes \u68c0\u67e5 kubelet \u5411 API \u670d\u52a1\u5668\u6ce8\u518c\u8282\u70b9\u65f6\u4f7f\u7528\u7684 metadata.name \u5b57\u6bb5\u662f\u5426\u5339\u914d\u3002\u5982\u679c\u8282\u70b9\u662f\u5065\u5eb7\u7684\uff08\u5373\u6240\u6709\u5fc5\u8981\u7684\u670d\u52a1\u90fd\u5728\u8fd0\u884c\u4e2d\uff09\uff0c\u5219\u8be5\u8282\u70b9\u53ef\u4ee5\u7528\u6765\u8fd0\u884c Pod\u3002\u5426\u5219\uff0c\u76f4\u5230\u8be5\u8282\u70b9\u53d8\u4e3a\u5065\u5eb7\u4e4b\u524d\uff0c\u6240\u6709\u7684\u96c6\u7fa4\u6d3b\u52a8\u90fd\u4f1a\u5ffd\u7565\u8be5\u8282\u70b9 \u8bf4\u660e\uff1a Kubernetes \u4f1a\u4e00\u76f4\u4fdd\u5b58\u7740\u975e\u6cd5\u8282\u70b9\u5bf9\u5e94\u7684\u5bf9\u8c61\uff0c\u5e76\u6301\u7eed\u68c0\u67e5\u8be5\u8282\u70b9\u662f\u5426\u5df2\u7ecf\u53d8\u5f97\u5065\u5eb7\u3002\u4f60\uff0c\u6216\u8005\u67d0\u4e2a\u63a7\u5236\u5668\u5fc5\u987b\u663e\u5f0f\u5730\u5220\u9664\u8be5 Node \u5bf9\u8c61\u4ee5\u505c\u6b62\u5065\u5eb7\u68c0\u67e5\u64cd\u4f5c Node \u5bf9\u8c61\u7684\u540d\u79f0\u5fc5\u987b\u662f\u5408\u6cd5\u7684 DNS \u5b50\u57df\u540d \u8282\u70b9\u540d\u79f0\u552f\u4e00\u6027 \u8282\u70b9\u7684 \u540d\u79f0 \u7528\u6765\u6807\u8bc6 Node \u5bf9\u8c61\u3002\u6ca1\u6709\u4e24\u4e2a Node \u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\u76f8\u540c\u7684\u540d\u79f0\u3002Kubernetes \u8fd8\u5047\u5b9a\u540d\u5b57\u76f8\u540c\u7684\u8d44\u6e90\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61\u3002\u5c31 Node \u800c\u8a00\uff0c\u9690\u5f0f\u5047\u5b9a\u4f7f\u7528\u76f8\u540c\u540d\u79f0\u7684\u5b9e\u4f8b\u4f1a\u5177\u6709\u76f8\u540c\u7684\u72b6\u6001\uff08\u4f8b\u5982\u7f51\u7edc\u914d\u7f6e\u3001\u6839\u78c1\u76d8\u5185\u5bb9\uff09\u548c\u7c7b\u4f3c\u8282\u70b9\u6807\u7b7e\u8fd9\u7c7b\u5c5e\u6027\u3002\u8fd9\u53ef\u80fd\u5728\u8282\u70b9\u88ab\u66f4\u6539\u4f46\u5176\u540d\u79f0\u672a\u53d8\u65f6\u5bfc\u81f4\u7cfb\u7edf\u72b6\u6001\u4e0d\u4e00\u81f4\u3002\u5982\u679c\u67d0\u4e2a Node \u9700\u8981\u88ab\u66ff\u6362\u6216\u8005\u5927\u91cf\u53d8\u66f4\uff0c\u9700\u8981\u4ece API \u670d\u52a1\u5668\u79fb\u9664\u73b0\u6709\u7684 Node \u5bf9\u8c61\uff0c\u4e4b\u540e\u518d\u5728\u66f4\u65b0\u4e4b\u540e\u91cd\u65b0\u5c06\u5176\u52a0\u5165 \u8282\u70b9\u81ea\u6ce8\u518c \u5f53 kubelet \u6807\u5fd7 --register-node \u4e3a true\uff08\u9ed8\u8ba4\uff09\u65f6\uff0c\u5b83\u4f1a\u5c1d\u8bd5\u5411 API \u670d\u52a1\u6ce8\u518c\u81ea\u5df1\u3002\u8fd9\u662f\u9996\u9009\u6a21\u5f0f\uff0c\u88ab\u7edd\u5927\u591a\u6570\u53d1\u884c\u7248\u9009\u7528 \u5bf9\u4e8e\u81ea\u6ce8\u518c\u6a21\u5f0f\uff0ckubelet \u4f7f\u7528\u4e0b\u5217\u53c2\u6570\u542f\u52a8\uff1a --kubeconfig - \u7528\u4e8e\u5411 API \u670d\u52a1\u5668\u6267\u884c\u8eab\u4efd\u8ba4\u8bc1\u6240\u7528\u7684\u51ed\u636e\u7684\u8def\u5f84 --cloud-provider - \u4e0e\u67d0\u4e91\u9a71\u52a8\u8fdb\u884c\u901a\u4fe1\u4ee5\u8bfb\u53d6\u4e0e\u81ea\u8eab\u76f8\u5173\u7684\u5143\u6570\u636e\u7684\u65b9\u5f0f --register-node - \u81ea\u52a8\u5411 API \u670d\u52a1\u6ce8\u518c --register-with-taints - \u4f7f\u7528\u6240\u7ed9\u7684\u6c61\u70b9\u5217\u8868\uff08\u9017\u53f7\u5206\u9694\u7684 <key>=<value>:<effect> \uff09\u6ce8\u518c\u8282\u70b9\u3002\u5f53 register-node \u4e3a false \u65f6\u65e0\u6548 --node-ip - \u8282\u70b9 IP \u5730\u5740 --node-labels - \u5728\u96c6\u7fa4\u4e2d\u6ce8\u518c\u8282\u70b9\u65f6\u8981\u6dfb\u52a0\u7684\u6807\u7b7e\u3002\uff08\u53c2\u89c1 NodeRestriction \u51c6\u5165\u63a7\u5236\u63d2\u4ef6 \u6240\u5b9e\u65bd\u7684\u6807\u7b7e\u9650\u5236\uff09 --node-status-update-frequency - \u6307\u5b9a kubelet \u5411\u63a7\u5236\u9762\u53d1\u9001\u72b6\u6001\u7684\u9891\u7387 \u542f\u7528 Node \u9274\u6743\u6a21\u5f0f \u548c NodeRestriction \u51c6\u5165\u63d2\u4ef6 \u65f6\uff0c\u4ec5\u6388\u6743 kubelet \u521b\u5efa\u6216\u4fee\u6539\u5176\u81ea\u5df1\u7684\u8282\u70b9\u8d44\u6e90 \u8bf4\u660e\uff1a \u6b63\u5982 \u8282\u70b9\u540d\u79f0\u552f\u4e00\u6027 \u4e00\u8282\u6240\u8ff0\uff0c\u5f53 Node \u7684\u914d\u7f6e\u9700\u8981\u88ab\u66f4\u65b0\u65f6\uff0c\u4e00\u79cd\u597d\u7684\u505a\u6cd5\u662f\u91cd\u65b0\u5411 API \u670d\u52a1\u5668\u6ce8\u518c\u8be5\u8282\u70b9\u3002\u4f8b\u5982\uff0c\u5982\u679c kubelet \u91cd\u542f\u65f6\u5176 --node-labels \u662f\u65b0\u7684\u503c\u96c6\uff0c\u4f46\u540c\u4e00\u4e2a Node \u540d\u79f0\u5df2\u7ecf\u88ab\u4f7f\u7528\uff0c\u5219\u6240\u4f5c\u53d8\u66f4\u4e0d\u4f1a\u8d77\u4f5c\u7528\uff0c \u56e0\u4e3a\u8282\u70b9\u6807\u7b7e\u662f\u5728 Node \u6ce8\u518c\u65f6\u5b8c\u6210\u7684 \u5982\u679c\u5728 kubelet \u91cd\u542f\u671f\u95f4 Node \u914d\u7f6e\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5df2\u7ecf\u88ab\u8c03\u5ea6\u5230\u67d0 Node \u4e0a\u7684 Pod \u53ef\u80fd\u4f1a\u51fa\u73b0\u884c\u4e3a\u4e0d\u6b63\u5e38\u6216\u8005\u51fa\u73b0\u5176\u4ed6\u95ee\u9898\uff0c\u4f8b\u5982\uff0c\u5df2\u7ecf\u8fd0\u884c\u7684 Pod \u53ef\u80fd\u901a\u8fc7\u6c61\u70b9\u673a\u5236\u8bbe\u7f6e\u4e86\u4e0e Node \u4e0a\u65b0\u8bbe\u7f6e\u7684\u6807\u7b7e\u76f8\u6392\u65a5\u7684\u89c4\u5219\uff0c\u4e5f\u6709\u4e00\u4e9b\u5176\u4ed6 Pod\uff0c \u672c\u6765\u4e0e\u6b64 Pod \u4e4b\u95f4\u5b58\u5728\u4e0d\u517c\u5bb9\u7684\u95ee\u9898\uff0c\u4e5f\u4f1a\u56e0\u4e3a\u65b0\u7684\u6807\u7b7e\u8bbe\u7f6e\u800c\u88ab\u8c03\u5230\u540c\u4e00\u8282\u70b9\u3002 \u8282\u70b9\u91cd\u65b0\u6ce8\u518c\u64cd\u4f5c\u53ef\u4ee5\u786e\u4fdd\u8282\u70b9\u4e0a\u6240\u6709 Pod \u90fd\u88ab\u6392\u7a7a\u5e76\u88ab\u6b63\u786e\u5730\u91cd\u65b0\u8c03\u5ea6 \u624b\u52a8\u8282\u70b9\u7ba1\u7406 \u4f60\u53ef\u4ee5\u4f7f\u7528 kubectl \u6765\u521b\u5efa\u548c\u4fee\u6539 Node \u5bf9\u8c61 \u5982\u679c\u4f60\u5e0c\u671b\u624b\u52a8\u521b\u5efa\u8282\u70b9\u5bf9\u8c61\u65f6\uff0c\u8bf7\u8bbe\u7f6e kubelet \u6807\u5fd7 --register-node=false \u4f60\u53ef\u4ee5\u4fee\u6539 Node \u5bf9\u8c61\uff08\u5ffd\u7565 --register-node \u8bbe\u7f6e\uff09\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u4fee\u6539\u8282\u70b9\u4e0a\u7684\u6807\u7b7e\u6216\u5e76\u6807\u8bb0\u5176\u4e3a\u4e0d\u53ef\u8c03\u5ea6 \u4f60\u53ef\u4ee5\u7ed3\u5408\u4f7f\u7528 Node \u4e0a\u7684\u6807\u7b7e\u548c Pod \u4e0a\u7684\u9009\u62e9\u7b97\u7b26\u6765\u63a7\u5236\u8c03\u5ea6\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u9650\u5236\u67d0 Pod \u53ea\u80fd\u5728\u7b26\u5408\u8981\u6c42\u7684\u8282\u70b9\u5b50\u96c6\u4e0a\u8fd0\u884c \u5982\u679c\u6807\u8bb0\u8282\u70b9\u4e3a\u4e0d\u53ef\u8c03\u5ea6\uff08unschedulable\uff09\uff0c\u5c06\u963b\u6b62\u65b0 Pod \u8c03\u5ea6\u5230\u8be5 Node \u4e4b\u4e0a\uff0c\u4f46\u4e0d\u4f1a\u5f71\u54cd\u4efb\u4f55\u5df2\u7ecf\u5728\u5176\u4e0a\u7684 Pod\u3002\u8fd9\u662f\u91cd\u542f\u8282\u70b9\u6216\u8005\u6267\u884c\u5176\u4ed6\u7ef4\u62a4\u64cd\u4f5c\u4e4b\u524d\u7684\u4e00\u4e2a\u6709\u7528\u7684\u51c6\u5907\u6b65\u9aa4 \u8981\u6807\u8bb0\u4e00\u4e2a Node \u4e3a\u4e0d\u53ef\u8c03\u5ea6\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a kubectl cordon $NODENAME \u66f4\u591a\u7ec6\u8282\u53c2\u8003 \u5b89\u5168\u5730\u817e\u7a7a\u8282\u70b9 \u8bf4\u660e\uff1a \u88ab DaemonSet \u63a7\u5236\u5668\u521b\u5efa\u7684 Pod \u80fd\u591f\u5bb9\u5fcd\u8282\u70b9\u7684\u4e0d\u53ef\u8c03\u5ea6\u5c5e\u6027\u3002 DaemonSet \u901a\u5e38\u63d0\u4f9b\u8282\u70b9\u672c\u5730\u7684\u670d\u52a1\uff0c\u5373\u4f7f\u8282\u70b9\u4e0a\u7684\u8d1f\u8f7d\u5e94\u7528\u5df2\u7ecf\u88ab\u817e\u7a7a\uff0c \u8fd9\u4e9b\u670d\u52a1\u4e5f\u4ecd\u9700\u8fd0\u884c\u5728\u8282\u70b9\u4e4b\u4e0a \u8282\u70b9\u72b6\u6001 \u4e00\u4e2a\u8282\u70b9\u7684\u72b6\u6001\u5305\u542b\u4ee5\u4e0b\u4fe1\u606f: \u5730\u5740\uff08Addresses\uff09 \u72b6\u51b5\uff08Condition\uff09 \u5bb9\u91cf\u4e0e\u53ef\u5206\u914d\uff08Capacity\uff09 \u4fe1\u606f\uff08Info\uff09 \u4f60\u53ef\u4ee5\u4f7f\u7528 kubectl \u6765\u67e5\u770b\u8282\u70b9\u72b6\u6001\u548c\u5176\u4ed6\u7ec6\u8282\u4fe1\u606f\uff1a kubectl describe node <\u8282\u70b9\u540d\u79f0> \u4e0b\u9762\u5bf9\u6bcf\u4e2a\u90e8\u5206\u8fdb\u884c\u8be6\u7ec6\u63cf\u8ff0 \u5730\u5740 \u8fd9\u4e9b\u5b57\u6bb5\u7684\u7528\u6cd5\u53d6\u51b3\u4e8e\u4f60\u7684\u4e91\u670d\u52a1\u5546\u6216\u8005\u7269\u7406\u673a\u914d\u7f6e HostName\uff1a\u7531\u8282\u70b9\u7684\u5185\u6838\u62a5\u544a\u3002\u53ef\u4ee5\u901a\u8fc7 kubelet \u7684 --hostname-override \u53c2\u6570\u8986\u76d6 ExternalIP\uff1a\u901a\u5e38\u662f\u8282\u70b9\u7684\u53ef\u5916\u90e8\u8def\u7531\uff08\u4ece\u96c6\u7fa4\u5916\u53ef\u8bbf\u95ee\uff09\u7684 IP \u5730\u5740 InternalIP\uff1a\u901a\u5e38\u662f\u8282\u70b9\u7684\u4ec5\u53ef\u5728\u96c6\u7fa4\u5185\u90e8\u8def\u7531\u7684 IP \u5730\u5740 \u72b6\u51b5 conditions \u5b57\u6bb5\u63cf\u8ff0\u4e86\u6240\u6709 Running \u8282\u70b9\u7684\u72b6\u51b5\u3002\u72b6\u51b5\u7684\u793a\u4f8b\u5305\u62ec\uff1a \u8282\u70b9\u72b6\u51b5 \u63cf\u8ff0 Ready \u5982\u8282\u70b9\u662f\u5065\u5eb7\u7684\u5e76\u5df2\u7ecf\u51c6\u5907\u597d\u63a5\u6536 Pod \u5219\u4e3a True \uff1b False \u8868\u793a\u8282\u70b9\u4e0d\u5065\u5eb7\u800c\u4e14\u4e0d\u80fd\u63a5\u6536 Pod\uff1b Unknown \u8868\u793a\u8282\u70b9\u63a7\u5236\u5668\u5728\u6700\u8fd1 node-monitor-grace-period \u671f\u95f4\uff08\u9ed8\u8ba4 40 \u79d2\uff09\u6ca1\u6709\u6536\u5230\u8282\u70b9\u7684\u6d88\u606f DiskPressure True \u8868\u793a\u8282\u70b9\u5b58\u5728\u78c1\u76d8\u7a7a\u95f4\u538b\u529b\uff0c\u5373\u78c1\u76d8\u53ef\u7528\u91cf\u4f4e, \u5426\u5219\u4e3a False MemoryPressure True \u8868\u793a\u8282\u70b9\u5b58\u5728\u5185\u5b58\u538b\u529b\uff0c\u5373\u8282\u70b9\u5185\u5b58\u53ef\u7528\u91cf\u4f4e\uff0c\u5426\u5219\u4e3a False PIDPressure True \u8868\u793a\u8282\u70b9\u5b58\u5728\u8fdb\u7a0b\u538b\u529b\uff0c\u5373\u8282\u70b9\u4e0a\u8fdb\u7a0b\u8fc7\u591a\uff1b\u5426\u5219\u4e3a False NetworkUnavailable True \u8868\u793a\u8282\u70b9\u7f51\u7edc\u914d\u7f6e\u4e0d\u6b63\u786e\uff1b\u5426\u5219\u4e3a False \u8bf4\u660e\uff1a \u5982\u679c\u4f7f\u7528\u547d\u4ee4\u884c\u5de5\u5177\u6765\u6253\u5370\u5df2\u4fdd\u62a4\uff08Cordoned\uff09\u8282\u70b9\u7684\u7ec6\u8282\uff0c\u5176\u4e2d\u7684 Condition \u5b57\u6bb5\u53ef\u80fd\u5305\u62ec SchedulingDisabled \u3002 SchedulingDisabled \u4e0d\u662f Kubernetes API \u4e2d\u5b9a\u4e49\u7684 Condition\uff0c\u88ab\u4fdd\u62a4\u8d77\u6765\u7684\u8282\u70b9\u5728\u5176\u89c4\u7ea6\u4e2d\u88ab\u6807\u8bb0\u4e3a\u4e0d\u53ef\u8c03\u5ea6\uff08Unschedulable\uff09 \u5728 Kubernetes API \u4e2d\uff0c\u8282\u70b9\u7684\u72b6\u51b5\u8868\u793a\u8282\u70b9\u8d44\u6e90\u4e2d .status \u7684\u4e00\u90e8\u5206\u3002 \u4f8b\u5982\uff0c\u4ee5\u4e0b JSON \u7ed3\u6784\u63cf\u8ff0\u4e86\u4e00\u4e2a\u5065\u5eb7\u8282\u70b9\uff1a \"conditions\" : [ { \"type\" : \"Ready\" , \"status\" : \"True\" , \"reason\" : \"KubeletReady\" , \"message\" : \"kubelet is posting ready status\" , \"lastHeartbeatTime\" : \"2019-06-05T18:38:35Z\" , \"lastTransitionTime\" : \"2019-06-05T11:41:27Z\" } ] \u5982\u679c Ready \u72b6\u51b5\u7684 status \u5904\u4e8e Unknown \u6216\u8005 False \u72b6\u6001\u7684\u65f6\u95f4\u8d85\u8fc7\u4e86 pod-eviction-timeout \u503c\uff08\u4e00\u4e2a\u4f20\u9012\u7ed9 kube-controller-manager \u7684\u53c2\u6570\uff09\uff0c \u8282\u70b9\u63a7\u5236\u5668 \u4f1a\u5bf9\u8282\u70b9\u4e0a\u7684\u6240\u6709 Pod \u89e6\u53d1 API \u53d1\u8d77\u7684\u9a71\u9010\u3002\u9ed8\u8ba4\u7684\u9010\u51fa\u8d85\u65f6\u65f6\u957f\u4e3a 5 \u5206\u949f \u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u5f53\u8282\u70b9\u4e0d\u53ef\u8fbe\u65f6\uff0cAPI \u670d\u52a1\u5668\u4e0d\u80fd\u548c\u5176\u4e0a\u7684 kubelet \u901a\u4fe1\u3002\u5220\u9664 Pod \u7684\u51b3\u5b9a\u4e0d\u80fd\u4f20\u8fbe\u7ed9 kubelet\uff0c\u76f4\u5230\u5b83\u91cd\u65b0\u5efa\u7acb\u548c API \u670d\u52a1\u5668\u7684\u8fde\u63a5\u4e3a\u6b62\u3002 \u4e0e\u6b64\u540c\u65f6\uff0c\u88ab\u8ba1\u5212\u5220\u9664\u7684 Pod \u53ef\u80fd\u4f1a\u7ee7\u7eed\u5728\u6e38\u79bb\u7684\u8282\u70b9\u4e0a\u8fd0\u884c \u8282\u70b9\u63a7\u5236\u5668\u5728\u786e\u8ba4 Pod \u5728\u96c6\u7fa4\u4e2d\u5df2\u7ecf\u505c\u6b62\u8fd0\u884c\u524d\uff0c\u4e0d\u4f1a\u5f3a\u5236\u5220\u9664\u5b83\u4eec\u3002\u4f60\u53ef\u4ee5\u770b\u5230\u53ef\u80fd\u5728\u8fd9\u4e9b\u65e0\u6cd5\u8bbf\u95ee\u7684\u8282\u70b9\u4e0a\u8fd0\u884c\u7684 Pod \u5904\u4e8e Terminating \u6216\u8005 Unknown \u72b6\u6001\u3002\u5982\u679c kubernetes \u4e0d\u80fd\u57fa\u4e8e\u4e0b\u5c42\u57fa\u7840\u8bbe\u65bd\u63a8\u65ad\u51fa\u67d0\u8282\u70b9\u662f\u5426\u5df2\u7ecf\u6c38\u4e45\u79bb\u5f00\u4e86\u96c6\u7fa4\uff0c\u96c6\u7fa4\u7ba1\u7406\u5458\u53ef\u80fd\u9700\u8981\u624b\u52a8\u5220\u9664\u8be5\u8282\u70b9\u5bf9\u8c61\u3002\u4ece Kubernetes \u5220\u9664\u8282\u70b9\u5bf9\u8c61\u5c06\u5bfc\u81f4 API \u670d\u52a1\u5668\u5220\u9664\u8282\u70b9\u4e0a\u6240\u6709\u8fd0\u884c\u7684 Pod \u5bf9\u8c61\u5e76\u91ca\u653e\u5b83\u4eec\u7684\u540d\u5b57 \u5f53\u8282\u70b9\u4e0a\u51fa\u73b0\u95ee\u9898\u65f6\uff0cKubernetes \u63a7\u5236\u9762\u4f1a\u81ea\u52a8\u521b\u5efa\u4e0e\u5f71\u54cd\u8282\u70b9\u7684\u72b6\u51b5\u5bf9\u5e94\u7684 \u6c61\u70b9 \u3002\u8c03\u5ea6\u5668\u5728\u5c06 Pod \u6307\u6d3e\u5230\u67d0 Node \u65f6\u4f1a\u8003\u8651 Node \u4e0a\u7684\u6c61\u70b9\u8bbe\u7f6e\u3002Pod \u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u5bb9\u5fcd\u5ea6\uff0c\u4ee5\u4fbf\u80fd\u591f\u5728\u8bbe\u7f6e\u4e86\u7279\u5b9a\u6c61\u70b9\u7684 Node \u4e0a\u8fd0\u884c \u8fdb\u4e00\u6b65\u7684\u7ec6\u8282\u53ef\u53c2\u9605 \u6839\u636e\u72b6\u51b5\u4e3a\u8282\u70b9\u8bbe\u7f6e\u6c61\u70b9 \u5bb9\u91cf\uff08Capacity\uff09\u4e0e\u53ef\u5206\u914d\uff08Allocatable\uff09 \u8fd9\u4e24\u4e2a\u503c\u63cf\u8ff0\u8282\u70b9\u4e0a\u7684\u53ef\u7528\u8d44\u6e90\uff1aCPU\u3001\u5185\u5b58\u548c\u53ef\u4ee5\u8c03\u5ea6\u5230\u8282\u70b9\u4e0a\u7684 Pod \u7684\u4e2a\u6570\u4e0a\u9650 capacity \u5757\u4e2d\u7684\u5b57\u6bb5\u6807\u793a\u8282\u70b9\u62e5\u6709\u7684\u8d44\u6e90\u603b\u91cf\u3002 allocatable \u5757\u6307\u793a\u8282\u70b9\u4e0a\u53ef\u4f9b\u666e\u901a Pod \u6d88\u8017\u7684\u8d44\u6e90\u91cf \u53ef\u4ee5\u5728\u5b66\u4e60\u5982\u4f55\u5728\u8282\u70b9\u4e0a \u9884\u7559\u8ba1\u7b97\u8d44\u6e90 \u7684\u65f6\u5019\u4e86\u89e3\u6709\u5173\u5bb9\u91cf\u548c\u53ef\u5206\u914d\u8d44\u6e90\u7684\u66f4\u591a\u4fe1\u606f \u4fe1\u606f\uff08Info\uff09 Info \u6307\u7684\u662f\u8282\u70b9\u7684\u4e00\u822c\u4fe1\u606f\uff0c\u5982\u5185\u6838\u7248\u672c\u3001Kubernetes \u7248\u672c\uff08 kubelet \u548c kube-proxy \u7248\u672c\uff09\u3001\u5bb9\u5668\u8fd0\u884c\u65f6\u8be6\u7ec6\u4fe1\u606f\uff0c\u4ee5\u53ca\u8282\u70b9\u4f7f\u7528\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002 kubelet \u4ece\u8282\u70b9\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u5e76\u5c06\u5176\u53d1\u5e03\u5230 Kubernetes API \u5fc3\u8df3 Kubernetes \u8282\u70b9\u53d1\u9001\u7684\u5fc3\u8df3\u5e2e\u52a9\u4f60\u7684\u96c6\u7fa4\u786e\u5b9a\u6bcf\u4e2a\u8282\u70b9\u7684\u53ef\u7528\u6027\uff0c\u5e76\u5728\u68c0\u6d4b\u5230\u6545\u969c\u65f6\u91c7\u53d6\u884c\u52a8 \u5bf9\u4e8e\u8282\u70b9\uff0c\u6709\u4e24\u79cd\u5f62\u5f0f\u7684\u5fc3\u8df3: \u66f4\u65b0\u8282\u70b9\u7684 .status kube-node-lease \u540d\u5b57\u7a7a\u95f4\u4e2d\u7684 Lease\uff08\u79df\u7ea6\uff09 \u5bf9\u8c61\u3002\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u4e00\u4e2a\u5173\u8054\u7684 Lease \u5bf9\u8c61 \u4e0e Node \u7684 .status \u66f4\u65b0\u76f8\u6bd4\uff0cLease \u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u8d44\u6e90\u3002\u4f7f\u7528 Lease \u6765\u8868\u8fbe\u5fc3\u8df3\u5728\u5927\u578b\u96c6\u7fa4\u4e2d\u53ef\u4ee5\u51cf\u5c11\u8fd9\u4e9b\u66f4\u65b0\u5bf9\u6027\u80fd\u7684\u5f71\u54cd kubelet \u8d1f\u8d23\u521b\u5efa\u548c\u66f4\u65b0\u8282\u70b9\u7684 .status \uff0c\u4ee5\u53ca\u66f4\u65b0\u5b83\u4eec\u5bf9\u5e94\u7684 Lease \u5f53\u8282\u70b9\u72b6\u6001\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u6216\u8005\u5728\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u5185\u6ca1\u6709\u66f4\u65b0\u4e8b\u4ef6\u65f6\uff0ckubelet \u4f1a\u66f4\u65b0 .status \u3002 .status \u66f4\u65b0\u7684\u9ed8\u8ba4\u95f4\u9694\u4e3a 5 \u5206\u949f\uff08\u6bd4\u8282\u70b9\u4e0d\u53ef\u8fbe\u4e8b\u4ef6\u7684 40 \u79d2\u9ed8\u8ba4\u8d85\u65f6\u65f6\u95f4\u957f\u5f88\u591a\uff09 kubelet \u4f1a\u521b\u5efa\u5e76\u6bcf 10 \u79d2\uff08\u9ed8\u8ba4\u66f4\u65b0\u95f4\u9694\u65f6\u95f4\uff09\u66f4\u65b0 Lease \u5bf9\u8c61\u3002Lease \u7684\u66f4\u65b0\u72ec\u7acb\u4e8e Node \u7684 .status \u66f4\u65b0\u800c\u53d1\u751f\u3002\u5982\u679c Lease \u7684\u66f4\u65b0\u64cd\u4f5c\u5931\u8d25\uff0ckubelet \u4f1a\u91c7\u7528\u6307\u6570\u56de\u9000\u673a\u5236\uff0c\u4ece 200 \u6beb\u79d2\u5f00\u59cb\u91cd\u8bd5\uff0c\u6700\u957f\u91cd\u8bd5\u95f4\u9694\u4e3a 7 \u79d2\u949f \u8282\u70b9\u63a7\u5236\u5668 \u8282\u70b9\u63a7\u5236\u5668\u662f Kubernetes \u63a7\u5236\u9762\u7ec4\u4ef6\uff0c\u7ba1\u7406\u8282\u70b9\u7684\u65b9\u65b9\u9762\u9762 \u8282\u70b9\u63a7\u5236\u5668\u5728\u8282\u70b9\u7684\u751f\u547d\u5468\u671f\u4e2d\u626e\u6f14\u591a\u4e2a\u89d2\u8272\u3002\u7b2c\u4e00\u4e2a\u662f\u5f53\u8282\u70b9\u6ce8\u518c\u65f6\u4e3a\u5b83\u5206\u914d\u4e00\u4e2a CIDR \u533a\u6bb5\uff08\u5982\u679c\u542f\u7528\u4e86 CIDR \u5206\u914d\uff09 \u7b2c\u4e8c\u4e2a\u662f\u4fdd\u6301\u8282\u70b9\u63a7\u5236\u5668\u5185\u7684\u8282\u70b9\u5217\u8868\u4e0e\u4e91\u670d\u52a1\u5546\u6240\u63d0\u4f9b\u7684\u53ef\u7528\u673a\u5668\u5217\u8868\u540c\u6b65\u3002\u5982\u679c\u5728\u4e91\u73af\u5883\u4e0b\u8fd0\u884c\uff0c\u53ea\u8981\u67d0\u8282\u70b9\u4e0d\u5065\u5eb7\uff0c\u8282\u70b9\u63a7\u5236\u5668\u5c31\u4f1a\u8be2\u95ee\u4e91\u670d\u52a1\u662f\u5426\u8282\u70b9\u7684\u865a\u62df\u673a\u4ecd\u53ef\u7528\u3002\u5982\u679c\u4e0d\u53ef\u7528\uff0c\u8282\u70b9\u63a7\u5236\u5668\u4f1a\u5c06\u8be5\u8282\u70b9\u4ece\u5b83\u7684\u8282\u70b9\u5217\u8868\u5220\u9664 \u7b2c\u4e09\u4e2a\u662f\u76d1\u63a7\u8282\u70b9\u7684\u5065\u5eb7\u72b6\u51b5\u3002\u8282\u70b9\u63a7\u5236\u5668\u8d1f\u8d23\uff1a \u5728\u8282\u70b9\u4e0d\u53ef\u8fbe\u7684\u60c5\u51b5\u4e0b\uff0c\u5728 Node \u7684 .status \u4e2d\u66f4\u65b0 Ready \u72b6\u51b5\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u63a7\u5236\u5668\u5c06 NodeReady \u72b6\u51b5\u66f4\u65b0\u4e3a Unknown \u5982\u679c\u8282\u70b9\u4ecd\u7136\u65e0\u6cd5\u8bbf\u95ee\uff1a\u5bf9\u4e8e\u4e0d\u53ef\u8fbe\u8282\u70b9\u4e0a\u7684\u6240\u6709 Pod \u89e6\u53d1 API \u53d1\u8d77\u7684\u9010\u51fa \u64cd\u4f5c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u63a7\u5236\u5668\u5728\u5c06\u8282\u70b9\u6807\u8bb0\u4e3a Unknown \u540e\u7b49\u5f85 5 \u5206\u949f\u63d0\u4ea4\u7b2c\u4e00\u4e2a\u9a71\u9010\u8bf7\u6c42 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u63a7\u5236\u5668\u6bcf 5 \u79d2\u68c0\u67e5\u4e00\u6b21\u8282\u70b9\u72b6\u6001\uff0c\u53ef\u4ee5\u4f7f\u7528 kube-controller-manager \u7ec4\u4ef6\u4e0a\u7684 --node-monitor-period \u53c2\u6570\u6765\u914d\u7f6e\u5468\u671f \u9010\u51fa\u901f\u7387\u9650\u5236 \u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u63a7\u5236\u5668\u628a\u9010\u51fa\u901f\u7387\u9650\u5236\u5728\u6bcf\u79d2 --node-eviction-rate \u4e2a\uff08\u9ed8\u8ba4\u4e3a 0.1\uff09\u3002\u8fd9\u8868\u793a\u5b83\u6bcf 10 \u79d2\u949f\u5185\u81f3\u591a\u4ece\u4e00\u4e2a\u8282\u70b9\u9a71\u9010 Pod \u5f53\u4e00\u4e2a\u53ef\u7528\u533a\u57df\uff08Availability Zone\uff09\u4e2d\u7684\u8282\u70b9\u53d8\u4e3a\u4e0d\u5065\u5eb7\u65f6\uff0c\u8282\u70b9\u7684\u9a71\u9010\u884c\u4e3a\u5c06\u53d1\u751f\u6539\u53d8\u3002\u8282\u70b9\u63a7\u5236\u5668\u4f1a\u540c\u65f6\u68c0\u67e5\u53ef\u7528\u533a\u57df\u4e2d\u4e0d\u5065\u5eb7\uff08 Ready \u72b6\u51b5\u4e3a Unknown \u6216 False )\u7684\u8282\u70b9\u7684\u767e\u5206\u6bd4\uff1a \u5982\u679c\u4e0d\u5065\u5eb7\u8282\u70b9\u7684\u6bd4\u4f8b\u8d85\u8fc7 --unhealthy-zone-threshold \uff08\u9ed8\u8ba4\u4e3a 0.55\uff09\uff0c\u9a71\u9010\u901f\u7387\u5c06\u4f1a\u964d\u4f4e \u5982\u679c\u96c6\u7fa4\u8f83\u5c0f\uff08\u610f\u5373\u5c0f\u4e8e\u7b49\u4e8e --large-cluster-size-threshold \u4e2a\u8282\u70b9 - \u9ed8\u8ba4\u4e3a 50\uff09\uff0c\u9a71\u9010\u64cd\u4f5c\u5c06\u4f1a\u505c\u6b62 \u5426\u5219\u9a71\u9010\u901f\u7387\u5c06\u964d\u4e3a\u6bcf\u79d2 --secondary-node-eviction-rate \u4e2a\uff08\u9ed8\u8ba4\u4e3a 0.01\uff09 \u5728\u9010\u4e2a\u53ef\u7528\u533a\u57df\u4e2d\u5b9e\u65bd\u8fd9\u4e9b\u7b56\u7565\u7684\u539f\u56e0\u662f\uff0c\u5f53\u4e00\u4e2a\u53ef\u7528\u533a\u57df\u53ef\u80fd\u4ece\u63a7\u5236\u9762\u8131\u79bb\u65f6\u5176\u5b83\u53ef\u7528\u533a\u57df\u53ef\u80fd\u4ecd\u7136\u4fdd\u6301\u8fde\u63a5\u3002\u5982\u679c\u4f60\u7684\u96c6\u7fa4\u6ca1\u6709\u8de8\u8d8a\u4e91\u670d\u52a1\u5546\u7684\u591a\u4e2a\u53ef\u7528\u533a\u57df\uff0c\u90a3\uff08\u6574\u4e2a\u96c6\u7fa4\uff09\u5c31\u53ea\u6709\u4e00\u4e2a\u53ef\u7528\u533a\u57df \u8de8\u591a\u4e2a\u53ef\u7528\u533a\u57df\u90e8\u7f72\u4f60\u7684\u8282\u70b9\u7684\u4e00\u4e2a\u5173\u952e\u539f\u56e0\u662f\u5f53\u67d0\u4e2a\u53ef\u7528\u533a\u57df\u6574\u4f53\u51fa\u73b0\u6545\u969c\u65f6\uff0c\u5de5\u4f5c\u8d1f\u8f7d\u53ef\u4ee5\u8f6c\u79fb\u5230\u5065\u5eb7\u7684\u53ef\u7528\u533a\u57df\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4e00\u4e2a\u53ef\u7528\u533a\u57df\u4e2d\u7684\u6240\u6709\u8282\u70b9\u90fd\u4e0d\u5065\u5eb7\u65f6\uff0c\u8282\u70b9\u63a7\u5236\u5668\u4f1a\u4ee5\u6b63\u5e38\u7684\u901f\u7387 --node-eviction-rate \u8fdb\u884c\u9a71\u9010\u64cd\u4f5c\u3002\u5728\u6240\u6709\u7684\u53ef\u7528\u533a\u57df\u90fd\u4e0d\u5065\u5eb7\uff08\u4e5f\u5373\u96c6\u7fa4\u4e2d\u6ca1\u6709\u5065\u5eb7\u8282\u70b9\uff09\u7684\u6781\u7aef\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u63a7\u5236\u5668\u5c06\u5047\u8bbe\u63a7\u5236\u9762\u4e0e\u8282\u70b9\u95f4\u7684\u8fde\u63a5\u51fa\u4e86\u67d0\u4e9b\u95ee\u9898\uff0c\u5b83\u5c06\u505c\u6b62\u6240\u6709\u9a71\u9010\u52a8\u4f5c\uff08\u5982\u679c\u6545\u969c\u540e\u90e8\u5206\u8282\u70b9\u91cd\u65b0\u8fde\u63a5\uff0c\u8282\u70b9\u63a7\u5236\u5668\u4f1a\u4ece\u5269\u4e0b\u4e0d\u5065\u5eb7\u6216\u8005\u4e0d\u53ef\u8fbe\u8282\u70b9\u4e2d\u9a71\u9010 Pod\uff09 \u8282\u70b9\u63a7\u5236\u5668\u8fd8\u8d1f\u8d23\u9a71\u9010\u8fd0\u884c\u5728\u62e5\u6709 NoExecute \u6c61\u70b9\u7684\u8282\u70b9\u4e0a\u7684 Pod\uff0c\u9664\u975e\u8fd9\u4e9b Pod \u80fd\u591f\u5bb9\u5fcd\u6b64\u6c61\u70b9\u3002\u8282\u70b9\u63a7\u5236\u5668\u8fd8\u8d1f\u8d23\u6839\u636e\u8282\u70b9\u6545\u969c\uff08\u4f8b\u5982\u8282\u70b9\u4e0d\u53ef\u8bbf\u95ee\u6216\u6ca1\u6709\u5c31\u7eea\uff09\u4e3a\u5176\u6dfb\u52a0\u6c61\u70b9\u3002\u8fd9\u610f\u5473\u7740\u8c03\u5ea6\u5668\u4e0d\u4f1a\u5c06 Pod \u8c03\u5ea6\u5230\u4e0d\u5065\u5eb7\u7684\u8282\u70b9\u4e0a \u8d44\u6e90\u5bb9\u91cf\u8ddf\u8e2a Node \u5bf9\u8c61\u4f1a\u8ddf\u8e2a\u8282\u70b9\u4e0a\u8d44\u6e90\u7684\u5bb9\u91cf\uff08\u4f8b\u5982\u53ef\u7528\u5185\u5b58\u548c CPU \u6570\u91cf\uff09\u3002\u901a\u8fc7 \u81ea\u6ce8\u518c \u673a\u5236\u751f\u6210\u7684 Node \u5bf9\u8c61\u4f1a\u5728\u6ce8\u518c\u671f\u95f4\u62a5\u544a\u81ea\u8eab\u5bb9\u91cf\u3002\u5982\u679c\u4f60 \u624b\u52a8 \u6dfb\u52a0\u4e86 Node\uff0c\u4f60\u5c31\u9700\u8981\u5728\u6dfb\u52a0\u8282\u70b9\u65f6\u624b\u52a8\u8bbe\u7f6e\u8282\u70b9\u5bb9\u91cf\u3002 Kubernetes \u8c03\u5ea6\u5668\u4fdd\u8bc1\u8282\u70b9\u4e0a\u6709\u8db3\u591f\u7684\u8d44\u6e90\u4f9b\u5176\u4e0a\u7684\u6240\u6709 Pod \u4f7f\u7528\u3002\u5b83\u4f1a\u68c0\u67e5\u8282\u70b9\u4e0a\u6240\u6709\u5bb9\u5668\u7684\u8bf7\u6c42\u7684\u603b\u548c\u4e0d\u4f1a\u8d85\u8fc7\u8282\u70b9\u7684\u5bb9\u91cf\u3002\u603b\u7684\u8bf7\u6c42\u5305\u62ec\u7531 kubelet \u542f\u52a8\u7684\u6240\u6709\u5bb9\u5668\uff0c\u4f46\u4e0d\u5305\u62ec\u7531\u5bb9\u5668\u8fd0\u884c\u65f6\u76f4\u63a5\u542f\u52a8\u7684\u5bb9\u5668\uff0c\u4e5f\u4e0d\u5305\u62ec\u4e0d\u53d7 kubelet \u63a7\u5236\u7684\u5176\u4ed6\u8fdb\u7a0b \u8bf4\u660e\uff1a \u5982\u679c\u8981\u4e3a\u975e Pod \u8fdb\u7a0b\u663e\u5f0f\u4fdd\u7559\u8d44\u6e90\u3002 \u8bf7\u53c2\u8003 \u4e3a\u7cfb\u7edf\u5b88\u62a4\u8fdb\u7a0b\u9884\u7559\u8d44\u6e90 \u8282\u70b9\u62d3\u6251 \u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.18 [beta] \u5982\u679c\u542f\u7528\u4e86 TopologyManager \u7279\u6027\u95e8\u63a7 \uff0c kubelet \u53ef\u4ee5\u5728\u4f5c\u51fa\u8d44\u6e90\u5206\u914d\u51b3\u7b56\u65f6\u4f7f\u7528\u62d3\u6251\u63d0\u793a\u3002\u53c2\u8003 \u63a7\u5236\u8282\u70b9\u4e0a\u62d3\u6251\u7ba1\u7406\u7b56\u7565 \u4e86\u89e3\u8be6\u7ec6\u4fe1\u606f \u8282\u70b9\u4f53\u9762\u5173\u95ed \u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.21 [beta] kubelet \u4f1a\u5c1d\u8bd5\u68c0\u6d4b\u8282\u70b9\u7cfb\u7edf\u5173\u95ed\u4e8b\u4ef6\u5e76\u7ec8\u6b62\u5728\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u6240\u6709 Pod \u5728\u8282\u70b9\u7ec8\u6b62\u671f\u95f4\uff0ckubelet \u4fdd\u8bc1 Pod \u9075\u4ece\u5e38\u89c4\u7684 Pod \u7ec8\u6b62\u6d41\u7a0b \u8282\u70b9\u4f53\u9762\u5173\u95ed\u7279\u6027\u4f9d\u8d56\u4e8e systemd\uff0c\u56e0\u4e3a\u5b83\u8981\u5229\u7528 systemd \u6291\u5236\u5668\u9501 \u673a\u5236\uff0c\u5728\u7ed9\u5b9a\u7684\u671f\u9650\u5185\u5ef6\u8fdf\u8282\u70b9\u5173\u95ed \u8282\u70b9\u4f53\u9762\u5173\u95ed\u7279\u6027\u53d7 GracefulNodeShutdown \u7279\u6027\u95e8\u63a7 \u63a7\u5236\uff0c\u5728 1.21 \u7248\u672c\u4e2d\u662f\u9ed8\u8ba4\u542f\u7528\u7684 \u6ce8\u610f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e0b\u9762\u63cf\u8ff0\u7684\u4e24\u4e2a\u914d\u7f6e\u9009\u9879\uff0c shutdownGracePeriod \u548c shutdownGracePeriodCriticalPods \u90fd\u662f\u88ab\u8bbe\u7f6e\u4e3a 0 \u7684\uff0c\u56e0\u6b64\u4e0d\u4f1a\u6fc0\u6d3b\u8282\u70b9\u4f53\u9762\u5173\u95ed\u529f\u80fd\u3002\u8981\u6fc0\u6d3b\u6b64\u529f\u80fd\u7279\u6027\uff0c\u8fd9\u4e24\u4e2a kubelet \u914d\u7f6e\u9009\u9879\u8981\u9002\u5f53\u914d\u7f6e\uff0c\u5e76\u8bbe\u7f6e\u4e3a\u975e\u96f6\u503c \u5728\u4f53\u9762\u5173\u95ed\u8282\u70b9\u8fc7\u7a0b\u4e2d\uff0ckubelet \u5206\u4e24\u4e2a\u9636\u6bb5\u6765\u7ec8\u6b62 Pod\uff1a \u7ec8\u6b62\u5728\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u5e38\u89c4 Pod \u7ec8\u6b62\u5728\u8282\u70b9\u4e0a\u8fd0\u884c\u7684 \u5173\u952e Pod \u8282\u70b9\u4f53\u9762\u5173\u95ed\u7684\u7279\u6027\u5bf9\u5e94\u4e24\u4e2a KubeletConfiguration \u9009\u9879\uff1a shutdownGracePeriod \uff1a \u6307\u5b9a\u8282\u70b9\u5e94\u5ef6\u8fdf\u5173\u95ed\u7684\u603b\u6301\u7eed\u65f6\u95f4\u3002\u6b64\u65f6\u95f4\u662f Pod \u4f53\u9762\u7ec8\u6b62\u7684\u65f6\u95f4\u603b\u548c\uff0c\u4e0d\u533a\u5206\u5e38\u89c4 Pod \u8fd8\u662f \u5173\u952e Pod shutdownGracePeriodCriticalPods \uff1a \u5728\u8282\u70b9\u5173\u95ed\u671f\u95f4\u6307\u5b9a\u7528\u4e8e\u7ec8\u6b62 \u5173\u952e Pod \u7684\u6301\u7eed\u65f6\u95f4\u3002\u8be5\u503c\u5e94\u5c0f\u4e8e shutdownGracePeriod \u4f8b\u5982\uff0c\u5982\u679c\u8bbe\u7f6e\u4e86 shutdownGracePeriod=30s \u548c shutdownGracePeriodCriticalPods=10s \uff0c\u5219 kubelet \u5c06\u5ef6\u8fdf 30 \u79d2\u5173\u95ed\u8282\u70b9\u3002\u5728\u5173\u95ed\u671f\u95f4\uff0c\u5c06\u4fdd\u7559\u524d 20\uff0830 - 10\uff09\u79d2\u7528\u4e8e\u4f53\u9762\u7ec8\u6b62\u5e38\u89c4 Pod\uff0c\u800c\u4fdd\u7559\u6700\u540e 10 \u79d2\u7528\u4e8e\u7ec8\u6b62 \u5173\u952e Pod \u8bf4\u660e\uff1a \u5f53 Pod \u5728\u6b63\u5e38\u8282\u70b9\u5173\u95ed\u671f\u95f4\u88ab\u9a71\u9010\u65f6\uff0c\u5b83\u4eec\u4f1a\u88ab\u6807\u8bb0\u4e3a\u5173\u95ed\u3002\u8fd0\u884c kubectl get pods \u65f6\uff0c\u88ab\u9a71\u9010\u7684 Pod \u7684\u72b6\u6001\u663e\u793a\u4e3a Terminated \u3002\u5e76\u4e14 kubectl describe pod \u8868\u793a Pod \u56e0\u8282\u70b9\u5173\u95ed\u800c\u88ab\u9a71\u9010\uff1a Reason: Terminated Message: Pod was terminated in response to imminent node shutdown. \u8282\u70b9\u975e\u4f53\u9762\u5173\u95ed \u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.24 [alpha] \u8282\u70b9\u5173\u95ed\u7684\u64cd\u4f5c\u53ef\u80fd\u65e0\u6cd5\u88ab kubelet \u7684\u8282\u70b9\u5173\u95ed\u7ba1\u7406\u5668\u68c0\u6d4b\u5230\uff0c\u662f\u56e0\u4e3a\u8be5\u547d\u4ee4\u4e0d\u4f1a\u89e6\u53d1 kubelet \u6240\u4f7f\u7528\u7684\u6291\u5236\u9501\u5b9a\u673a\u5236\uff0c\u6216\u8005\u662f\u56e0\u4e3a\u7528\u6237\u9519\u8bef\u7684\u539f\u56e0\uff0c\u5373 ShutdownGracePeriod \u548c ShutdownGracePeriodCriticalPod \u914d\u7f6e\u4e0d\u6b63\u786e\u3002\u8bf7\u53c2\u8003\u4ee5\u4e0a \u8282\u70b9\u4f53\u9762\u5173\u95ed \u90e8\u5206\u4e86\u89e3\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f \u5f53\u67d0\u8282\u70b9\u5173\u95ed\u4f46 kubelet \u7684\u8282\u70b9\u5173\u95ed\u7ba1\u7406\u5668\u672a\u68c0\u6d4b\u5230\u8fd9\u4e00\u4e8b\u4ef6\u65f6\uff0c \u5728\u90a3\u4e2a\u5df2\u5173\u95ed\u8282\u70b9\u4e0a\u3001\u5c5e\u4e8e StatefulSet \u7684 Pod \u5c06\u505c\u6ede\u4e8e\u7ec8\u6b62\u72b6\u6001\uff0c\u5e76\u4e14\u4e0d\u80fd\u79fb\u52a8\u5230\u65b0\u7684\u8fd0\u884c\u8282\u70b9\u4e0a\u3002 \u8fd9\u662f\u56e0\u4e3a\u5df2\u5173\u95ed\u8282\u70b9\u4e0a\u7684 kubelet \u5df2\u4e0d\u5b58\u5728\uff0c\u4ea6\u65e0\u6cd5\u5220\u9664 Pod\uff0c \u56e0\u6b64 StatefulSet \u65e0\u6cd5\u521b\u5efa\u540c\u540d\u7684\u65b0 Pod\u3002 \u5982\u679c Pod \u4f7f\u7528\u4e86\u5377\uff0c\u5219 VolumeAttachments \u4e0d\u4f1a\u4ece\u539f\u6765\u7684\u5df2\u5173\u95ed\u8282\u70b9\u4e0a\u5220\u9664\uff0c \u56e0\u6b64\u8fd9\u4e9b Pod \u6240\u4f7f\u7528\u7684\u5377\u4e5f\u65e0\u6cd5\u6302\u63a5\u5230\u65b0\u7684\u8fd0\u884c\u8282\u70b9\u4e0a\u3002 \u6240\u4ee5\uff0c\u90a3\u4e9b\u4ee5 StatefulSet \u5f62\u5f0f\u8fd0\u884c\u7684\u5e94\u7528\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002 \u5982\u679c\u539f\u6765\u7684\u5df2\u5173\u95ed\u8282\u70b9\u88ab\u6062\u590d\uff0ckubelet \u5c06\u5220\u9664 Pod\uff0c\u65b0\u7684 Pod \u5c06\u88ab\u5728\u4e0d\u540c\u7684\u8fd0\u884c\u8282\u70b9\u4e0a\u521b\u5efa\u3002 \u5982\u679c\u539f\u6765\u7684\u5df2\u5173\u95ed\u8282\u70b9\u6ca1\u6709\u88ab\u6062\u590d\uff0c\u90a3\u4e9b\u5728\u5df2\u5173\u95ed\u8282\u70b9\u4e0a\u7684 Pod \u5c06\u6c38\u8fdc\u6ede\u7559\u5728\u7ec8\u6b62\u72b6\u6001 \u4e3a\u4e86\u7f13\u89e3\u4e0a\u8ff0\u60c5\u51b5\uff0c\u7528\u6237\u53ef\u4ee5\u624b\u52a8\u5c06\u5177\u6709 NoExecute \u6216 NoSchedule \u6548\u679c\u7684 node.kubernetes.io/out-of-service \u6c61\u70b9\u6dfb\u52a0\u5230\u8282\u70b9\u4e0a\uff0c\u6807\u8bb0\u5176\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\u3002\u5982\u679c\u5728 kube-controller-manager \u4e0a\u542f\u7528\u4e86 NodeOutOfServiceVolumeDetach \u7279\u6027\u95e8\u63a7 \uff0c\u5e76\u4e14\u8282\u70b9\u88ab\u901a\u8fc7\u6c61\u70b9\u6807\u8bb0\u4e3a\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\uff0c\u5982\u679c\u8282\u70b9 Pod \u4e0a\u6ca1\u6709\u8bbe\u7f6e\u5bf9\u5e94\u7684\u5bb9\u5fcd\u5ea6\uff0c\u90a3\u4e48\u8fd9\u6837\u7684 Pod \u5c06\u88ab\u5f3a\u5236\u5220\u9664\uff0c\u5e76\u4e14\u8be5\u5728\u8282\u70b9\u4e0a\u88ab\u7ec8\u6b62\u7684 Pod \u5c06\u7acb\u5373\u8fdb\u884c\u5377\u5206\u79bb\u64cd\u4f5c\u3002\u8fd9\u6837\u5c31\u5141\u8bb8\u90a3\u4e9b\u5728\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\u8282\u70b9\u4e0a\u7684 Pod \u80fd\u5728\u5176\u4ed6\u8282\u70b9\u4e0a\u5feb\u901f\u6062\u590d \u5728\u975e\u4f53\u9762\u5173\u95ed\u671f\u95f4\uff0cPod \u5206\u4e24\u4e2a\u9636\u6bb5\u7ec8\u6b62\uff1a \u5f3a\u5236\u5220\u9664\u6ca1\u6709\u5339\u914d\u7684 out-of-service \u5bb9\u5fcd\u5ea6\u7684 Pod \u7acb\u5373\u5bf9\u6b64\u7c7b Pod \u6267\u884c\u5206\u79bb\u5377\u64cd\u4f5c \u8bf4\u660e\uff1a \u5728\u6dfb\u52a0 node.kubernetes.io/out-of-service \u6c61\u70b9\u4e4b\u524d\uff0c\u5e94\u8be5\u9a8c\u8bc1\u8282\u70b9\u5df2\u7ecf\u5904\u4e8e\u5173\u95ed\u6216\u65ad\u7535\u72b6\u6001\uff08\u800c\u4e0d\u662f\u5728\u91cd\u65b0\u542f\u52a8\u4e2d\uff09 \u5c06 Pod \u79fb\u52a8\u5230\u65b0\u8282\u70b9\u540e\uff0c\u7528\u6237\u9700\u8981\u624b\u52a8\u79fb\u9664\u505c\u6b62\u670d\u52a1\u7684\u6c61\u70b9\uff0c\u5e76\u4e14\u7528\u6237\u8981\u68c0\u67e5\u5173\u95ed\u8282\u70b9\u662f\u5426\u5df2\u6062\u590d\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6700\u521d\u6dfb\u52a0\u6c61\u70b9\u7684\u7528\u6237 \u57fa\u4e8e Pod \u4f18\u5148\u7ea7\u7684\u8282\u70b9\u4f53\u9762\u5173\u95ed \u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.23 [alpha] \u4e3a\u4e86\u5728\u8282\u70b9\u4f53\u9762\u5173\u95ed\u671f\u95f4\u63d0\u4f9b\u66f4\u591a\u7684\u7075\u6d3b\u6027\uff0c\u5c24\u5176\u662f\u5904\u7406\u5173\u95ed\u671f\u95f4\u7684 Pod \u6392\u5e8f\u95ee\u9898\uff0c\u8282\u70b9\u4f53\u9762\u5173\u95ed\u673a\u5236\u80fd\u591f\u5173\u6ce8 Pod \u7684 PriorityClass \u8bbe\u7f6e\uff0c\u524d\u63d0\u662f\u4f60\u5df2\u7ecf\u5728\u96c6\u7fa4\u4e2d\u542f\u7528\u4e86\u6b64\u529f\u80fd\u7279\u6027\u3002\u6b64\u529f\u80fd\u7279\u6027\u5141\u8bb8\u96c6\u7fa4\u7ba1\u7406\u5458\u57fa\u4e8e Pod \u7684 \u4f18\u5148\u7ea7\u7c7b\uff08Priority Class\uff09 \u663e\u5f0f\u5730\u5b9a\u4e49\u8282\u70b9\u4f53\u9762\u5173\u95ed\u671f\u95f4 Pod \u7684\u5904\u7406\u987a\u5e8f \u524d\u6587\u6240\u8ff0\u7684 \u8282\u70b9\u4f53\u9762\u5173\u95ed \u7279\u6027\u80fd\u591f\u5206\u4e24\u4e2a\u9636\u6bb5\u5173\u95ed Pod\uff0c\u9996\u5148\u5173\u95ed\u7684\u662f\u975e\u5173\u952e\u7684 Pod\uff0c\u4e4b\u540e\u518d\u5904\u7406\u5173\u952e Pod\u3002\u5982\u679c\u9700\u8981\u663e\u5f0f\u5730\u4ee5\u66f4\u7ec6\u7c92\u5ea6\u5b9a\u4e49\u5173\u95ed\u671f\u95f4 Pod \u7684\u5904\u7406\u987a\u5e8f\uff0c\u9700\u8981\u4e00\u5b9a\u7684\u7075\u6d3b\u5ea6\uff0c\u8fd9\u65f6\u53ef\u4ee5\u4f7f\u7528\u57fa\u4e8e Pod \u4f18\u5148\u7ea7\u7684\u4f53\u9762\u5173\u95ed\u673a\u5236 \u5f53\u8282\u70b9\u4f53\u9762\u5173\u95ed\u80fd\u591f\u5904\u7406 Pod \u4f18\u5148\u7ea7\u65f6\uff0c\u8282\u70b9\u4f53\u9762\u5173\u95ed\u7684\u5904\u7406\u53ef\u4ee5\u5206\u4e3a\u591a\u4e2a\u9636\u6bb5\uff0c \u6bcf\u4e2a\u9636\u6bb5\u5173\u95ed\u7279\u5b9a\u4f18\u5148\u7ea7\u7c7b\u7684 Pod\u3002kubelet \u53ef\u4ee5\u88ab\u914d\u7f6e\u4e3a\u6309\u786e\u5207\u7684\u9636\u6bb5\u5904\u7406 Pod\uff0c \u4e14\u6bcf\u4e2a\u9636\u6bb5\u53ef\u4ee5\u72ec\u7acb\u8bbe\u7f6e\u5173\u95ed\u65f6\u95f4 \u5047\u8bbe\u96c6\u7fa4\u4e2d\u5b58\u5728\u4ee5\u4e0b\u81ea\u5b9a\u4e49\u7684 Pod \u4f18\u5148\u7ea7\u7c7b Pod \u4f18\u5148\u7ea7\u7c7b\u540d\u79f0 Pod \u4f18\u5148\u7ea7\u7c7b\u6570\u503c custom-class-a 100000 custom-class-b 10000 custom-class-c 1000 regular/unset 0 \u5728 kubelet \u914d\u7f6e \u4e2d\uff0c shutdownGracePeriodByPodPriority \u53ef\u80fd\u770b\u8d77\u6765\u662f\u8fd9\u6837\uff1a Pod \u4f18\u5148\u7ea7\u7c7b\u6570\u503c \u5173\u95ed\u671f\u9650 100000 10 \u79d2 10000 180 \u79d2 1000 120 \u79d2 0 60 \u79d2 \u5bf9\u5e94\u7684 kubelet \u914d\u7f6e YAML \u5c06\u4f1a\u662f\uff1a shutdownGracePeriodByPodPriority : - priority : 100000 shutdownGracePeriodSeconds : 10 - priority : 10000 shutdownGracePeriodSeconds : 180 - priority : 1000 shutdownGracePeriodSeconds : 120 - priority : 0 shutdownGracePeriodSeconds : 60 \u4e0a\u9762\u7684\u8868\u683c\u8868\u660e\uff0c\u6240\u6709 priority \u503c\u5927\u4e8e\u7b49\u4e8e 100000 \u7684 Pod \u4f1a\u5f97\u5230 10 \u79d2\u949f\u671f\u9650\u505c\u6b62\uff0c\u6240\u6709 priority \u503c\u4ecb\u4e8e 10000 \u548c 100000 \u4e4b\u95f4\u7684 Pod \u4f1a\u5f97\u5230 180 \u79d2\u949f\u671f\u9650\u505c\u6b62\uff0c\u6240\u6709 priority \u503c\u4ecb\u4e8e 1000 \u548c 10000 \u4e4b\u95f4\u7684 Pod \u4f1a\u5f97\u5230 120 \u79d2\u949f\u671f\u9650\u505c\u6b62\uff0c\u6240\u6709\u5176\u4ed6 Pod \u5c06\u83b7\u5f97 60 \u79d2\u7684\u65f6\u95f4\u505c\u6b62 \u7528\u6237\u4e0d\u9700\u8981\u4e3a\u6240\u6709\u7684\u4f18\u5148\u7ea7\u7c7b\u90fd\u8bbe\u7f6e\u6570\u503c\u3002\u4f8b\u5982\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u8fd9\u79cd\u914d\u7f6e\uff1a Pod \u4f18\u5148\u7ea7\u7c7b\u6570\u503c \u5173\u95ed\u671f\u9650 100000 300 \u79d2 1000 120 \u79d2 0 60 \u79d2 \u5728\u4e0a\u9762\u8fd9\u4e2a\u573a\u666f\u4e2d\uff0c\u4f18\u5148\u7ea7\u7c7b\u4e3a custom-class-b \u7684 Pod \u4f1a\u4e0e\u4f18\u5148\u7ea7\u7c7b\u4e3a custom-class-c \u7684 Pod \u5728\u5173\u95ed\u65f6\u6309\u76f8\u540c\u671f\u9650\u5904\u7406 \u5982\u679c\u5728\u7279\u5b9a\u7684\u8303\u56f4\u5185\u4e0d\u5b58\u5728 Pod\uff0c\u5219 kubelet \u4e0d\u4f1a\u7b49\u5f85\u5bf9\u5e94\u4f18\u5148\u7ea7\u8303\u56f4\u7684 Pod\u3002kubelet \u4f1a\u76f4\u63a5\u8df3\u5230\u4e0b\u4e00\u4e2a\u4f18\u5148\u7ea7\u6570\u503c\u8303\u56f4\u8fdb\u884c\u5904\u7406 \u5982\u679c\u6b64\u529f\u80fd\u7279\u6027\u88ab\u542f\u7528\uff0c\u4f46\u6ca1\u6709\u63d0\u4f9b\u914d\u7f6e\u6570\u636e\uff0c\u5219\u4e0d\u4f1a\u51fa\u73b0\u6392\u5e8f\u64cd\u4f5c \u4f7f\u7528\u6b64\u529f\u80fd\u7279\u6027\u9700\u8981\u542f\u7528 GracefulNodeShutdownBasedOnPodPriority \u7279\u6027\u95e8\u63a7 \uff0c\u5e76\u5c06 kubelet \u914d\u7f6e \u4e2d\u7684 shutdownGracePeriodByPodPriority \u8bbe\u7f6e\u4e3a\u671f\u671b\u7684\u914d\u7f6e\uff0c\u5176\u4e2d\u5305\u542b Pod \u7684\u4f18\u5148\u7ea7\u7c7b\u6570\u503c\u4ee5\u53ca\u5bf9\u5e94\u7684\u5173\u95ed\u671f\u9650 \u8bf4\u660e\uff1a \u5728\u8282\u70b9\u4f53\u9762\u5173\u95ed\u671f\u95f4\u8003\u8651 Pod \u4f18\u5148\u7ea7\u7684\u80fd\u529b\u662f\u4f5c\u4e3a Kubernetes v1.23 \u4e2d\u7684 Alpha \u529f\u80fd\u5f15\u5165\u7684\u3002 \u5728 Kubernetes 1.25 \u4e2d\u8be5\u529f\u80fd\u662f Beta \u7248\uff0c\u9ed8\u8ba4\u542f\u7528 kubelet \u5b50\u7cfb\u7edf\u4e2d\u4f1a\u751f\u6210 graceful_shutdown_start_time_seconds \u548c graceful_shutdown_end_time_seconds \u5ea6\u91cf\u6307\u6807\u4ee5\u4fbf\u76d1\u89c6\u8282\u70b9\u5173\u95ed\u884c\u4e3a \u4ea4\u6362\u5185\u5b58\u7ba1\u7406 \u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.22 [alpha] \u5728 Kubernetes 1.22 \u4e4b\u524d\uff0c\u8282\u70b9\u4e0d\u652f\u6301\u4f7f\u7528\u4ea4\u6362\u5185\u5b58\uff0c\u5e76\u4e14\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u5728\u8282\u70b9\u4e0a\u68c0\u6d4b\u5230\u4ea4\u6362\u5185\u5b58\u914d\u7f6e\uff0ckubelet \u5c06\u65e0\u6cd5\u542f\u52a8\u3002\u5728 1.22 \u4ee5\u540e\uff0c\u53ef\u4ee5\u9010\u4e2a\u8282\u70b9\u5730\u542f\u7528\u4ea4\u6362\u5185\u5b58\u652f\u6301 \u8981\u5728\u8282\u70b9\u4e0a\u542f\u7528\u4ea4\u6362\u5185\u5b58\uff0c\u5fc5\u987b\u542f\u7528kubelet \u7684 NodeSwap \u7279\u6027\u95e8\u63a7\uff0c\u540c\u65f6\u4f7f\u7528 --fail-swap-on \u547d\u4ee4\u884c\u53c2\u6570\u6216\u8005\u5c06 failSwapOn \u914d\u7f6e \u8bbe\u7f6e\u4e3a false \u7528\u6237\u8fd8\u53ef\u4ee5\u9009\u62e9\u914d\u7f6e memorySwap.swapBehavior \u4ee5\u6307\u5b9a\u8282\u70b9\u4f7f\u7528\u4ea4\u6362\u5185\u5b58\u7684\u65b9\u5f0f\u3002\u4f8b\u5982: memorySwap : swapBehavior : LimitedSwap \u53ef\u7528\u7684 swapBehavior \u7684\u914d\u7f6e\u9009\u9879\u6709\uff1a LimitedSwap \uff1aKubernetes \u5de5\u4f5c\u8d1f\u8f7d\u7684\u4ea4\u6362\u5185\u5b58\u4f1a\u53d7\u9650\u5236\u3002\u4e0d\u53d7 Kubernetes \u7ba1\u7406\u7684\u8282\u70b9\u4e0a\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4ecd\u7136\u53ef\u4ee5\u4ea4\u6362 UnlimitedSwap \uff1aKubernetes \u5de5\u4f5c\u8d1f\u8f7d\u53ef\u4ee5\u4f7f\u7528\u5c3d\u53ef\u80fd\u591a\u7684\u4ea4\u6362\u5185\u5b58\u8bf7\u6c42\uff0c\u4e00\u76f4\u5230\u8fbe\u5230\u7cfb\u7edf\u9650\u5236\u4e3a\u6b62 \u5982\u679c\u542f\u7528\u4e86\u7279\u6027\u95e8\u63a7\u4f46\u662f\u672a\u6307\u5b9a memorySwap \u7684\u914d\u7f6e\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b kubelet \u5c06\u4f7f\u7528 LimitedSwap \u8bbe\u7f6e LimitedSwap \u8fd9\u79cd\u8bbe\u7f6e\u7684\u884c\u4e3a\u53d6\u51b3\u4e8e\u8282\u70b9\u8fd0\u884c\u7684\u662f v1 \u8fd8\u662f v2 \u7684\u63a7\u5236\u7ec4\uff08\u4e5f\u5c31\u662f cgroups \uff09\uff1a cgroupsv1: Kubernetes \u5de5\u4f5c\u8d1f\u8f7d\u53ef\u4ee5\u4f7f\u7528\u5185\u5b58\u548c\u4ea4\u6362\uff0c\u4e0a\u9650\u4e3a Pod \u7684\u5185\u5b58\u9650\u5236\u503c\uff08\u5982\u679c\u8bbe\u7f6e\u4e86\u7684\u8bdd\uff09\u3002 cgroupsv2: Kubernetes \u5de5\u4f5c\u8d1f\u8f7d\u4e0d\u80fd\u4f7f\u7528\u4ea4\u6362\u5185\u5b58\u3002 \u5982\u9700\u66f4\u591a\u4fe1\u606f\u4ee5\u53ca\u534f\u52a9\u6d4b\u8bd5\u548c\u63d0\u4f9b\u53cd\u9988\uff0c\u8bf7\u53c2\u89c1 KEP-2400 \u53ca\u5176 \u8bbe\u8ba1\u63d0\u6848","title":"Kubernetes \u67b6\u6784 - \u8282\u70b9"},{"location":"Chapter02/chapter02-01/#kubernetes-","text":"\u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u8282\u70b9 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 44CF6E6 Kubernetes \u901a\u8fc7\u5c06\u5bb9\u5668\u653e\u5165\u5728\u8282\u70b9\uff08Node\uff09\u4e0a\u8fd0\u884c\u7684 Pod \u4e2d\u6765\u6267\u884c\u4f60\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002\u8282\u70b9\u53ef\u4ee5\u662f\u4e00\u4e2a\u865a\u62df\u673a\u6216\u8005\u7269\u7406\u673a\u5668\uff0c\u53d6\u51b3\u4e8e\u6240\u5728\u7684\u96c6\u7fa4\u914d\u7f6e\u3002\u6bcf\u4e2a\u8282\u70b9\u5305\u542b\u8fd0\u884c Pod \u6240\u9700\u7684\u670d\u52a1\uff1b\u8fd9\u4e9b\u8282\u70b9\u7531\u63a7\u5236\u9762\u8d1f\u8d23\u7ba1\u7406 \u901a\u5e38\u96c6\u7fa4\u4e2d\u4f1a\u6709\u82e5\u5e72\u4e2a\u8282\u70b9\uff1b\u800c\u5728\u4e00\u4e2a\u5b66\u4e60\u6240\u7528\u6216\u8005\u8d44\u6e90\u53d7\u9650\u7684\u73af\u5883\u4e2d\uff0c\u4f60\u7684\u96c6\u7fa4\u4e2d\u4e5f\u53ef\u80fd\u53ea\u6709\u4e00\u4e2a\u8282\u70b9 \u8282\u70b9\u4e0a\u7684 \u7ec4\u4ef6 \u5305\u62ec kubelet\u3001\u5bb9\u5668\u8fd0\u884c\u65f6\u4ee5\u53ca kube-proxy","title":"Kubernetes \u67b6\u6784 - \u8282\u70b9"},{"location":"Chapter02/chapter02-01/#management","text":"\u5411 API \u670d\u52a1\u5668\u6dfb\u52a0\u8282\u70b9\u7684\u65b9\u5f0f\u4e3b\u8981\u6709\u4e24\u79cd\uff1a \u8282\u70b9\u4e0a\u7684 kubelet \u5411\u63a7\u5236\u9762\u6267\u884c\u81ea\u6ce8\u518c \u4f60\uff08\u6216\u8005\u522b\u7684\u4ec0\u4e48\u4eba\uff09\u624b\u52a8\u6dfb\u52a0\u4e00\u4e2a Node \u5bf9\u8c61 \u5728\u4f60\u521b\u5efa\u4e86 Node \u5bf9\u8c61\u6216\u8005\u8282\u70b9\u4e0a\u7684 kubelet \u6267\u884c\u4e86\u81ea\u6ce8\u518c\u64cd\u4f5c\u4e4b\u540e\uff0c\u63a7\u5236\u9762\u4f1a\u68c0\u67e5\u65b0\u7684 Node \u5bf9\u8c61\u662f\u5426\u5408\u6cd5\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u5c1d\u8bd5\u4f7f\u7528\u4e0b\u9762\u7684 JSON \u5bf9\u8c61\u6765\u521b\u5efa Node \u5bf9\u8c61\uff1a { \"kind\" : \"Node\" , \"apiVersion\" : \"v1\" , \"metadata\" : { \"name\" : \"10.240.79.157\" , \"labels\" : { \"name\" : \"my-first-k8s-node\" } } } Kubernetes \u4f1a\u5728\u5185\u90e8\u521b\u5efa\u4e00\u4e2a Node \u5bf9\u8c61\u4f5c\u4e3a\u8282\u70b9\u7684\u8868\u793a\u3002Kubernetes \u68c0\u67e5 kubelet \u5411 API \u670d\u52a1\u5668\u6ce8\u518c\u8282\u70b9\u65f6\u4f7f\u7528\u7684 metadata.name \u5b57\u6bb5\u662f\u5426\u5339\u914d\u3002\u5982\u679c\u8282\u70b9\u662f\u5065\u5eb7\u7684\uff08\u5373\u6240\u6709\u5fc5\u8981\u7684\u670d\u52a1\u90fd\u5728\u8fd0\u884c\u4e2d\uff09\uff0c\u5219\u8be5\u8282\u70b9\u53ef\u4ee5\u7528\u6765\u8fd0\u884c Pod\u3002\u5426\u5219\uff0c\u76f4\u5230\u8be5\u8282\u70b9\u53d8\u4e3a\u5065\u5eb7\u4e4b\u524d\uff0c\u6240\u6709\u7684\u96c6\u7fa4\u6d3b\u52a8\u90fd\u4f1a\u5ffd\u7565\u8be5\u8282\u70b9 \u8bf4\u660e\uff1a Kubernetes \u4f1a\u4e00\u76f4\u4fdd\u5b58\u7740\u975e\u6cd5\u8282\u70b9\u5bf9\u5e94\u7684\u5bf9\u8c61\uff0c\u5e76\u6301\u7eed\u68c0\u67e5\u8be5\u8282\u70b9\u662f\u5426\u5df2\u7ecf\u53d8\u5f97\u5065\u5eb7\u3002\u4f60\uff0c\u6216\u8005\u67d0\u4e2a\u63a7\u5236\u5668\u5fc5\u987b\u663e\u5f0f\u5730\u5220\u9664\u8be5 Node \u5bf9\u8c61\u4ee5\u505c\u6b62\u5065\u5eb7\u68c0\u67e5\u64cd\u4f5c Node \u5bf9\u8c61\u7684\u540d\u79f0\u5fc5\u987b\u662f\u5408\u6cd5\u7684 DNS \u5b50\u57df\u540d","title":"\u7ba1\u7406"},{"location":"Chapter02/chapter02-01/#node-name-uniqueness","text":"\u8282\u70b9\u7684 \u540d\u79f0 \u7528\u6765\u6807\u8bc6 Node \u5bf9\u8c61\u3002\u6ca1\u6709\u4e24\u4e2a Node \u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\u76f8\u540c\u7684\u540d\u79f0\u3002Kubernetes \u8fd8\u5047\u5b9a\u540d\u5b57\u76f8\u540c\u7684\u8d44\u6e90\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61\u3002\u5c31 Node \u800c\u8a00\uff0c\u9690\u5f0f\u5047\u5b9a\u4f7f\u7528\u76f8\u540c\u540d\u79f0\u7684\u5b9e\u4f8b\u4f1a\u5177\u6709\u76f8\u540c\u7684\u72b6\u6001\uff08\u4f8b\u5982\u7f51\u7edc\u914d\u7f6e\u3001\u6839\u78c1\u76d8\u5185\u5bb9\uff09\u548c\u7c7b\u4f3c\u8282\u70b9\u6807\u7b7e\u8fd9\u7c7b\u5c5e\u6027\u3002\u8fd9\u53ef\u80fd\u5728\u8282\u70b9\u88ab\u66f4\u6539\u4f46\u5176\u540d\u79f0\u672a\u53d8\u65f6\u5bfc\u81f4\u7cfb\u7edf\u72b6\u6001\u4e0d\u4e00\u81f4\u3002\u5982\u679c\u67d0\u4e2a Node \u9700\u8981\u88ab\u66ff\u6362\u6216\u8005\u5927\u91cf\u53d8\u66f4\uff0c\u9700\u8981\u4ece API \u670d\u52a1\u5668\u79fb\u9664\u73b0\u6709\u7684 Node \u5bf9\u8c61\uff0c\u4e4b\u540e\u518d\u5728\u66f4\u65b0\u4e4b\u540e\u91cd\u65b0\u5c06\u5176\u52a0\u5165","title":"\u8282\u70b9\u540d\u79f0\u552f\u4e00\u6027"},{"location":"Chapter02/chapter02-01/#self-registration-of-nodes","text":"\u5f53 kubelet \u6807\u5fd7 --register-node \u4e3a true\uff08\u9ed8\u8ba4\uff09\u65f6\uff0c\u5b83\u4f1a\u5c1d\u8bd5\u5411 API \u670d\u52a1\u6ce8\u518c\u81ea\u5df1\u3002\u8fd9\u662f\u9996\u9009\u6a21\u5f0f\uff0c\u88ab\u7edd\u5927\u591a\u6570\u53d1\u884c\u7248\u9009\u7528 \u5bf9\u4e8e\u81ea\u6ce8\u518c\u6a21\u5f0f\uff0ckubelet \u4f7f\u7528\u4e0b\u5217\u53c2\u6570\u542f\u52a8\uff1a --kubeconfig - \u7528\u4e8e\u5411 API \u670d\u52a1\u5668\u6267\u884c\u8eab\u4efd\u8ba4\u8bc1\u6240\u7528\u7684\u51ed\u636e\u7684\u8def\u5f84 --cloud-provider - \u4e0e\u67d0\u4e91\u9a71\u52a8\u8fdb\u884c\u901a\u4fe1\u4ee5\u8bfb\u53d6\u4e0e\u81ea\u8eab\u76f8\u5173\u7684\u5143\u6570\u636e\u7684\u65b9\u5f0f --register-node - \u81ea\u52a8\u5411 API \u670d\u52a1\u6ce8\u518c --register-with-taints - \u4f7f\u7528\u6240\u7ed9\u7684\u6c61\u70b9\u5217\u8868\uff08\u9017\u53f7\u5206\u9694\u7684 <key>=<value>:<effect> \uff09\u6ce8\u518c\u8282\u70b9\u3002\u5f53 register-node \u4e3a false \u65f6\u65e0\u6548 --node-ip - \u8282\u70b9 IP \u5730\u5740 --node-labels - \u5728\u96c6\u7fa4\u4e2d\u6ce8\u518c\u8282\u70b9\u65f6\u8981\u6dfb\u52a0\u7684\u6807\u7b7e\u3002\uff08\u53c2\u89c1 NodeRestriction \u51c6\u5165\u63a7\u5236\u63d2\u4ef6 \u6240\u5b9e\u65bd\u7684\u6807\u7b7e\u9650\u5236\uff09 --node-status-update-frequency - \u6307\u5b9a kubelet \u5411\u63a7\u5236\u9762\u53d1\u9001\u72b6\u6001\u7684\u9891\u7387 \u542f\u7528 Node \u9274\u6743\u6a21\u5f0f \u548c NodeRestriction \u51c6\u5165\u63d2\u4ef6 \u65f6\uff0c\u4ec5\u6388\u6743 kubelet \u521b\u5efa\u6216\u4fee\u6539\u5176\u81ea\u5df1\u7684\u8282\u70b9\u8d44\u6e90 \u8bf4\u660e\uff1a \u6b63\u5982 \u8282\u70b9\u540d\u79f0\u552f\u4e00\u6027 \u4e00\u8282\u6240\u8ff0\uff0c\u5f53 Node \u7684\u914d\u7f6e\u9700\u8981\u88ab\u66f4\u65b0\u65f6\uff0c\u4e00\u79cd\u597d\u7684\u505a\u6cd5\u662f\u91cd\u65b0\u5411 API \u670d\u52a1\u5668\u6ce8\u518c\u8be5\u8282\u70b9\u3002\u4f8b\u5982\uff0c\u5982\u679c kubelet \u91cd\u542f\u65f6\u5176 --node-labels \u662f\u65b0\u7684\u503c\u96c6\uff0c\u4f46\u540c\u4e00\u4e2a Node \u540d\u79f0\u5df2\u7ecf\u88ab\u4f7f\u7528\uff0c\u5219\u6240\u4f5c\u53d8\u66f4\u4e0d\u4f1a\u8d77\u4f5c\u7528\uff0c \u56e0\u4e3a\u8282\u70b9\u6807\u7b7e\u662f\u5728 Node \u6ce8\u518c\u65f6\u5b8c\u6210\u7684 \u5982\u679c\u5728 kubelet \u91cd\u542f\u671f\u95f4 Node \u914d\u7f6e\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5df2\u7ecf\u88ab\u8c03\u5ea6\u5230\u67d0 Node \u4e0a\u7684 Pod \u53ef\u80fd\u4f1a\u51fa\u73b0\u884c\u4e3a\u4e0d\u6b63\u5e38\u6216\u8005\u51fa\u73b0\u5176\u4ed6\u95ee\u9898\uff0c\u4f8b\u5982\uff0c\u5df2\u7ecf\u8fd0\u884c\u7684 Pod \u53ef\u80fd\u901a\u8fc7\u6c61\u70b9\u673a\u5236\u8bbe\u7f6e\u4e86\u4e0e Node \u4e0a\u65b0\u8bbe\u7f6e\u7684\u6807\u7b7e\u76f8\u6392\u65a5\u7684\u89c4\u5219\uff0c\u4e5f\u6709\u4e00\u4e9b\u5176\u4ed6 Pod\uff0c \u672c\u6765\u4e0e\u6b64 Pod \u4e4b\u95f4\u5b58\u5728\u4e0d\u517c\u5bb9\u7684\u95ee\u9898\uff0c\u4e5f\u4f1a\u56e0\u4e3a\u65b0\u7684\u6807\u7b7e\u8bbe\u7f6e\u800c\u88ab\u8c03\u5230\u540c\u4e00\u8282\u70b9\u3002 \u8282\u70b9\u91cd\u65b0\u6ce8\u518c\u64cd\u4f5c\u53ef\u4ee5\u786e\u4fdd\u8282\u70b9\u4e0a\u6240\u6709 Pod \u90fd\u88ab\u6392\u7a7a\u5e76\u88ab\u6b63\u786e\u5730\u91cd\u65b0\u8c03\u5ea6","title":"\u8282\u70b9\u81ea\u6ce8\u518c"},{"location":"Chapter02/chapter02-01/#manual-node-administration","text":"\u4f60\u53ef\u4ee5\u4f7f\u7528 kubectl \u6765\u521b\u5efa\u548c\u4fee\u6539 Node \u5bf9\u8c61 \u5982\u679c\u4f60\u5e0c\u671b\u624b\u52a8\u521b\u5efa\u8282\u70b9\u5bf9\u8c61\u65f6\uff0c\u8bf7\u8bbe\u7f6e kubelet \u6807\u5fd7 --register-node=false \u4f60\u53ef\u4ee5\u4fee\u6539 Node \u5bf9\u8c61\uff08\u5ffd\u7565 --register-node \u8bbe\u7f6e\uff09\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u4fee\u6539\u8282\u70b9\u4e0a\u7684\u6807\u7b7e\u6216\u5e76\u6807\u8bb0\u5176\u4e3a\u4e0d\u53ef\u8c03\u5ea6 \u4f60\u53ef\u4ee5\u7ed3\u5408\u4f7f\u7528 Node \u4e0a\u7684\u6807\u7b7e\u548c Pod \u4e0a\u7684\u9009\u62e9\u7b97\u7b26\u6765\u63a7\u5236\u8c03\u5ea6\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u9650\u5236\u67d0 Pod \u53ea\u80fd\u5728\u7b26\u5408\u8981\u6c42\u7684\u8282\u70b9\u5b50\u96c6\u4e0a\u8fd0\u884c \u5982\u679c\u6807\u8bb0\u8282\u70b9\u4e3a\u4e0d\u53ef\u8c03\u5ea6\uff08unschedulable\uff09\uff0c\u5c06\u963b\u6b62\u65b0 Pod \u8c03\u5ea6\u5230\u8be5 Node \u4e4b\u4e0a\uff0c\u4f46\u4e0d\u4f1a\u5f71\u54cd\u4efb\u4f55\u5df2\u7ecf\u5728\u5176\u4e0a\u7684 Pod\u3002\u8fd9\u662f\u91cd\u542f\u8282\u70b9\u6216\u8005\u6267\u884c\u5176\u4ed6\u7ef4\u62a4\u64cd\u4f5c\u4e4b\u524d\u7684\u4e00\u4e2a\u6709\u7528\u7684\u51c6\u5907\u6b65\u9aa4 \u8981\u6807\u8bb0\u4e00\u4e2a Node \u4e3a\u4e0d\u53ef\u8c03\u5ea6\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a kubectl cordon $NODENAME \u66f4\u591a\u7ec6\u8282\u53c2\u8003 \u5b89\u5168\u5730\u817e\u7a7a\u8282\u70b9 \u8bf4\u660e\uff1a \u88ab DaemonSet \u63a7\u5236\u5668\u521b\u5efa\u7684 Pod \u80fd\u591f\u5bb9\u5fcd\u8282\u70b9\u7684\u4e0d\u53ef\u8c03\u5ea6\u5c5e\u6027\u3002 DaemonSet \u901a\u5e38\u63d0\u4f9b\u8282\u70b9\u672c\u5730\u7684\u670d\u52a1\uff0c\u5373\u4f7f\u8282\u70b9\u4e0a\u7684\u8d1f\u8f7d\u5e94\u7528\u5df2\u7ecf\u88ab\u817e\u7a7a\uff0c \u8fd9\u4e9b\u670d\u52a1\u4e5f\u4ecd\u9700\u8fd0\u884c\u5728\u8282\u70b9\u4e4b\u4e0a","title":"\u624b\u52a8\u8282\u70b9\u7ba1\u7406"},{"location":"Chapter02/chapter02-01/#node-status","text":"\u4e00\u4e2a\u8282\u70b9\u7684\u72b6\u6001\u5305\u542b\u4ee5\u4e0b\u4fe1\u606f: \u5730\u5740\uff08Addresses\uff09 \u72b6\u51b5\uff08Condition\uff09 \u5bb9\u91cf\u4e0e\u53ef\u5206\u914d\uff08Capacity\uff09 \u4fe1\u606f\uff08Info\uff09 \u4f60\u53ef\u4ee5\u4f7f\u7528 kubectl \u6765\u67e5\u770b\u8282\u70b9\u72b6\u6001\u548c\u5176\u4ed6\u7ec6\u8282\u4fe1\u606f\uff1a kubectl describe node <\u8282\u70b9\u540d\u79f0> \u4e0b\u9762\u5bf9\u6bcf\u4e2a\u90e8\u5206\u8fdb\u884c\u8be6\u7ec6\u63cf\u8ff0","title":"\u8282\u70b9\u72b6\u6001"},{"location":"Chapter02/chapter02-01/#addresses","text":"\u8fd9\u4e9b\u5b57\u6bb5\u7684\u7528\u6cd5\u53d6\u51b3\u4e8e\u4f60\u7684\u4e91\u670d\u52a1\u5546\u6216\u8005\u7269\u7406\u673a\u914d\u7f6e HostName\uff1a\u7531\u8282\u70b9\u7684\u5185\u6838\u62a5\u544a\u3002\u53ef\u4ee5\u901a\u8fc7 kubelet \u7684 --hostname-override \u53c2\u6570\u8986\u76d6 ExternalIP\uff1a\u901a\u5e38\u662f\u8282\u70b9\u7684\u53ef\u5916\u90e8\u8def\u7531\uff08\u4ece\u96c6\u7fa4\u5916\u53ef\u8bbf\u95ee\uff09\u7684 IP \u5730\u5740 InternalIP\uff1a\u901a\u5e38\u662f\u8282\u70b9\u7684\u4ec5\u53ef\u5728\u96c6\u7fa4\u5185\u90e8\u8def\u7531\u7684 IP \u5730\u5740","title":"\u5730\u5740"},{"location":"Chapter02/chapter02-01/#condition","text":"conditions \u5b57\u6bb5\u63cf\u8ff0\u4e86\u6240\u6709 Running \u8282\u70b9\u7684\u72b6\u51b5\u3002\u72b6\u51b5\u7684\u793a\u4f8b\u5305\u62ec\uff1a \u8282\u70b9\u72b6\u51b5 \u63cf\u8ff0 Ready \u5982\u8282\u70b9\u662f\u5065\u5eb7\u7684\u5e76\u5df2\u7ecf\u51c6\u5907\u597d\u63a5\u6536 Pod \u5219\u4e3a True \uff1b False \u8868\u793a\u8282\u70b9\u4e0d\u5065\u5eb7\u800c\u4e14\u4e0d\u80fd\u63a5\u6536 Pod\uff1b Unknown \u8868\u793a\u8282\u70b9\u63a7\u5236\u5668\u5728\u6700\u8fd1 node-monitor-grace-period \u671f\u95f4\uff08\u9ed8\u8ba4 40 \u79d2\uff09\u6ca1\u6709\u6536\u5230\u8282\u70b9\u7684\u6d88\u606f DiskPressure True \u8868\u793a\u8282\u70b9\u5b58\u5728\u78c1\u76d8\u7a7a\u95f4\u538b\u529b\uff0c\u5373\u78c1\u76d8\u53ef\u7528\u91cf\u4f4e, \u5426\u5219\u4e3a False MemoryPressure True \u8868\u793a\u8282\u70b9\u5b58\u5728\u5185\u5b58\u538b\u529b\uff0c\u5373\u8282\u70b9\u5185\u5b58\u53ef\u7528\u91cf\u4f4e\uff0c\u5426\u5219\u4e3a False PIDPressure True \u8868\u793a\u8282\u70b9\u5b58\u5728\u8fdb\u7a0b\u538b\u529b\uff0c\u5373\u8282\u70b9\u4e0a\u8fdb\u7a0b\u8fc7\u591a\uff1b\u5426\u5219\u4e3a False NetworkUnavailable True \u8868\u793a\u8282\u70b9\u7f51\u7edc\u914d\u7f6e\u4e0d\u6b63\u786e\uff1b\u5426\u5219\u4e3a False \u8bf4\u660e\uff1a \u5982\u679c\u4f7f\u7528\u547d\u4ee4\u884c\u5de5\u5177\u6765\u6253\u5370\u5df2\u4fdd\u62a4\uff08Cordoned\uff09\u8282\u70b9\u7684\u7ec6\u8282\uff0c\u5176\u4e2d\u7684 Condition \u5b57\u6bb5\u53ef\u80fd\u5305\u62ec SchedulingDisabled \u3002 SchedulingDisabled \u4e0d\u662f Kubernetes API \u4e2d\u5b9a\u4e49\u7684 Condition\uff0c\u88ab\u4fdd\u62a4\u8d77\u6765\u7684\u8282\u70b9\u5728\u5176\u89c4\u7ea6\u4e2d\u88ab\u6807\u8bb0\u4e3a\u4e0d\u53ef\u8c03\u5ea6\uff08Unschedulable\uff09 \u5728 Kubernetes API \u4e2d\uff0c\u8282\u70b9\u7684\u72b6\u51b5\u8868\u793a\u8282\u70b9\u8d44\u6e90\u4e2d .status \u7684\u4e00\u90e8\u5206\u3002 \u4f8b\u5982\uff0c\u4ee5\u4e0b JSON \u7ed3\u6784\u63cf\u8ff0\u4e86\u4e00\u4e2a\u5065\u5eb7\u8282\u70b9\uff1a \"conditions\" : [ { \"type\" : \"Ready\" , \"status\" : \"True\" , \"reason\" : \"KubeletReady\" , \"message\" : \"kubelet is posting ready status\" , \"lastHeartbeatTime\" : \"2019-06-05T18:38:35Z\" , \"lastTransitionTime\" : \"2019-06-05T11:41:27Z\" } ] \u5982\u679c Ready \u72b6\u51b5\u7684 status \u5904\u4e8e Unknown \u6216\u8005 False \u72b6\u6001\u7684\u65f6\u95f4\u8d85\u8fc7\u4e86 pod-eviction-timeout \u503c\uff08\u4e00\u4e2a\u4f20\u9012\u7ed9 kube-controller-manager \u7684\u53c2\u6570\uff09\uff0c \u8282\u70b9\u63a7\u5236\u5668 \u4f1a\u5bf9\u8282\u70b9\u4e0a\u7684\u6240\u6709 Pod \u89e6\u53d1 API \u53d1\u8d77\u7684\u9a71\u9010\u3002\u9ed8\u8ba4\u7684\u9010\u51fa\u8d85\u65f6\u65f6\u957f\u4e3a 5 \u5206\u949f \u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u5f53\u8282\u70b9\u4e0d\u53ef\u8fbe\u65f6\uff0cAPI \u670d\u52a1\u5668\u4e0d\u80fd\u548c\u5176\u4e0a\u7684 kubelet \u901a\u4fe1\u3002\u5220\u9664 Pod \u7684\u51b3\u5b9a\u4e0d\u80fd\u4f20\u8fbe\u7ed9 kubelet\uff0c\u76f4\u5230\u5b83\u91cd\u65b0\u5efa\u7acb\u548c API \u670d\u52a1\u5668\u7684\u8fde\u63a5\u4e3a\u6b62\u3002 \u4e0e\u6b64\u540c\u65f6\uff0c\u88ab\u8ba1\u5212\u5220\u9664\u7684 Pod \u53ef\u80fd\u4f1a\u7ee7\u7eed\u5728\u6e38\u79bb\u7684\u8282\u70b9\u4e0a\u8fd0\u884c \u8282\u70b9\u63a7\u5236\u5668\u5728\u786e\u8ba4 Pod \u5728\u96c6\u7fa4\u4e2d\u5df2\u7ecf\u505c\u6b62\u8fd0\u884c\u524d\uff0c\u4e0d\u4f1a\u5f3a\u5236\u5220\u9664\u5b83\u4eec\u3002\u4f60\u53ef\u4ee5\u770b\u5230\u53ef\u80fd\u5728\u8fd9\u4e9b\u65e0\u6cd5\u8bbf\u95ee\u7684\u8282\u70b9\u4e0a\u8fd0\u884c\u7684 Pod \u5904\u4e8e Terminating \u6216\u8005 Unknown \u72b6\u6001\u3002\u5982\u679c kubernetes \u4e0d\u80fd\u57fa\u4e8e\u4e0b\u5c42\u57fa\u7840\u8bbe\u65bd\u63a8\u65ad\u51fa\u67d0\u8282\u70b9\u662f\u5426\u5df2\u7ecf\u6c38\u4e45\u79bb\u5f00\u4e86\u96c6\u7fa4\uff0c\u96c6\u7fa4\u7ba1\u7406\u5458\u53ef\u80fd\u9700\u8981\u624b\u52a8\u5220\u9664\u8be5\u8282\u70b9\u5bf9\u8c61\u3002\u4ece Kubernetes \u5220\u9664\u8282\u70b9\u5bf9\u8c61\u5c06\u5bfc\u81f4 API \u670d\u52a1\u5668\u5220\u9664\u8282\u70b9\u4e0a\u6240\u6709\u8fd0\u884c\u7684 Pod \u5bf9\u8c61\u5e76\u91ca\u653e\u5b83\u4eec\u7684\u540d\u5b57 \u5f53\u8282\u70b9\u4e0a\u51fa\u73b0\u95ee\u9898\u65f6\uff0cKubernetes \u63a7\u5236\u9762\u4f1a\u81ea\u52a8\u521b\u5efa\u4e0e\u5f71\u54cd\u8282\u70b9\u7684\u72b6\u51b5\u5bf9\u5e94\u7684 \u6c61\u70b9 \u3002\u8c03\u5ea6\u5668\u5728\u5c06 Pod \u6307\u6d3e\u5230\u67d0 Node \u65f6\u4f1a\u8003\u8651 Node \u4e0a\u7684\u6c61\u70b9\u8bbe\u7f6e\u3002Pod \u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u5bb9\u5fcd\u5ea6\uff0c\u4ee5\u4fbf\u80fd\u591f\u5728\u8bbe\u7f6e\u4e86\u7279\u5b9a\u6c61\u70b9\u7684 Node \u4e0a\u8fd0\u884c \u8fdb\u4e00\u6b65\u7684\u7ec6\u8282\u53ef\u53c2\u9605 \u6839\u636e\u72b6\u51b5\u4e3a\u8282\u70b9\u8bbe\u7f6e\u6c61\u70b9","title":"\u72b6\u51b5"},{"location":"Chapter02/chapter02-01/#capacity","text":"\u8fd9\u4e24\u4e2a\u503c\u63cf\u8ff0\u8282\u70b9\u4e0a\u7684\u53ef\u7528\u8d44\u6e90\uff1aCPU\u3001\u5185\u5b58\u548c\u53ef\u4ee5\u8c03\u5ea6\u5230\u8282\u70b9\u4e0a\u7684 Pod \u7684\u4e2a\u6570\u4e0a\u9650 capacity \u5757\u4e2d\u7684\u5b57\u6bb5\u6807\u793a\u8282\u70b9\u62e5\u6709\u7684\u8d44\u6e90\u603b\u91cf\u3002 allocatable \u5757\u6307\u793a\u8282\u70b9\u4e0a\u53ef\u4f9b\u666e\u901a Pod \u6d88\u8017\u7684\u8d44\u6e90\u91cf \u53ef\u4ee5\u5728\u5b66\u4e60\u5982\u4f55\u5728\u8282\u70b9\u4e0a \u9884\u7559\u8ba1\u7b97\u8d44\u6e90 \u7684\u65f6\u5019\u4e86\u89e3\u6709\u5173\u5bb9\u91cf\u548c\u53ef\u5206\u914d\u8d44\u6e90\u7684\u66f4\u591a\u4fe1\u606f","title":"\u5bb9\u91cf\uff08Capacity\uff09\u4e0e\u53ef\u5206\u914d\uff08Allocatable\uff09"},{"location":"Chapter02/chapter02-01/#info","text":"Info \u6307\u7684\u662f\u8282\u70b9\u7684\u4e00\u822c\u4fe1\u606f\uff0c\u5982\u5185\u6838\u7248\u672c\u3001Kubernetes \u7248\u672c\uff08 kubelet \u548c kube-proxy \u7248\u672c\uff09\u3001\u5bb9\u5668\u8fd0\u884c\u65f6\u8be6\u7ec6\u4fe1\u606f\uff0c\u4ee5\u53ca\u8282\u70b9\u4f7f\u7528\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002 kubelet \u4ece\u8282\u70b9\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u5e76\u5c06\u5176\u53d1\u5e03\u5230 Kubernetes API","title":"\u4fe1\u606f\uff08Info\uff09"},{"location":"Chapter02/chapter02-01/#heartbeats","text":"Kubernetes \u8282\u70b9\u53d1\u9001\u7684\u5fc3\u8df3\u5e2e\u52a9\u4f60\u7684\u96c6\u7fa4\u786e\u5b9a\u6bcf\u4e2a\u8282\u70b9\u7684\u53ef\u7528\u6027\uff0c\u5e76\u5728\u68c0\u6d4b\u5230\u6545\u969c\u65f6\u91c7\u53d6\u884c\u52a8 \u5bf9\u4e8e\u8282\u70b9\uff0c\u6709\u4e24\u79cd\u5f62\u5f0f\u7684\u5fc3\u8df3: \u66f4\u65b0\u8282\u70b9\u7684 .status kube-node-lease \u540d\u5b57\u7a7a\u95f4\u4e2d\u7684 Lease\uff08\u79df\u7ea6\uff09 \u5bf9\u8c61\u3002\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u4e00\u4e2a\u5173\u8054\u7684 Lease \u5bf9\u8c61 \u4e0e Node \u7684 .status \u66f4\u65b0\u76f8\u6bd4\uff0cLease \u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u8d44\u6e90\u3002\u4f7f\u7528 Lease \u6765\u8868\u8fbe\u5fc3\u8df3\u5728\u5927\u578b\u96c6\u7fa4\u4e2d\u53ef\u4ee5\u51cf\u5c11\u8fd9\u4e9b\u66f4\u65b0\u5bf9\u6027\u80fd\u7684\u5f71\u54cd kubelet \u8d1f\u8d23\u521b\u5efa\u548c\u66f4\u65b0\u8282\u70b9\u7684 .status \uff0c\u4ee5\u53ca\u66f4\u65b0\u5b83\u4eec\u5bf9\u5e94\u7684 Lease \u5f53\u8282\u70b9\u72b6\u6001\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u6216\u8005\u5728\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\u5185\u6ca1\u6709\u66f4\u65b0\u4e8b\u4ef6\u65f6\uff0ckubelet \u4f1a\u66f4\u65b0 .status \u3002 .status \u66f4\u65b0\u7684\u9ed8\u8ba4\u95f4\u9694\u4e3a 5 \u5206\u949f\uff08\u6bd4\u8282\u70b9\u4e0d\u53ef\u8fbe\u4e8b\u4ef6\u7684 40 \u79d2\u9ed8\u8ba4\u8d85\u65f6\u65f6\u95f4\u957f\u5f88\u591a\uff09 kubelet \u4f1a\u521b\u5efa\u5e76\u6bcf 10 \u79d2\uff08\u9ed8\u8ba4\u66f4\u65b0\u95f4\u9694\u65f6\u95f4\uff09\u66f4\u65b0 Lease \u5bf9\u8c61\u3002Lease \u7684\u66f4\u65b0\u72ec\u7acb\u4e8e Node \u7684 .status \u66f4\u65b0\u800c\u53d1\u751f\u3002\u5982\u679c Lease \u7684\u66f4\u65b0\u64cd\u4f5c\u5931\u8d25\uff0ckubelet \u4f1a\u91c7\u7528\u6307\u6570\u56de\u9000\u673a\u5236\uff0c\u4ece 200 \u6beb\u79d2\u5f00\u59cb\u91cd\u8bd5\uff0c\u6700\u957f\u91cd\u8bd5\u95f4\u9694\u4e3a 7 \u79d2\u949f","title":"\u5fc3\u8df3"},{"location":"Chapter02/chapter02-01/#node-controller","text":"\u8282\u70b9\u63a7\u5236\u5668\u662f Kubernetes \u63a7\u5236\u9762\u7ec4\u4ef6\uff0c\u7ba1\u7406\u8282\u70b9\u7684\u65b9\u65b9\u9762\u9762 \u8282\u70b9\u63a7\u5236\u5668\u5728\u8282\u70b9\u7684\u751f\u547d\u5468\u671f\u4e2d\u626e\u6f14\u591a\u4e2a\u89d2\u8272\u3002\u7b2c\u4e00\u4e2a\u662f\u5f53\u8282\u70b9\u6ce8\u518c\u65f6\u4e3a\u5b83\u5206\u914d\u4e00\u4e2a CIDR \u533a\u6bb5\uff08\u5982\u679c\u542f\u7528\u4e86 CIDR \u5206\u914d\uff09 \u7b2c\u4e8c\u4e2a\u662f\u4fdd\u6301\u8282\u70b9\u63a7\u5236\u5668\u5185\u7684\u8282\u70b9\u5217\u8868\u4e0e\u4e91\u670d\u52a1\u5546\u6240\u63d0\u4f9b\u7684\u53ef\u7528\u673a\u5668\u5217\u8868\u540c\u6b65\u3002\u5982\u679c\u5728\u4e91\u73af\u5883\u4e0b\u8fd0\u884c\uff0c\u53ea\u8981\u67d0\u8282\u70b9\u4e0d\u5065\u5eb7\uff0c\u8282\u70b9\u63a7\u5236\u5668\u5c31\u4f1a\u8be2\u95ee\u4e91\u670d\u52a1\u662f\u5426\u8282\u70b9\u7684\u865a\u62df\u673a\u4ecd\u53ef\u7528\u3002\u5982\u679c\u4e0d\u53ef\u7528\uff0c\u8282\u70b9\u63a7\u5236\u5668\u4f1a\u5c06\u8be5\u8282\u70b9\u4ece\u5b83\u7684\u8282\u70b9\u5217\u8868\u5220\u9664 \u7b2c\u4e09\u4e2a\u662f\u76d1\u63a7\u8282\u70b9\u7684\u5065\u5eb7\u72b6\u51b5\u3002\u8282\u70b9\u63a7\u5236\u5668\u8d1f\u8d23\uff1a \u5728\u8282\u70b9\u4e0d\u53ef\u8fbe\u7684\u60c5\u51b5\u4e0b\uff0c\u5728 Node \u7684 .status \u4e2d\u66f4\u65b0 Ready \u72b6\u51b5\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u63a7\u5236\u5668\u5c06 NodeReady \u72b6\u51b5\u66f4\u65b0\u4e3a Unknown \u5982\u679c\u8282\u70b9\u4ecd\u7136\u65e0\u6cd5\u8bbf\u95ee\uff1a\u5bf9\u4e8e\u4e0d\u53ef\u8fbe\u8282\u70b9\u4e0a\u7684\u6240\u6709 Pod \u89e6\u53d1 API \u53d1\u8d77\u7684\u9010\u51fa \u64cd\u4f5c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u63a7\u5236\u5668\u5728\u5c06\u8282\u70b9\u6807\u8bb0\u4e3a Unknown \u540e\u7b49\u5f85 5 \u5206\u949f\u63d0\u4ea4\u7b2c\u4e00\u4e2a\u9a71\u9010\u8bf7\u6c42 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u63a7\u5236\u5668\u6bcf 5 \u79d2\u68c0\u67e5\u4e00\u6b21\u8282\u70b9\u72b6\u6001\uff0c\u53ef\u4ee5\u4f7f\u7528 kube-controller-manager \u7ec4\u4ef6\u4e0a\u7684 --node-monitor-period \u53c2\u6570\u6765\u914d\u7f6e\u5468\u671f","title":"\u8282\u70b9\u63a7\u5236\u5668"},{"location":"Chapter02/chapter02-01/#rate-limits-on-eviction","text":"\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u63a7\u5236\u5668\u628a\u9010\u51fa\u901f\u7387\u9650\u5236\u5728\u6bcf\u79d2 --node-eviction-rate \u4e2a\uff08\u9ed8\u8ba4\u4e3a 0.1\uff09\u3002\u8fd9\u8868\u793a\u5b83\u6bcf 10 \u79d2\u949f\u5185\u81f3\u591a\u4ece\u4e00\u4e2a\u8282\u70b9\u9a71\u9010 Pod \u5f53\u4e00\u4e2a\u53ef\u7528\u533a\u57df\uff08Availability Zone\uff09\u4e2d\u7684\u8282\u70b9\u53d8\u4e3a\u4e0d\u5065\u5eb7\u65f6\uff0c\u8282\u70b9\u7684\u9a71\u9010\u884c\u4e3a\u5c06\u53d1\u751f\u6539\u53d8\u3002\u8282\u70b9\u63a7\u5236\u5668\u4f1a\u540c\u65f6\u68c0\u67e5\u53ef\u7528\u533a\u57df\u4e2d\u4e0d\u5065\u5eb7\uff08 Ready \u72b6\u51b5\u4e3a Unknown \u6216 False )\u7684\u8282\u70b9\u7684\u767e\u5206\u6bd4\uff1a \u5982\u679c\u4e0d\u5065\u5eb7\u8282\u70b9\u7684\u6bd4\u4f8b\u8d85\u8fc7 --unhealthy-zone-threshold \uff08\u9ed8\u8ba4\u4e3a 0.55\uff09\uff0c\u9a71\u9010\u901f\u7387\u5c06\u4f1a\u964d\u4f4e \u5982\u679c\u96c6\u7fa4\u8f83\u5c0f\uff08\u610f\u5373\u5c0f\u4e8e\u7b49\u4e8e --large-cluster-size-threshold \u4e2a\u8282\u70b9 - \u9ed8\u8ba4\u4e3a 50\uff09\uff0c\u9a71\u9010\u64cd\u4f5c\u5c06\u4f1a\u505c\u6b62 \u5426\u5219\u9a71\u9010\u901f\u7387\u5c06\u964d\u4e3a\u6bcf\u79d2 --secondary-node-eviction-rate \u4e2a\uff08\u9ed8\u8ba4\u4e3a 0.01\uff09 \u5728\u9010\u4e2a\u53ef\u7528\u533a\u57df\u4e2d\u5b9e\u65bd\u8fd9\u4e9b\u7b56\u7565\u7684\u539f\u56e0\u662f\uff0c\u5f53\u4e00\u4e2a\u53ef\u7528\u533a\u57df\u53ef\u80fd\u4ece\u63a7\u5236\u9762\u8131\u79bb\u65f6\u5176\u5b83\u53ef\u7528\u533a\u57df\u53ef\u80fd\u4ecd\u7136\u4fdd\u6301\u8fde\u63a5\u3002\u5982\u679c\u4f60\u7684\u96c6\u7fa4\u6ca1\u6709\u8de8\u8d8a\u4e91\u670d\u52a1\u5546\u7684\u591a\u4e2a\u53ef\u7528\u533a\u57df\uff0c\u90a3\uff08\u6574\u4e2a\u96c6\u7fa4\uff09\u5c31\u53ea\u6709\u4e00\u4e2a\u53ef\u7528\u533a\u57df \u8de8\u591a\u4e2a\u53ef\u7528\u533a\u57df\u90e8\u7f72\u4f60\u7684\u8282\u70b9\u7684\u4e00\u4e2a\u5173\u952e\u539f\u56e0\u662f\u5f53\u67d0\u4e2a\u53ef\u7528\u533a\u57df\u6574\u4f53\u51fa\u73b0\u6545\u969c\u65f6\uff0c\u5de5\u4f5c\u8d1f\u8f7d\u53ef\u4ee5\u8f6c\u79fb\u5230\u5065\u5eb7\u7684\u53ef\u7528\u533a\u57df\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4e00\u4e2a\u53ef\u7528\u533a\u57df\u4e2d\u7684\u6240\u6709\u8282\u70b9\u90fd\u4e0d\u5065\u5eb7\u65f6\uff0c\u8282\u70b9\u63a7\u5236\u5668\u4f1a\u4ee5\u6b63\u5e38\u7684\u901f\u7387 --node-eviction-rate \u8fdb\u884c\u9a71\u9010\u64cd\u4f5c\u3002\u5728\u6240\u6709\u7684\u53ef\u7528\u533a\u57df\u90fd\u4e0d\u5065\u5eb7\uff08\u4e5f\u5373\u96c6\u7fa4\u4e2d\u6ca1\u6709\u5065\u5eb7\u8282\u70b9\uff09\u7684\u6781\u7aef\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u63a7\u5236\u5668\u5c06\u5047\u8bbe\u63a7\u5236\u9762\u4e0e\u8282\u70b9\u95f4\u7684\u8fde\u63a5\u51fa\u4e86\u67d0\u4e9b\u95ee\u9898\uff0c\u5b83\u5c06\u505c\u6b62\u6240\u6709\u9a71\u9010\u52a8\u4f5c\uff08\u5982\u679c\u6545\u969c\u540e\u90e8\u5206\u8282\u70b9\u91cd\u65b0\u8fde\u63a5\uff0c\u8282\u70b9\u63a7\u5236\u5668\u4f1a\u4ece\u5269\u4e0b\u4e0d\u5065\u5eb7\u6216\u8005\u4e0d\u53ef\u8fbe\u8282\u70b9\u4e2d\u9a71\u9010 Pod\uff09 \u8282\u70b9\u63a7\u5236\u5668\u8fd8\u8d1f\u8d23\u9a71\u9010\u8fd0\u884c\u5728\u62e5\u6709 NoExecute \u6c61\u70b9\u7684\u8282\u70b9\u4e0a\u7684 Pod\uff0c\u9664\u975e\u8fd9\u4e9b Pod \u80fd\u591f\u5bb9\u5fcd\u6b64\u6c61\u70b9\u3002\u8282\u70b9\u63a7\u5236\u5668\u8fd8\u8d1f\u8d23\u6839\u636e\u8282\u70b9\u6545\u969c\uff08\u4f8b\u5982\u8282\u70b9\u4e0d\u53ef\u8bbf\u95ee\u6216\u6ca1\u6709\u5c31\u7eea\uff09\u4e3a\u5176\u6dfb\u52a0\u6c61\u70b9\u3002\u8fd9\u610f\u5473\u7740\u8c03\u5ea6\u5668\u4e0d\u4f1a\u5c06 Pod \u8c03\u5ea6\u5230\u4e0d\u5065\u5eb7\u7684\u8282\u70b9\u4e0a","title":"\u9010\u51fa\u901f\u7387\u9650\u5236"},{"location":"Chapter02/chapter02-01/#node-capacity","text":"Node \u5bf9\u8c61\u4f1a\u8ddf\u8e2a\u8282\u70b9\u4e0a\u8d44\u6e90\u7684\u5bb9\u91cf\uff08\u4f8b\u5982\u53ef\u7528\u5185\u5b58\u548c CPU \u6570\u91cf\uff09\u3002\u901a\u8fc7 \u81ea\u6ce8\u518c \u673a\u5236\u751f\u6210\u7684 Node \u5bf9\u8c61\u4f1a\u5728\u6ce8\u518c\u671f\u95f4\u62a5\u544a\u81ea\u8eab\u5bb9\u91cf\u3002\u5982\u679c\u4f60 \u624b\u52a8 \u6dfb\u52a0\u4e86 Node\uff0c\u4f60\u5c31\u9700\u8981\u5728\u6dfb\u52a0\u8282\u70b9\u65f6\u624b\u52a8\u8bbe\u7f6e\u8282\u70b9\u5bb9\u91cf\u3002 Kubernetes \u8c03\u5ea6\u5668\u4fdd\u8bc1\u8282\u70b9\u4e0a\u6709\u8db3\u591f\u7684\u8d44\u6e90\u4f9b\u5176\u4e0a\u7684\u6240\u6709 Pod \u4f7f\u7528\u3002\u5b83\u4f1a\u68c0\u67e5\u8282\u70b9\u4e0a\u6240\u6709\u5bb9\u5668\u7684\u8bf7\u6c42\u7684\u603b\u548c\u4e0d\u4f1a\u8d85\u8fc7\u8282\u70b9\u7684\u5bb9\u91cf\u3002\u603b\u7684\u8bf7\u6c42\u5305\u62ec\u7531 kubelet \u542f\u52a8\u7684\u6240\u6709\u5bb9\u5668\uff0c\u4f46\u4e0d\u5305\u62ec\u7531\u5bb9\u5668\u8fd0\u884c\u65f6\u76f4\u63a5\u542f\u52a8\u7684\u5bb9\u5668\uff0c\u4e5f\u4e0d\u5305\u62ec\u4e0d\u53d7 kubelet \u63a7\u5236\u7684\u5176\u4ed6\u8fdb\u7a0b \u8bf4\u660e\uff1a \u5982\u679c\u8981\u4e3a\u975e Pod \u8fdb\u7a0b\u663e\u5f0f\u4fdd\u7559\u8d44\u6e90\u3002 \u8bf7\u53c2\u8003 \u4e3a\u7cfb\u7edf\u5b88\u62a4\u8fdb\u7a0b\u9884\u7559\u8d44\u6e90","title":"\u8d44\u6e90\u5bb9\u91cf\u8ddf\u8e2a"},{"location":"Chapter02/chapter02-01/#node-topology","text":"\u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.18 [beta] \u5982\u679c\u542f\u7528\u4e86 TopologyManager \u7279\u6027\u95e8\u63a7 \uff0c kubelet \u53ef\u4ee5\u5728\u4f5c\u51fa\u8d44\u6e90\u5206\u914d\u51b3\u7b56\u65f6\u4f7f\u7528\u62d3\u6251\u63d0\u793a\u3002\u53c2\u8003 \u63a7\u5236\u8282\u70b9\u4e0a\u62d3\u6251\u7ba1\u7406\u7b56\u7565 \u4e86\u89e3\u8be6\u7ec6\u4fe1\u606f","title":"\u8282\u70b9\u62d3\u6251"},{"location":"Chapter02/chapter02-01/#graceful-node-shutdown","text":"\u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.21 [beta] kubelet \u4f1a\u5c1d\u8bd5\u68c0\u6d4b\u8282\u70b9\u7cfb\u7edf\u5173\u95ed\u4e8b\u4ef6\u5e76\u7ec8\u6b62\u5728\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u6240\u6709 Pod \u5728\u8282\u70b9\u7ec8\u6b62\u671f\u95f4\uff0ckubelet \u4fdd\u8bc1 Pod \u9075\u4ece\u5e38\u89c4\u7684 Pod \u7ec8\u6b62\u6d41\u7a0b \u8282\u70b9\u4f53\u9762\u5173\u95ed\u7279\u6027\u4f9d\u8d56\u4e8e systemd\uff0c\u56e0\u4e3a\u5b83\u8981\u5229\u7528 systemd \u6291\u5236\u5668\u9501 \u673a\u5236\uff0c\u5728\u7ed9\u5b9a\u7684\u671f\u9650\u5185\u5ef6\u8fdf\u8282\u70b9\u5173\u95ed \u8282\u70b9\u4f53\u9762\u5173\u95ed\u7279\u6027\u53d7 GracefulNodeShutdown \u7279\u6027\u95e8\u63a7 \u63a7\u5236\uff0c\u5728 1.21 \u7248\u672c\u4e2d\u662f\u9ed8\u8ba4\u542f\u7528\u7684 \u6ce8\u610f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e0b\u9762\u63cf\u8ff0\u7684\u4e24\u4e2a\u914d\u7f6e\u9009\u9879\uff0c shutdownGracePeriod \u548c shutdownGracePeriodCriticalPods \u90fd\u662f\u88ab\u8bbe\u7f6e\u4e3a 0 \u7684\uff0c\u56e0\u6b64\u4e0d\u4f1a\u6fc0\u6d3b\u8282\u70b9\u4f53\u9762\u5173\u95ed\u529f\u80fd\u3002\u8981\u6fc0\u6d3b\u6b64\u529f\u80fd\u7279\u6027\uff0c\u8fd9\u4e24\u4e2a kubelet \u914d\u7f6e\u9009\u9879\u8981\u9002\u5f53\u914d\u7f6e\uff0c\u5e76\u8bbe\u7f6e\u4e3a\u975e\u96f6\u503c \u5728\u4f53\u9762\u5173\u95ed\u8282\u70b9\u8fc7\u7a0b\u4e2d\uff0ckubelet \u5206\u4e24\u4e2a\u9636\u6bb5\u6765\u7ec8\u6b62 Pod\uff1a \u7ec8\u6b62\u5728\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u5e38\u89c4 Pod \u7ec8\u6b62\u5728\u8282\u70b9\u4e0a\u8fd0\u884c\u7684 \u5173\u952e Pod \u8282\u70b9\u4f53\u9762\u5173\u95ed\u7684\u7279\u6027\u5bf9\u5e94\u4e24\u4e2a KubeletConfiguration \u9009\u9879\uff1a shutdownGracePeriod \uff1a \u6307\u5b9a\u8282\u70b9\u5e94\u5ef6\u8fdf\u5173\u95ed\u7684\u603b\u6301\u7eed\u65f6\u95f4\u3002\u6b64\u65f6\u95f4\u662f Pod \u4f53\u9762\u7ec8\u6b62\u7684\u65f6\u95f4\u603b\u548c\uff0c\u4e0d\u533a\u5206\u5e38\u89c4 Pod \u8fd8\u662f \u5173\u952e Pod shutdownGracePeriodCriticalPods \uff1a \u5728\u8282\u70b9\u5173\u95ed\u671f\u95f4\u6307\u5b9a\u7528\u4e8e\u7ec8\u6b62 \u5173\u952e Pod \u7684\u6301\u7eed\u65f6\u95f4\u3002\u8be5\u503c\u5e94\u5c0f\u4e8e shutdownGracePeriod \u4f8b\u5982\uff0c\u5982\u679c\u8bbe\u7f6e\u4e86 shutdownGracePeriod=30s \u548c shutdownGracePeriodCriticalPods=10s \uff0c\u5219 kubelet \u5c06\u5ef6\u8fdf 30 \u79d2\u5173\u95ed\u8282\u70b9\u3002\u5728\u5173\u95ed\u671f\u95f4\uff0c\u5c06\u4fdd\u7559\u524d 20\uff0830 - 10\uff09\u79d2\u7528\u4e8e\u4f53\u9762\u7ec8\u6b62\u5e38\u89c4 Pod\uff0c\u800c\u4fdd\u7559\u6700\u540e 10 \u79d2\u7528\u4e8e\u7ec8\u6b62 \u5173\u952e Pod \u8bf4\u660e\uff1a \u5f53 Pod \u5728\u6b63\u5e38\u8282\u70b9\u5173\u95ed\u671f\u95f4\u88ab\u9a71\u9010\u65f6\uff0c\u5b83\u4eec\u4f1a\u88ab\u6807\u8bb0\u4e3a\u5173\u95ed\u3002\u8fd0\u884c kubectl get pods \u65f6\uff0c\u88ab\u9a71\u9010\u7684 Pod \u7684\u72b6\u6001\u663e\u793a\u4e3a Terminated \u3002\u5e76\u4e14 kubectl describe pod \u8868\u793a Pod \u56e0\u8282\u70b9\u5173\u95ed\u800c\u88ab\u9a71\u9010\uff1a Reason: Terminated Message: Pod was terminated in response to imminent node shutdown.","title":"\u8282\u70b9\u4f53\u9762\u5173\u95ed"},{"location":"Chapter02/chapter02-01/#non-graceful-node-shutdown","text":"\u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.24 [alpha] \u8282\u70b9\u5173\u95ed\u7684\u64cd\u4f5c\u53ef\u80fd\u65e0\u6cd5\u88ab kubelet \u7684\u8282\u70b9\u5173\u95ed\u7ba1\u7406\u5668\u68c0\u6d4b\u5230\uff0c\u662f\u56e0\u4e3a\u8be5\u547d\u4ee4\u4e0d\u4f1a\u89e6\u53d1 kubelet \u6240\u4f7f\u7528\u7684\u6291\u5236\u9501\u5b9a\u673a\u5236\uff0c\u6216\u8005\u662f\u56e0\u4e3a\u7528\u6237\u9519\u8bef\u7684\u539f\u56e0\uff0c\u5373 ShutdownGracePeriod \u548c ShutdownGracePeriodCriticalPod \u914d\u7f6e\u4e0d\u6b63\u786e\u3002\u8bf7\u53c2\u8003\u4ee5\u4e0a \u8282\u70b9\u4f53\u9762\u5173\u95ed \u90e8\u5206\u4e86\u89e3\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f \u5f53\u67d0\u8282\u70b9\u5173\u95ed\u4f46 kubelet \u7684\u8282\u70b9\u5173\u95ed\u7ba1\u7406\u5668\u672a\u68c0\u6d4b\u5230\u8fd9\u4e00\u4e8b\u4ef6\u65f6\uff0c \u5728\u90a3\u4e2a\u5df2\u5173\u95ed\u8282\u70b9\u4e0a\u3001\u5c5e\u4e8e StatefulSet \u7684 Pod \u5c06\u505c\u6ede\u4e8e\u7ec8\u6b62\u72b6\u6001\uff0c\u5e76\u4e14\u4e0d\u80fd\u79fb\u52a8\u5230\u65b0\u7684\u8fd0\u884c\u8282\u70b9\u4e0a\u3002 \u8fd9\u662f\u56e0\u4e3a\u5df2\u5173\u95ed\u8282\u70b9\u4e0a\u7684 kubelet \u5df2\u4e0d\u5b58\u5728\uff0c\u4ea6\u65e0\u6cd5\u5220\u9664 Pod\uff0c \u56e0\u6b64 StatefulSet \u65e0\u6cd5\u521b\u5efa\u540c\u540d\u7684\u65b0 Pod\u3002 \u5982\u679c Pod \u4f7f\u7528\u4e86\u5377\uff0c\u5219 VolumeAttachments \u4e0d\u4f1a\u4ece\u539f\u6765\u7684\u5df2\u5173\u95ed\u8282\u70b9\u4e0a\u5220\u9664\uff0c \u56e0\u6b64\u8fd9\u4e9b Pod \u6240\u4f7f\u7528\u7684\u5377\u4e5f\u65e0\u6cd5\u6302\u63a5\u5230\u65b0\u7684\u8fd0\u884c\u8282\u70b9\u4e0a\u3002 \u6240\u4ee5\uff0c\u90a3\u4e9b\u4ee5 StatefulSet \u5f62\u5f0f\u8fd0\u884c\u7684\u5e94\u7528\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002 \u5982\u679c\u539f\u6765\u7684\u5df2\u5173\u95ed\u8282\u70b9\u88ab\u6062\u590d\uff0ckubelet \u5c06\u5220\u9664 Pod\uff0c\u65b0\u7684 Pod \u5c06\u88ab\u5728\u4e0d\u540c\u7684\u8fd0\u884c\u8282\u70b9\u4e0a\u521b\u5efa\u3002 \u5982\u679c\u539f\u6765\u7684\u5df2\u5173\u95ed\u8282\u70b9\u6ca1\u6709\u88ab\u6062\u590d\uff0c\u90a3\u4e9b\u5728\u5df2\u5173\u95ed\u8282\u70b9\u4e0a\u7684 Pod \u5c06\u6c38\u8fdc\u6ede\u7559\u5728\u7ec8\u6b62\u72b6\u6001 \u4e3a\u4e86\u7f13\u89e3\u4e0a\u8ff0\u60c5\u51b5\uff0c\u7528\u6237\u53ef\u4ee5\u624b\u52a8\u5c06\u5177\u6709 NoExecute \u6216 NoSchedule \u6548\u679c\u7684 node.kubernetes.io/out-of-service \u6c61\u70b9\u6dfb\u52a0\u5230\u8282\u70b9\u4e0a\uff0c\u6807\u8bb0\u5176\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\u3002\u5982\u679c\u5728 kube-controller-manager \u4e0a\u542f\u7528\u4e86 NodeOutOfServiceVolumeDetach \u7279\u6027\u95e8\u63a7 \uff0c\u5e76\u4e14\u8282\u70b9\u88ab\u901a\u8fc7\u6c61\u70b9\u6807\u8bb0\u4e3a\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\uff0c\u5982\u679c\u8282\u70b9 Pod \u4e0a\u6ca1\u6709\u8bbe\u7f6e\u5bf9\u5e94\u7684\u5bb9\u5fcd\u5ea6\uff0c\u90a3\u4e48\u8fd9\u6837\u7684 Pod \u5c06\u88ab\u5f3a\u5236\u5220\u9664\uff0c\u5e76\u4e14\u8be5\u5728\u8282\u70b9\u4e0a\u88ab\u7ec8\u6b62\u7684 Pod \u5c06\u7acb\u5373\u8fdb\u884c\u5377\u5206\u79bb\u64cd\u4f5c\u3002\u8fd9\u6837\u5c31\u5141\u8bb8\u90a3\u4e9b\u5728\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\u8282\u70b9\u4e0a\u7684 Pod \u80fd\u5728\u5176\u4ed6\u8282\u70b9\u4e0a\u5feb\u901f\u6062\u590d \u5728\u975e\u4f53\u9762\u5173\u95ed\u671f\u95f4\uff0cPod \u5206\u4e24\u4e2a\u9636\u6bb5\u7ec8\u6b62\uff1a \u5f3a\u5236\u5220\u9664\u6ca1\u6709\u5339\u914d\u7684 out-of-service \u5bb9\u5fcd\u5ea6\u7684 Pod \u7acb\u5373\u5bf9\u6b64\u7c7b Pod \u6267\u884c\u5206\u79bb\u5377\u64cd\u4f5c \u8bf4\u660e\uff1a \u5728\u6dfb\u52a0 node.kubernetes.io/out-of-service \u6c61\u70b9\u4e4b\u524d\uff0c\u5e94\u8be5\u9a8c\u8bc1\u8282\u70b9\u5df2\u7ecf\u5904\u4e8e\u5173\u95ed\u6216\u65ad\u7535\u72b6\u6001\uff08\u800c\u4e0d\u662f\u5728\u91cd\u65b0\u542f\u52a8\u4e2d\uff09 \u5c06 Pod \u79fb\u52a8\u5230\u65b0\u8282\u70b9\u540e\uff0c\u7528\u6237\u9700\u8981\u624b\u52a8\u79fb\u9664\u505c\u6b62\u670d\u52a1\u7684\u6c61\u70b9\uff0c\u5e76\u4e14\u7528\u6237\u8981\u68c0\u67e5\u5173\u95ed\u8282\u70b9\u662f\u5426\u5df2\u6062\u590d\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6700\u521d\u6dfb\u52a0\u6c61\u70b9\u7684\u7528\u6237","title":"\u8282\u70b9\u975e\u4f53\u9762\u5173\u95ed"},{"location":"Chapter02/chapter02-01/#pod-priority-graceful-node-shutdown","text":"\u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.23 [alpha] \u4e3a\u4e86\u5728\u8282\u70b9\u4f53\u9762\u5173\u95ed\u671f\u95f4\u63d0\u4f9b\u66f4\u591a\u7684\u7075\u6d3b\u6027\uff0c\u5c24\u5176\u662f\u5904\u7406\u5173\u95ed\u671f\u95f4\u7684 Pod \u6392\u5e8f\u95ee\u9898\uff0c\u8282\u70b9\u4f53\u9762\u5173\u95ed\u673a\u5236\u80fd\u591f\u5173\u6ce8 Pod \u7684 PriorityClass \u8bbe\u7f6e\uff0c\u524d\u63d0\u662f\u4f60\u5df2\u7ecf\u5728\u96c6\u7fa4\u4e2d\u542f\u7528\u4e86\u6b64\u529f\u80fd\u7279\u6027\u3002\u6b64\u529f\u80fd\u7279\u6027\u5141\u8bb8\u96c6\u7fa4\u7ba1\u7406\u5458\u57fa\u4e8e Pod \u7684 \u4f18\u5148\u7ea7\u7c7b\uff08Priority Class\uff09 \u663e\u5f0f\u5730\u5b9a\u4e49\u8282\u70b9\u4f53\u9762\u5173\u95ed\u671f\u95f4 Pod \u7684\u5904\u7406\u987a\u5e8f \u524d\u6587\u6240\u8ff0\u7684 \u8282\u70b9\u4f53\u9762\u5173\u95ed \u7279\u6027\u80fd\u591f\u5206\u4e24\u4e2a\u9636\u6bb5\u5173\u95ed Pod\uff0c\u9996\u5148\u5173\u95ed\u7684\u662f\u975e\u5173\u952e\u7684 Pod\uff0c\u4e4b\u540e\u518d\u5904\u7406\u5173\u952e Pod\u3002\u5982\u679c\u9700\u8981\u663e\u5f0f\u5730\u4ee5\u66f4\u7ec6\u7c92\u5ea6\u5b9a\u4e49\u5173\u95ed\u671f\u95f4 Pod \u7684\u5904\u7406\u987a\u5e8f\uff0c\u9700\u8981\u4e00\u5b9a\u7684\u7075\u6d3b\u5ea6\uff0c\u8fd9\u65f6\u53ef\u4ee5\u4f7f\u7528\u57fa\u4e8e Pod \u4f18\u5148\u7ea7\u7684\u4f53\u9762\u5173\u95ed\u673a\u5236 \u5f53\u8282\u70b9\u4f53\u9762\u5173\u95ed\u80fd\u591f\u5904\u7406 Pod \u4f18\u5148\u7ea7\u65f6\uff0c\u8282\u70b9\u4f53\u9762\u5173\u95ed\u7684\u5904\u7406\u53ef\u4ee5\u5206\u4e3a\u591a\u4e2a\u9636\u6bb5\uff0c \u6bcf\u4e2a\u9636\u6bb5\u5173\u95ed\u7279\u5b9a\u4f18\u5148\u7ea7\u7c7b\u7684 Pod\u3002kubelet \u53ef\u4ee5\u88ab\u914d\u7f6e\u4e3a\u6309\u786e\u5207\u7684\u9636\u6bb5\u5904\u7406 Pod\uff0c \u4e14\u6bcf\u4e2a\u9636\u6bb5\u53ef\u4ee5\u72ec\u7acb\u8bbe\u7f6e\u5173\u95ed\u65f6\u95f4 \u5047\u8bbe\u96c6\u7fa4\u4e2d\u5b58\u5728\u4ee5\u4e0b\u81ea\u5b9a\u4e49\u7684 Pod \u4f18\u5148\u7ea7\u7c7b Pod \u4f18\u5148\u7ea7\u7c7b\u540d\u79f0 Pod \u4f18\u5148\u7ea7\u7c7b\u6570\u503c custom-class-a 100000 custom-class-b 10000 custom-class-c 1000 regular/unset 0 \u5728 kubelet \u914d\u7f6e \u4e2d\uff0c shutdownGracePeriodByPodPriority \u53ef\u80fd\u770b\u8d77\u6765\u662f\u8fd9\u6837\uff1a Pod \u4f18\u5148\u7ea7\u7c7b\u6570\u503c \u5173\u95ed\u671f\u9650 100000 10 \u79d2 10000 180 \u79d2 1000 120 \u79d2 0 60 \u79d2 \u5bf9\u5e94\u7684 kubelet \u914d\u7f6e YAML \u5c06\u4f1a\u662f\uff1a shutdownGracePeriodByPodPriority : - priority : 100000 shutdownGracePeriodSeconds : 10 - priority : 10000 shutdownGracePeriodSeconds : 180 - priority : 1000 shutdownGracePeriodSeconds : 120 - priority : 0 shutdownGracePeriodSeconds : 60 \u4e0a\u9762\u7684\u8868\u683c\u8868\u660e\uff0c\u6240\u6709 priority \u503c\u5927\u4e8e\u7b49\u4e8e 100000 \u7684 Pod \u4f1a\u5f97\u5230 10 \u79d2\u949f\u671f\u9650\u505c\u6b62\uff0c\u6240\u6709 priority \u503c\u4ecb\u4e8e 10000 \u548c 100000 \u4e4b\u95f4\u7684 Pod \u4f1a\u5f97\u5230 180 \u79d2\u949f\u671f\u9650\u505c\u6b62\uff0c\u6240\u6709 priority \u503c\u4ecb\u4e8e 1000 \u548c 10000 \u4e4b\u95f4\u7684 Pod \u4f1a\u5f97\u5230 120 \u79d2\u949f\u671f\u9650\u505c\u6b62\uff0c\u6240\u6709\u5176\u4ed6 Pod \u5c06\u83b7\u5f97 60 \u79d2\u7684\u65f6\u95f4\u505c\u6b62 \u7528\u6237\u4e0d\u9700\u8981\u4e3a\u6240\u6709\u7684\u4f18\u5148\u7ea7\u7c7b\u90fd\u8bbe\u7f6e\u6570\u503c\u3002\u4f8b\u5982\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u8fd9\u79cd\u914d\u7f6e\uff1a Pod \u4f18\u5148\u7ea7\u7c7b\u6570\u503c \u5173\u95ed\u671f\u9650 100000 300 \u79d2 1000 120 \u79d2 0 60 \u79d2 \u5728\u4e0a\u9762\u8fd9\u4e2a\u573a\u666f\u4e2d\uff0c\u4f18\u5148\u7ea7\u7c7b\u4e3a custom-class-b \u7684 Pod \u4f1a\u4e0e\u4f18\u5148\u7ea7\u7c7b\u4e3a custom-class-c \u7684 Pod \u5728\u5173\u95ed\u65f6\u6309\u76f8\u540c\u671f\u9650\u5904\u7406 \u5982\u679c\u5728\u7279\u5b9a\u7684\u8303\u56f4\u5185\u4e0d\u5b58\u5728 Pod\uff0c\u5219 kubelet \u4e0d\u4f1a\u7b49\u5f85\u5bf9\u5e94\u4f18\u5148\u7ea7\u8303\u56f4\u7684 Pod\u3002kubelet \u4f1a\u76f4\u63a5\u8df3\u5230\u4e0b\u4e00\u4e2a\u4f18\u5148\u7ea7\u6570\u503c\u8303\u56f4\u8fdb\u884c\u5904\u7406 \u5982\u679c\u6b64\u529f\u80fd\u7279\u6027\u88ab\u542f\u7528\uff0c\u4f46\u6ca1\u6709\u63d0\u4f9b\u914d\u7f6e\u6570\u636e\uff0c\u5219\u4e0d\u4f1a\u51fa\u73b0\u6392\u5e8f\u64cd\u4f5c \u4f7f\u7528\u6b64\u529f\u80fd\u7279\u6027\u9700\u8981\u542f\u7528 GracefulNodeShutdownBasedOnPodPriority \u7279\u6027\u95e8\u63a7 \uff0c\u5e76\u5c06 kubelet \u914d\u7f6e \u4e2d\u7684 shutdownGracePeriodByPodPriority \u8bbe\u7f6e\u4e3a\u671f\u671b\u7684\u914d\u7f6e\uff0c\u5176\u4e2d\u5305\u542b Pod \u7684\u4f18\u5148\u7ea7\u7c7b\u6570\u503c\u4ee5\u53ca\u5bf9\u5e94\u7684\u5173\u95ed\u671f\u9650 \u8bf4\u660e\uff1a \u5728\u8282\u70b9\u4f53\u9762\u5173\u95ed\u671f\u95f4\u8003\u8651 Pod \u4f18\u5148\u7ea7\u7684\u80fd\u529b\u662f\u4f5c\u4e3a Kubernetes v1.23 \u4e2d\u7684 Alpha \u529f\u80fd\u5f15\u5165\u7684\u3002 \u5728 Kubernetes 1.25 \u4e2d\u8be5\u529f\u80fd\u662f Beta \u7248\uff0c\u9ed8\u8ba4\u542f\u7528 kubelet \u5b50\u7cfb\u7edf\u4e2d\u4f1a\u751f\u6210 graceful_shutdown_start_time_seconds \u548c graceful_shutdown_end_time_seconds \u5ea6\u91cf\u6307\u6807\u4ee5\u4fbf\u76d1\u89c6\u8282\u70b9\u5173\u95ed\u884c\u4e3a","title":"\u57fa\u4e8e Pod \u4f18\u5148\u7ea7\u7684\u8282\u70b9\u4f53\u9762\u5173\u95ed"},{"location":"Chapter02/chapter02-01/#swap-memory","text":"\u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.22 [alpha] \u5728 Kubernetes 1.22 \u4e4b\u524d\uff0c\u8282\u70b9\u4e0d\u652f\u6301\u4f7f\u7528\u4ea4\u6362\u5185\u5b58\uff0c\u5e76\u4e14\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u5728\u8282\u70b9\u4e0a\u68c0\u6d4b\u5230\u4ea4\u6362\u5185\u5b58\u914d\u7f6e\uff0ckubelet \u5c06\u65e0\u6cd5\u542f\u52a8\u3002\u5728 1.22 \u4ee5\u540e\uff0c\u53ef\u4ee5\u9010\u4e2a\u8282\u70b9\u5730\u542f\u7528\u4ea4\u6362\u5185\u5b58\u652f\u6301 \u8981\u5728\u8282\u70b9\u4e0a\u542f\u7528\u4ea4\u6362\u5185\u5b58\uff0c\u5fc5\u987b\u542f\u7528kubelet \u7684 NodeSwap \u7279\u6027\u95e8\u63a7\uff0c\u540c\u65f6\u4f7f\u7528 --fail-swap-on \u547d\u4ee4\u884c\u53c2\u6570\u6216\u8005\u5c06 failSwapOn \u914d\u7f6e \u8bbe\u7f6e\u4e3a false \u7528\u6237\u8fd8\u53ef\u4ee5\u9009\u62e9\u914d\u7f6e memorySwap.swapBehavior \u4ee5\u6307\u5b9a\u8282\u70b9\u4f7f\u7528\u4ea4\u6362\u5185\u5b58\u7684\u65b9\u5f0f\u3002\u4f8b\u5982: memorySwap : swapBehavior : LimitedSwap \u53ef\u7528\u7684 swapBehavior \u7684\u914d\u7f6e\u9009\u9879\u6709\uff1a LimitedSwap \uff1aKubernetes \u5de5\u4f5c\u8d1f\u8f7d\u7684\u4ea4\u6362\u5185\u5b58\u4f1a\u53d7\u9650\u5236\u3002\u4e0d\u53d7 Kubernetes \u7ba1\u7406\u7684\u8282\u70b9\u4e0a\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4ecd\u7136\u53ef\u4ee5\u4ea4\u6362 UnlimitedSwap \uff1aKubernetes \u5de5\u4f5c\u8d1f\u8f7d\u53ef\u4ee5\u4f7f\u7528\u5c3d\u53ef\u80fd\u591a\u7684\u4ea4\u6362\u5185\u5b58\u8bf7\u6c42\uff0c\u4e00\u76f4\u5230\u8fbe\u5230\u7cfb\u7edf\u9650\u5236\u4e3a\u6b62 \u5982\u679c\u542f\u7528\u4e86\u7279\u6027\u95e8\u63a7\u4f46\u662f\u672a\u6307\u5b9a memorySwap \u7684\u914d\u7f6e\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b kubelet \u5c06\u4f7f\u7528 LimitedSwap \u8bbe\u7f6e LimitedSwap \u8fd9\u79cd\u8bbe\u7f6e\u7684\u884c\u4e3a\u53d6\u51b3\u4e8e\u8282\u70b9\u8fd0\u884c\u7684\u662f v1 \u8fd8\u662f v2 \u7684\u63a7\u5236\u7ec4\uff08\u4e5f\u5c31\u662f cgroups \uff09\uff1a cgroupsv1: Kubernetes \u5de5\u4f5c\u8d1f\u8f7d\u53ef\u4ee5\u4f7f\u7528\u5185\u5b58\u548c\u4ea4\u6362\uff0c\u4e0a\u9650\u4e3a Pod \u7684\u5185\u5b58\u9650\u5236\u503c\uff08\u5982\u679c\u8bbe\u7f6e\u4e86\u7684\u8bdd\uff09\u3002 cgroupsv2: Kubernetes \u5de5\u4f5c\u8d1f\u8f7d\u4e0d\u80fd\u4f7f\u7528\u4ea4\u6362\u5185\u5b58\u3002 \u5982\u9700\u66f4\u591a\u4fe1\u606f\u4ee5\u53ca\u534f\u52a9\u6d4b\u8bd5\u548c\u63d0\u4f9b\u53cd\u9988\uff0c\u8bf7\u53c2\u89c1 KEP-2400 \u53ca\u5176 \u8bbe\u8ba1\u63d0\u6848","title":"\u4ea4\u6362\u5185\u5b58\u7ba1\u7406"},{"location":"Chapter02/chapter02-02/","text":"Kubernetes \u67b6\u6784 - \u8282\u70b9\u4e0e\u63a7\u5236\u9762\u4e4b\u95f4\u7684\u901a\u4fe1 \u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u8282\u70b9\u4e0e\u63a7\u5236\u9762\u4e4b\u95f4\u7684\u901a\u4fe1 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 2C80A24 \u672c\u6587\u5217\u4e3e\u63a7\u5236\u9762\u8282\u70b9\uff08\u786e\u5207\u8bf4\u662f API \u670d\u52a1\u5668\uff09\u548c Kubernetes \u96c6\u7fa4\u4e4b\u95f4\u7684\u901a\u4fe1\u8def\u5f84\u3002\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9\u7528\u6237\u80fd\u591f\u81ea\u5b9a\u4e49\u4ed6\u4eec\u7684\u5b89\u88c5\uff0c\u4ee5\u5b9e\u73b0\u5bf9\u7f51\u7edc\u914d\u7f6e\u7684\u52a0\u56fa\uff0c\u4f7f\u5f97\u96c6\u7fa4\u80fd\u591f\u5728\u4e0d\u53ef\u4fe1\u7684\u7f51\u7edc\u4e0a\uff08\u6216\u8005\u5728\u4e00\u4e2a\u4e91\u670d\u52a1\u5546\u5b8c\u5168\u516c\u5f00\u7684 IP \u4e0a\uff09\u8fd0\u884c \u8282\u70b9\u5230\u63a7\u5236\u9762 Kubernetes \u91c7\u7528\u7684\u662f\u4e2d\u5fc3\u8f90\u5c04\u578b\uff08Hub-and-Spoke\uff09API \u6a21\u5f0f\u3002\u6240\u6709\u4ece\u8282\u70b9\uff08\u6216\u8fd0\u884c\u4e8e\u5176\u4e0a\u7684 Pod\uff09\u53d1\u51fa\u7684 API \u8c03\u7528\u90fd\u7ec8\u6b62\u4e8e API \u670d\u52a1\u5668\u3002\u5176\u5b83\u63a7\u5236\u9762\u7ec4\u4ef6\u90fd\u6ca1\u6709\u88ab\u8bbe\u8ba1\u4e3a\u53ef\u66b4\u9732\u8fdc\u7a0b\u670d\u52a1\u3002API \u670d\u52a1\u5668\u88ab\u914d\u7f6e\u4e3a\u5728\u4e00\u4e2a\u5b89\u5168\u7684 HTTPS \u7aef\u53e3\uff08\u901a\u5e38\u4e3a 443\uff09\u4e0a\u76d1\u542c\u8fdc\u7a0b\u8fde\u63a5\u8bf7\u6c42\uff0c\u5e76\u542f\u7528\u4e00\u79cd\u6216\u591a\u79cd\u5f62\u5f0f\u7684\u5ba2\u6237\u7aef \u8eab\u4efd\u8ba4\u8bc1 \u673a\u5236\u3002\u4e00\u79cd\u6216\u591a\u79cd\u5ba2\u6237\u7aef \u9274\u6743\u673a\u5236 \u5e94\u8be5\u88ab\u542f\u7528\uff0c\u7279\u522b\u662f\u5728\u5141\u8bb8\u4f7f\u7528 \u533f\u540d\u8bf7\u6c42 \u6216 \u670d\u52a1\u8d26\u6237\u4ee4\u724c \u7684\u65f6\u5019 \u5e94\u8be5\u4f7f\u7528\u96c6\u7fa4\u7684\u516c\u5171\u6839\u8bc1\u4e66\u5f00\u901a\u8282\u70b9\uff0c\u8fd9\u6837\u5b83\u4eec\u5c31\u80fd\u591f\u57fa\u4e8e\u6709\u6548\u7684\u5ba2\u6237\u7aef\u51ed\u636e\u5b89\u5168\u5730\u8fde\u63a5 API \u670d\u52a1\u5668\u3002\u4e00\u79cd\u597d\u7684\u65b9\u6cd5\u662f\u4ee5\u5ba2\u6237\u7aef\u8bc1\u4e66\u7684\u5f62\u5f0f\u5c06\u5ba2\u6237\u7aef\u51ed\u636e\u63d0\u4f9b\u7ed9 kubelet\u3002\u8bf7\u67e5\u770b kubelet TLS \u542f\u52a8\u5f15\u5bfc \u4ee5\u4e86\u89e3\u5982\u4f55\u81ea\u52a8\u63d0\u4f9b kubelet \u5ba2\u6237\u7aef\u8bc1\u4e66 \u60f3\u8981\u8fde\u63a5\u5230 API \u670d\u52a1\u5668\u7684 Pod \u53ef\u4ee5\u4f7f\u7528\u670d\u52a1\u8d26\u53f7\u5b89\u5168\u5730\u8fdb\u884c\u8fde\u63a5\u3002\u5f53 Pod \u88ab\u5b9e\u4f8b\u5316\u65f6\uff0cKubernetes \u81ea\u52a8\u628a\u516c\u5171\u6839\u8bc1\u4e66\u548c\u4e00\u4e2a\u6709\u6548\u7684\u6301\u6709\u8005\u4ee4\u724c\u6ce8\u5165\u5230 Pod \u91cc\u3002 kubernetes \u670d\u52a1\uff08\u4f4d\u4e8e default \u540d\u5b57\u7a7a\u95f4\u4e2d\uff09\u914d\u7f6e\u4e86\u4e00\u4e2a\u865a\u62df IP \u5730\u5740\uff0c\u7528\u4e8e\uff08\u901a\u8fc7 kube-proxy\uff09\u8f6c\u53d1\u8bf7\u6c42\u5230 API \u670d\u52a1\u5668\u7684 HTTPS \u672b\u7aef \u63a7\u5236\u9762\u7ec4\u4ef6\u4e5f\u901a\u8fc7\u5b89\u5168\u7aef\u53e3\u4e0e\u96c6\u7fa4\u7684 API \u670d\u52a1\u5668\u901a\u4fe1 \u8fd9\u6837\uff0c\u4ece\u96c6\u7fa4\u8282\u70b9\u548c\u8282\u70b9\u4e0a\u8fd0\u884c\u7684 Pod \u5230\u63a7\u5236\u9762\u7684\u8fde\u63a5\u7684\u7f3a\u7701\u64cd\u4f5c\u6a21\u5f0f\u5373\u662f\u5b89\u5168\u7684\uff0c\u80fd\u591f\u5728\u4e0d\u53ef\u4fe1\u7684\u7f51\u7edc\u6216\u516c\u7f51\u4e0a\u8fd0\u884c \u63a7\u5236\u9762\u5230\u8282\u70b9 \u4ece\u63a7\u5236\u9762\uff08API \u670d\u52a1\u5668\uff09\u5230\u8282\u70b9\u6709\u4e24\u79cd\u4e3b\u8981\u7684\u901a\u4fe1\u8def\u5f84\u3002\u7b2c\u4e00\u79cd\u662f\u4ece API \u670d\u52a1\u5668\u5230\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u7684 kubelet \u8fdb\u7a0b\u3002\u7b2c\u4e8c\u79cd\u662f\u4ece API \u670d\u52a1\u5668\u901a\u8fc7\u5b83\u7684\u4ee3\u7406\u529f\u80fd\u8fde\u63a5\u5230\u4efb\u4f55\u8282\u70b9\u3001Pod \u6216\u8005\u670d\u52a1 API \u670d\u52a1\u5668\u5230 kubelet \u4ece API \u670d\u52a1\u5668\u5230 kubelet \u7684\u8fde\u63a5\u7528\u4e8e\uff1a \u83b7\u53d6 Pod \u65e5\u5fd7 \u6302\u63a5\uff08\u901a\u8fc7 kubectl\uff09\u5230\u8fd0\u884c\u4e2d\u7684 Pod \u63d0\u4f9b kubelet \u7684\u7aef\u53e3\u8f6c\u53d1\u529f\u80fd\u3002 \u8fd9\u4e9b\u8fde\u63a5\u7ec8\u6b62\u4e8e kubelet \u7684 HTTPS \u672b\u7aef\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cAPI \u670d\u52a1\u5668\u4e0d\u68c0\u67e5 kubelet \u7684\u670d\u52a1\u8bc1\u4e66\u3002\u8fd9\u4f7f\u5f97\u6b64\u7c7b\u8fde\u63a5\u5bb9\u6613\u53d7\u5230\u4e2d\u95f4\u4eba\u653b\u51fb\uff0c\u5728\u975e\u53d7\u4fe1\u7f51\u7edc\u6216\u516c\u5f00\u7f51\u7edc\u4e0a\u8fd0\u884c\u4e5f\u662f \u4e0d\u5b89\u5168\u7684 \u4e3a\u4e86\u5bf9\u8fd9\u4e2a\u8fde\u63a5\u8fdb\u884c\u8ba4\u8bc1\uff0c\u4f7f\u7528 --kubelet-certificate-authority \u6807\u5fd7\u7ed9 API \u670d\u52a1\u5668\u63d0\u4f9b\u4e00\u4e2a\u6839\u8bc1\u4e66\u5305\uff0c\u7528\u4e8e kubelet \u7684\u670d\u52a1\u8bc1\u4e66 \u5982\u679c\u65e0\u6cd5\u5b9e\u73b0\u8fd9\u70b9\uff0c\u53c8\u8981\u6c42\u907f\u514d\u5728\u975e\u53d7\u4fe1\u7f51\u7edc\u6216\u516c\u5171\u7f51\u7edc\u4e0a\u8fdb\u884c\u8fde\u63a5\uff0c\u53ef\u5728 API \u670d\u52a1\u5668\u548c kubelet \u4e4b\u95f4\u4f7f\u7528 SSH \u96a7\u9053 \u6700\u540e\uff0c\u5e94\u8be5\u542f\u7528 Kubelet \u8ba4\u8bc1/\u9274\u6743 \u6765\u4fdd\u62a4 kubelet API API \u670d\u52a1\u5668\u5230\u8282\u70b9\u3001Pod \u548c\u670d\u52a1 \u4ece API \u670d\u52a1\u5668\u5230\u8282\u70b9\u3001Pod \u6216\u670d\u52a1\u7684\u8fde\u63a5\u9ed8\u8ba4\u4e3a\u7eaf HTTP \u65b9\u5f0f\uff0c\u56e0\u6b64\u65e2\u6ca1\u6709\u8ba4\u8bc1\uff0c\u4e5f\u6ca1\u6709\u52a0\u5bc6\u3002\u8fd9\u4e9b\u8fde\u63a5\u53ef\u901a\u8fc7\u7ed9 API URL \u4e2d\u7684\u8282\u70b9\u3001Pod \u6216\u670d\u52a1\u540d\u79f0\u6dfb\u52a0\u524d\u7f00 https: \u6765\u8fd0\u884c\u5728\u5b89\u5168\u7684 HTTPS \u8fde\u63a5\u4e0a\u3002\u4e0d\u8fc7\u8fd9\u4e9b\u8fde\u63a5\u65e2\u4e0d\u4f1a\u9a8c\u8bc1 HTTPS \u672b\u7aef\u63d0\u4f9b\u7684\u8bc1\u4e66\uff0c\u4e5f\u4e0d\u4f1a\u63d0\u4f9b\u5ba2\u6237\u7aef\u8bc1\u4e66\u3002\u56e0\u6b64\uff0c\u867d\u7136\u8fde\u63a5\u662f\u52a0\u5bc6\u7684\uff0c\u4ecd\u65e0\u6cd5\u63d0\u4f9b\u4efb\u4f55\u5b8c\u6574\u6027\u4fdd\u8bc1\u3002\u8fd9\u4e9b\u8fde\u63a5 \u76ee\u524d\u8fd8\u4e0d\u80fd\u5b89\u5168\u5730 \u5728\u975e\u53d7\u4fe1\u7f51\u7edc\u6216\u516c\u5171\u7f51\u7edc\u4e0a\u8fd0\u884c SSH \u96a7\u9053 Kubernetes \u652f\u6301\u4f7f\u7528 SSH \u96a7\u9053\u6765\u4fdd\u62a4\u4ece\u63a7\u5236\u9762\u5230\u8282\u70b9\u7684\u901a\u4fe1\u8def\u5f84\u3002\u5728\u8fd9\u79cd\u914d\u7f6e\u4e0b\uff0cAPI \u670d\u52a1\u5668\u5efa\u7acb\u4e00\u4e2a\u5230\u96c6\u7fa4\u4e2d\u5404\u8282\u70b9\u7684 SSH \u96a7\u9053\uff08\u8fde\u63a5\u5230\u5728 22 \u7aef\u53e3\u76d1\u542c\u7684 SSH \u670d\u52a1\u5668\uff09\u5e76\u901a\u8fc7\u8fd9\u4e2a\u96a7\u9053\u4f20\u8f93\u6240\u6709\u5230 kubelet\u3001\u8282\u70b9\u3001Pod \u6216\u670d\u52a1\u7684\u8bf7\u6c42\u3002\u8fd9\u4e00\u96a7\u9053\u4fdd\u8bc1\u901a\u4fe1\u4e0d\u4f1a\u88ab\u66b4\u9732\u5230\u96c6\u7fa4\u8282\u70b9\u6240\u8fd0\u884c\u7684\u7f51\u7edc\u4e4b\u5916 \u8bf4\u660e\uff1a SSH \u96a7\u9053\u76ee\u524d\u5df2\u88ab\u5e9f\u5f03\u3002\u9664\u975e\u4f60\u4e86\u89e3\u4e2a\u4e2d\u7ec6\u8282\uff0c\u5426\u5219\u4e0d\u5e94\u4f7f\u7528\u3002 Konnectivity \u670d\u52a1 \u662f SSH \u96a7\u9053\u7684\u66ff\u4ee3\u65b9\u6848 Konnectivity \u670d\u52a1 \u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.18 [beta] \u4f5c\u4e3a SSH \u96a7\u9053\u7684\u66ff\u4ee3\u65b9\u6848\uff0cKonnectivity \u670d\u52a1\u63d0\u4f9b TCP \u5c42\u7684\u4ee3\u7406\uff0c\u4ee5\u4fbf\u652f\u6301\u4ece\u63a7\u5236\u9762\u5230\u96c6\u7fa4\u7684\u901a\u4fe1\u3002Konnectivity \u670d\u52a1\u5305\u542b\u4e24\u4e2a\u90e8\u5206\uff1aKonnectivity \u670d\u52a1\u5668\u548c Konnectivity \u4ee3\u7406\uff0c\u5206\u522b\u8fd0\u884c\u5728\u63a7\u5236\u9762\u7f51\u7edc\u548c\u8282\u70b9\u7f51\u7edc\u4e2d\u3002Konnectivity \u4ee3\u7406\u5efa\u7acb\u5e76\u7ef4\u6301\u5230 Konnectivity \u670d\u52a1\u5668\u7684\u7f51\u7edc\u8fde\u63a5\u3002\u542f\u7528 Konnectivity \u670d\u52a1\u4e4b\u540e\uff0c\u6240\u6709\u63a7\u5236\u9762\u5230\u8282\u70b9\u7684\u901a\u4fe1\u90fd\u901a\u8fc7\u8fd9\u4e9b\u8fde\u63a5\u4f20\u8f93 \u8bf7\u6d4f\u89c8 Konnectivity \u670d\u52a1\u4efb\u52a1 \u5728\u4f60\u7684\u96c6\u7fa4\u4e2d\u914d\u7f6e Konnectivity \u670d\u52a1","title":"Kubernetes \u67b6\u6784 - \u8282\u70b9\u4e0e\u63a7\u5236\u9762\u4e4b\u95f4\u7684\u901a\u4fe1"},{"location":"Chapter02/chapter02-02/#kubernetes-","text":"\u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u8282\u70b9\u4e0e\u63a7\u5236\u9762\u4e4b\u95f4\u7684\u901a\u4fe1 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 2C80A24 \u672c\u6587\u5217\u4e3e\u63a7\u5236\u9762\u8282\u70b9\uff08\u786e\u5207\u8bf4\u662f API \u670d\u52a1\u5668\uff09\u548c Kubernetes \u96c6\u7fa4\u4e4b\u95f4\u7684\u901a\u4fe1\u8def\u5f84\u3002\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9\u7528\u6237\u80fd\u591f\u81ea\u5b9a\u4e49\u4ed6\u4eec\u7684\u5b89\u88c5\uff0c\u4ee5\u5b9e\u73b0\u5bf9\u7f51\u7edc\u914d\u7f6e\u7684\u52a0\u56fa\uff0c\u4f7f\u5f97\u96c6\u7fa4\u80fd\u591f\u5728\u4e0d\u53ef\u4fe1\u7684\u7f51\u7edc\u4e0a\uff08\u6216\u8005\u5728\u4e00\u4e2a\u4e91\u670d\u52a1\u5546\u5b8c\u5168\u516c\u5f00\u7684 IP \u4e0a\uff09\u8fd0\u884c","title":"Kubernetes \u67b6\u6784 - \u8282\u70b9\u4e0e\u63a7\u5236\u9762\u4e4b\u95f4\u7684\u901a\u4fe1"},{"location":"Chapter02/chapter02-02/#node-to-control-plane","text":"Kubernetes \u91c7\u7528\u7684\u662f\u4e2d\u5fc3\u8f90\u5c04\u578b\uff08Hub-and-Spoke\uff09API \u6a21\u5f0f\u3002\u6240\u6709\u4ece\u8282\u70b9\uff08\u6216\u8fd0\u884c\u4e8e\u5176\u4e0a\u7684 Pod\uff09\u53d1\u51fa\u7684 API \u8c03\u7528\u90fd\u7ec8\u6b62\u4e8e API \u670d\u52a1\u5668\u3002\u5176\u5b83\u63a7\u5236\u9762\u7ec4\u4ef6\u90fd\u6ca1\u6709\u88ab\u8bbe\u8ba1\u4e3a\u53ef\u66b4\u9732\u8fdc\u7a0b\u670d\u52a1\u3002API \u670d\u52a1\u5668\u88ab\u914d\u7f6e\u4e3a\u5728\u4e00\u4e2a\u5b89\u5168\u7684 HTTPS \u7aef\u53e3\uff08\u901a\u5e38\u4e3a 443\uff09\u4e0a\u76d1\u542c\u8fdc\u7a0b\u8fde\u63a5\u8bf7\u6c42\uff0c\u5e76\u542f\u7528\u4e00\u79cd\u6216\u591a\u79cd\u5f62\u5f0f\u7684\u5ba2\u6237\u7aef \u8eab\u4efd\u8ba4\u8bc1 \u673a\u5236\u3002\u4e00\u79cd\u6216\u591a\u79cd\u5ba2\u6237\u7aef \u9274\u6743\u673a\u5236 \u5e94\u8be5\u88ab\u542f\u7528\uff0c\u7279\u522b\u662f\u5728\u5141\u8bb8\u4f7f\u7528 \u533f\u540d\u8bf7\u6c42 \u6216 \u670d\u52a1\u8d26\u6237\u4ee4\u724c \u7684\u65f6\u5019 \u5e94\u8be5\u4f7f\u7528\u96c6\u7fa4\u7684\u516c\u5171\u6839\u8bc1\u4e66\u5f00\u901a\u8282\u70b9\uff0c\u8fd9\u6837\u5b83\u4eec\u5c31\u80fd\u591f\u57fa\u4e8e\u6709\u6548\u7684\u5ba2\u6237\u7aef\u51ed\u636e\u5b89\u5168\u5730\u8fde\u63a5 API \u670d\u52a1\u5668\u3002\u4e00\u79cd\u597d\u7684\u65b9\u6cd5\u662f\u4ee5\u5ba2\u6237\u7aef\u8bc1\u4e66\u7684\u5f62\u5f0f\u5c06\u5ba2\u6237\u7aef\u51ed\u636e\u63d0\u4f9b\u7ed9 kubelet\u3002\u8bf7\u67e5\u770b kubelet TLS \u542f\u52a8\u5f15\u5bfc \u4ee5\u4e86\u89e3\u5982\u4f55\u81ea\u52a8\u63d0\u4f9b kubelet \u5ba2\u6237\u7aef\u8bc1\u4e66 \u60f3\u8981\u8fde\u63a5\u5230 API \u670d\u52a1\u5668\u7684 Pod \u53ef\u4ee5\u4f7f\u7528\u670d\u52a1\u8d26\u53f7\u5b89\u5168\u5730\u8fdb\u884c\u8fde\u63a5\u3002\u5f53 Pod \u88ab\u5b9e\u4f8b\u5316\u65f6\uff0cKubernetes \u81ea\u52a8\u628a\u516c\u5171\u6839\u8bc1\u4e66\u548c\u4e00\u4e2a\u6709\u6548\u7684\u6301\u6709\u8005\u4ee4\u724c\u6ce8\u5165\u5230 Pod \u91cc\u3002 kubernetes \u670d\u52a1\uff08\u4f4d\u4e8e default \u540d\u5b57\u7a7a\u95f4\u4e2d\uff09\u914d\u7f6e\u4e86\u4e00\u4e2a\u865a\u62df IP \u5730\u5740\uff0c\u7528\u4e8e\uff08\u901a\u8fc7 kube-proxy\uff09\u8f6c\u53d1\u8bf7\u6c42\u5230 API \u670d\u52a1\u5668\u7684 HTTPS \u672b\u7aef \u63a7\u5236\u9762\u7ec4\u4ef6\u4e5f\u901a\u8fc7\u5b89\u5168\u7aef\u53e3\u4e0e\u96c6\u7fa4\u7684 API \u670d\u52a1\u5668\u901a\u4fe1 \u8fd9\u6837\uff0c\u4ece\u96c6\u7fa4\u8282\u70b9\u548c\u8282\u70b9\u4e0a\u8fd0\u884c\u7684 Pod \u5230\u63a7\u5236\u9762\u7684\u8fde\u63a5\u7684\u7f3a\u7701\u64cd\u4f5c\u6a21\u5f0f\u5373\u662f\u5b89\u5168\u7684\uff0c\u80fd\u591f\u5728\u4e0d\u53ef\u4fe1\u7684\u7f51\u7edc\u6216\u516c\u7f51\u4e0a\u8fd0\u884c","title":"\u8282\u70b9\u5230\u63a7\u5236\u9762"},{"location":"Chapter02/chapter02-02/#control-plane-to-node","text":"\u4ece\u63a7\u5236\u9762\uff08API \u670d\u52a1\u5668\uff09\u5230\u8282\u70b9\u6709\u4e24\u79cd\u4e3b\u8981\u7684\u901a\u4fe1\u8def\u5f84\u3002\u7b2c\u4e00\u79cd\u662f\u4ece API \u670d\u52a1\u5668\u5230\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u7684 kubelet \u8fdb\u7a0b\u3002\u7b2c\u4e8c\u79cd\u662f\u4ece API \u670d\u52a1\u5668\u901a\u8fc7\u5b83\u7684\u4ee3\u7406\u529f\u80fd\u8fde\u63a5\u5230\u4efb\u4f55\u8282\u70b9\u3001Pod \u6216\u8005\u670d\u52a1","title":"\u63a7\u5236\u9762\u5230\u8282\u70b9"},{"location":"Chapter02/chapter02-02/#api-server-to-kubelet","text":"\u4ece API \u670d\u52a1\u5668\u5230 kubelet \u7684\u8fde\u63a5\u7528\u4e8e\uff1a \u83b7\u53d6 Pod \u65e5\u5fd7 \u6302\u63a5\uff08\u901a\u8fc7 kubectl\uff09\u5230\u8fd0\u884c\u4e2d\u7684 Pod \u63d0\u4f9b kubelet \u7684\u7aef\u53e3\u8f6c\u53d1\u529f\u80fd\u3002 \u8fd9\u4e9b\u8fde\u63a5\u7ec8\u6b62\u4e8e kubelet \u7684 HTTPS \u672b\u7aef\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cAPI \u670d\u52a1\u5668\u4e0d\u68c0\u67e5 kubelet \u7684\u670d\u52a1\u8bc1\u4e66\u3002\u8fd9\u4f7f\u5f97\u6b64\u7c7b\u8fde\u63a5\u5bb9\u6613\u53d7\u5230\u4e2d\u95f4\u4eba\u653b\u51fb\uff0c\u5728\u975e\u53d7\u4fe1\u7f51\u7edc\u6216\u516c\u5f00\u7f51\u7edc\u4e0a\u8fd0\u884c\u4e5f\u662f \u4e0d\u5b89\u5168\u7684 \u4e3a\u4e86\u5bf9\u8fd9\u4e2a\u8fde\u63a5\u8fdb\u884c\u8ba4\u8bc1\uff0c\u4f7f\u7528 --kubelet-certificate-authority \u6807\u5fd7\u7ed9 API \u670d\u52a1\u5668\u63d0\u4f9b\u4e00\u4e2a\u6839\u8bc1\u4e66\u5305\uff0c\u7528\u4e8e kubelet \u7684\u670d\u52a1\u8bc1\u4e66 \u5982\u679c\u65e0\u6cd5\u5b9e\u73b0\u8fd9\u70b9\uff0c\u53c8\u8981\u6c42\u907f\u514d\u5728\u975e\u53d7\u4fe1\u7f51\u7edc\u6216\u516c\u5171\u7f51\u7edc\u4e0a\u8fdb\u884c\u8fde\u63a5\uff0c\u53ef\u5728 API \u670d\u52a1\u5668\u548c kubelet \u4e4b\u95f4\u4f7f\u7528 SSH \u96a7\u9053 \u6700\u540e\uff0c\u5e94\u8be5\u542f\u7528 Kubelet \u8ba4\u8bc1/\u9274\u6743 \u6765\u4fdd\u62a4 kubelet API","title":"API \u670d\u52a1\u5668\u5230 kubelet"},{"location":"Chapter02/chapter02-02/#api-server-to-nodes-pods-and-services","text":"\u4ece API \u670d\u52a1\u5668\u5230\u8282\u70b9\u3001Pod \u6216\u670d\u52a1\u7684\u8fde\u63a5\u9ed8\u8ba4\u4e3a\u7eaf HTTP \u65b9\u5f0f\uff0c\u56e0\u6b64\u65e2\u6ca1\u6709\u8ba4\u8bc1\uff0c\u4e5f\u6ca1\u6709\u52a0\u5bc6\u3002\u8fd9\u4e9b\u8fde\u63a5\u53ef\u901a\u8fc7\u7ed9 API URL \u4e2d\u7684\u8282\u70b9\u3001Pod \u6216\u670d\u52a1\u540d\u79f0\u6dfb\u52a0\u524d\u7f00 https: \u6765\u8fd0\u884c\u5728\u5b89\u5168\u7684 HTTPS \u8fde\u63a5\u4e0a\u3002\u4e0d\u8fc7\u8fd9\u4e9b\u8fde\u63a5\u65e2\u4e0d\u4f1a\u9a8c\u8bc1 HTTPS \u672b\u7aef\u63d0\u4f9b\u7684\u8bc1\u4e66\uff0c\u4e5f\u4e0d\u4f1a\u63d0\u4f9b\u5ba2\u6237\u7aef\u8bc1\u4e66\u3002\u56e0\u6b64\uff0c\u867d\u7136\u8fde\u63a5\u662f\u52a0\u5bc6\u7684\uff0c\u4ecd\u65e0\u6cd5\u63d0\u4f9b\u4efb\u4f55\u5b8c\u6574\u6027\u4fdd\u8bc1\u3002\u8fd9\u4e9b\u8fde\u63a5 \u76ee\u524d\u8fd8\u4e0d\u80fd\u5b89\u5168\u5730 \u5728\u975e\u53d7\u4fe1\u7f51\u7edc\u6216\u516c\u5171\u7f51\u7edc\u4e0a\u8fd0\u884c","title":"API \u670d\u52a1\u5668\u5230\u8282\u70b9\u3001Pod \u548c\u670d\u52a1"},{"location":"Chapter02/chapter02-02/#ssh-tunnels","text":"Kubernetes \u652f\u6301\u4f7f\u7528 SSH \u96a7\u9053\u6765\u4fdd\u62a4\u4ece\u63a7\u5236\u9762\u5230\u8282\u70b9\u7684\u901a\u4fe1\u8def\u5f84\u3002\u5728\u8fd9\u79cd\u914d\u7f6e\u4e0b\uff0cAPI \u670d\u52a1\u5668\u5efa\u7acb\u4e00\u4e2a\u5230\u96c6\u7fa4\u4e2d\u5404\u8282\u70b9\u7684 SSH \u96a7\u9053\uff08\u8fde\u63a5\u5230\u5728 22 \u7aef\u53e3\u76d1\u542c\u7684 SSH \u670d\u52a1\u5668\uff09\u5e76\u901a\u8fc7\u8fd9\u4e2a\u96a7\u9053\u4f20\u8f93\u6240\u6709\u5230 kubelet\u3001\u8282\u70b9\u3001Pod \u6216\u670d\u52a1\u7684\u8bf7\u6c42\u3002\u8fd9\u4e00\u96a7\u9053\u4fdd\u8bc1\u901a\u4fe1\u4e0d\u4f1a\u88ab\u66b4\u9732\u5230\u96c6\u7fa4\u8282\u70b9\u6240\u8fd0\u884c\u7684\u7f51\u7edc\u4e4b\u5916 \u8bf4\u660e\uff1a SSH \u96a7\u9053\u76ee\u524d\u5df2\u88ab\u5e9f\u5f03\u3002\u9664\u975e\u4f60\u4e86\u89e3\u4e2a\u4e2d\u7ec6\u8282\uff0c\u5426\u5219\u4e0d\u5e94\u4f7f\u7528\u3002 Konnectivity \u670d\u52a1 \u662f SSH \u96a7\u9053\u7684\u66ff\u4ee3\u65b9\u6848","title":"SSH \u96a7\u9053"},{"location":"Chapter02/chapter02-02/#konnectivity-service","text":"\u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.18 [beta] \u4f5c\u4e3a SSH \u96a7\u9053\u7684\u66ff\u4ee3\u65b9\u6848\uff0cKonnectivity \u670d\u52a1\u63d0\u4f9b TCP \u5c42\u7684\u4ee3\u7406\uff0c\u4ee5\u4fbf\u652f\u6301\u4ece\u63a7\u5236\u9762\u5230\u96c6\u7fa4\u7684\u901a\u4fe1\u3002Konnectivity \u670d\u52a1\u5305\u542b\u4e24\u4e2a\u90e8\u5206\uff1aKonnectivity \u670d\u52a1\u5668\u548c Konnectivity \u4ee3\u7406\uff0c\u5206\u522b\u8fd0\u884c\u5728\u63a7\u5236\u9762\u7f51\u7edc\u548c\u8282\u70b9\u7f51\u7edc\u4e2d\u3002Konnectivity \u4ee3\u7406\u5efa\u7acb\u5e76\u7ef4\u6301\u5230 Konnectivity \u670d\u52a1\u5668\u7684\u7f51\u7edc\u8fde\u63a5\u3002\u542f\u7528 Konnectivity \u670d\u52a1\u4e4b\u540e\uff0c\u6240\u6709\u63a7\u5236\u9762\u5230\u8282\u70b9\u7684\u901a\u4fe1\u90fd\u901a\u8fc7\u8fd9\u4e9b\u8fde\u63a5\u4f20\u8f93 \u8bf7\u6d4f\u89c8 Konnectivity \u670d\u52a1\u4efb\u52a1 \u5728\u4f60\u7684\u96c6\u7fa4\u4e2d\u914d\u7f6e Konnectivity \u670d\u52a1","title":"Konnectivity \u670d\u52a1"},{"location":"Chapter02/chapter02-03/","text":"Kubernetes \u67b6\u6784 - \u63a7\u5236\u5668 \u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u63a7\u5236\u5668 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 3309CC3 \u5728\u673a\u5668\u4eba\u6280\u672f\u548c\u81ea\u52a8\u5316\u9886\u57df\uff0c\u63a7\u5236\u56de\u8def\uff08Control Loop\uff09\u662f\u4e00\u4e2a\u975e\u7ec8\u6b62\u56de\u8def\uff0c\u7528\u4e8e\u8c03\u8282\u7cfb\u7edf\u72b6\u6001 \u8fd9\u662f\u4e00\u4e2a\u63a7\u5236\u73af\u7684\u4f8b\u5b50\uff1a\u623f\u95f4\u91cc\u7684\u6e29\u5ea6\u81ea\u52a8\u8c03\u8282\u5668 \u5f53\u4f60\u8bbe\u7f6e\u4e86\u6e29\u5ea6\uff0c\u544a\u8bc9\u4e86\u6e29\u5ea6\u81ea\u52a8\u8c03\u8282\u5668\u4f60\u7684 \u671f\u671b\u72b6\u6001\uff08Desired State\uff09 \u3002\u623f\u95f4\u7684\u5b9e\u9645\u6e29\u5ea6\u662f \u5f53\u524d\u72b6\u6001\uff08Current State\uff09 \u3002\u901a\u8fc7\u5bf9\u8bbe\u5907\u7684\u5f00\u5173\u63a7\u5236\uff0c\u6e29\u5ea6\u81ea\u52a8\u8c03\u8282\u5668\u8ba9\u5176\u5f53\u524d\u72b6\u6001\u63a5\u8fd1\u671f\u671b\u72b6\u6001 \u5728 Kubernetes \u4e2d\uff0c\u63a7\u5236\u5668\u901a\u8fc7\u76d1\u63a7\u96c6\u7fa4\u7684\u516c\u5171\u72b6\u6001\uff0c\u5e76\u81f4\u529b\u4e8e\u5c06\u5f53\u524d\u72b6\u6001\u8f6c\u53d8\u4e3a\u671f\u671b\u7684\u72b6\u6001 \u63a7\u5236\u5668\u6a21\u5f0f \u4e00\u4e2a\u63a7\u5236\u5668\u81f3\u5c11\u8ffd\u8e2a\u4e00\u79cd\u7c7b\u578b\u7684 Kubernetes \u8d44\u6e90\u3002\u8fd9\u4e9b \u5bf9\u8c61 \u6709\u4e00\u4e2a\u4ee3\u8868\u671f\u671b\u72b6\u6001\u7684 spec \u5b57\u6bb5\u3002\u8be5\u8d44\u6e90\u7684\u63a7\u5236\u5668\u8d1f\u8d23\u786e\u4fdd\u5176\u5f53\u524d\u72b6\u6001\u63a5\u8fd1\u671f\u671b\u72b6\u6001 \u63a7\u5236\u5668\u53ef\u80fd\u4f1a\u81ea\u884c\u6267\u884c\u64cd\u4f5c\uff1b\u5728 Kubernetes \u4e2d\u66f4\u5e38\u89c1\u7684\u662f\u4e00\u4e2a\u63a7\u5236\u5668\u4f1a\u53d1\u9001\u4fe1\u606f\u7ed9 API \u670d\u52a1\u5668\uff0c\u8fd9\u4f1a\u6709\u526f\u4f5c\u7528\u3002\u5177\u4f53\u53ef\u53c2\u770b\u540e\u6587\u7684\u4f8b\u5b50 \u8bf4\u660e\uff1a \u4e00\u4e9b\u5185\u7f6e\u7684\u63a7\u5236\u5668\uff0c\u6bd4\u5982\u540d\u5b57\u7a7a\u95f4\u63a7\u5236\u5668\uff0c\u9488\u5bf9\u6ca1\u6709\u6307\u5b9a spec \u7684\u5bf9\u8c61\u3002\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u672c\u6587\u6ca1\u6709\u8be6\u7ec6\u4ecb\u7ecd\u8fd9\u4e9b\u7ec6\u8282 \u901a\u8fc7 API \u670d\u52a1\u5668\u6765\u63a7\u5236 Job \u63a7\u5236\u5668\u662f\u4e00\u4e2a Kubernetes \u5185\u7f6e\u63a7\u5236\u5668\u7684\u4f8b\u5b50\u3002\u5185\u7f6e\u63a7\u5236\u5668\u901a\u8fc7\u548c\u96c6\u7fa4 API \u670d\u52a1\u5668\u4ea4\u4e92\u6765\u7ba1\u7406\u72b6\u6001 Job \u662f\u4e00\u79cd Kubernetes \u8d44\u6e90\uff0c\u5b83\u8fd0\u884c\u4e00\u4e2a\u6216\u8005\u591a\u4e2a Pod\uff0c\u6765\u6267\u884c\u4e00\u4e2a\u4efb\u52a1\u7136\u540e\u505c\u6b62\u3002(\u4e00\u65e6 \u88ab\u8c03\u5ea6\u4e86 \uff0c\u5bf9 kubelet \u6765\u8bf4 Pod \u5bf9\u8c61\u5c31\u4f1a\u53d8\u6210\u4e86\u671f\u671b\u72b6\u6001\u7684\u4e00\u90e8\u5206\uff09 \u5728\u96c6\u7fa4\u4e2d\uff0c\u5f53 Job \u63a7\u5236\u5668\u62ff\u5230\u65b0\u4efb\u52a1\u65f6\uff0c\u5b83\u4f1a\u4fdd\u8bc1\u4e00\u7ec4 Node \u8282\u70b9\u4e0a\u7684 kubelet \u53ef\u4ee5\u8fd0\u884c\u6b63\u786e\u6570\u91cf\u7684 Pod \u6765\u5b8c\u6210\u5de5\u4f5c\u3002Job \u63a7\u5236\u5668\u4e0d\u4f1a\u81ea\u5df1\u8fd0\u884c\u4efb\u4f55\u7684 Pod \u6216\u8005\u5bb9\u5668\u3002Job \u63a7\u5236\u5668\u662f\u901a\u77e5 API \u670d\u52a1\u5668\u6765\u521b\u5efa\u6216\u8005\u79fb\u9664 Pod\u3002\u63a7\u5236\u9762\u4e2d\u7684\u5176\u5b83\u7ec4\u4ef6\u6839\u636e\u65b0\u7684\u6d88\u606f\u4f5c\u51fa\u53cd\u5e94\uff08\u8c03\u5ea6\u5e76\u8fd0\u884c\u65b0 Pod\uff09\u5e76\u4e14\u6700\u7ec8\u5b8c\u6210\u5de5\u4f5c \u521b\u5efa\u65b0 Job \u540e\uff0c\u6240\u671f\u671b\u7684\u72b6\u6001\u5c31\u662f\u5b8c\u6210\u8fd9\u4e2a Job\u3002Job \u63a7\u5236\u5668\u4f1a\u8ba9 Job \u7684\u5f53\u524d\u72b6\u6001\u4e0d\u65ad\u63a5\u8fd1\u671f\u671b\u72b6\u6001\uff1a\u521b\u5efa\u4e3a Job \u8981\u5b8c\u6210\u5de5\u4f5c\u6240\u9700\u8981\u7684 Pod\uff0c\u4f7f Job \u7684\u72b6\u6001\u63a5\u8fd1\u5b8c\u6210 \u63a7\u5236\u5668\u4e5f\u4f1a\u66f4\u65b0\u914d\u7f6e\u5bf9\u8c61\u3002\u4f8b\u5982\uff1a\u4e00\u65e6 Job \u7684\u5de5\u4f5c\u5b8c\u6210\u4e86\uff0cJob \u63a7\u5236\u5668\u4f1a\u66f4\u65b0 Job \u5bf9\u8c61\u7684\u72b6\u6001\u4e3a Finished \uff08\u8fd9\u6709\u70b9\u50cf\u6e29\u5ea6\u81ea\u52a8\u8c03\u8282\u5668\u5173\u95ed\u4e86\u4e00\u4e2a\u706f\uff0c\u4ee5\u6b64\u6765\u544a\u8bc9\u4f60\u623f\u95f4\u7684\u6e29\u5ea6\u73b0\u5728\u5230\u4f60\u8bbe\u5b9a\u7684\u503c\u4e86\uff09 \u76f4\u63a5\u63a7\u5236 \u76f8\u6bd4 Job \u63a7\u5236\u5668\uff0c\u6709\u4e9b\u63a7\u5236\u5668\u9700\u8981\u5bf9\u96c6\u7fa4\u5916\u7684\u4e00\u4e9b\u4e1c\u897f\u8fdb\u884c\u4fee\u6539 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u4f7f\u7528\u4e00\u4e2a\u63a7\u5236\u56de\u8def\u6765\u4fdd\u8bc1\u96c6\u7fa4\u4e2d\u6709\u8db3\u591f\u7684\u8282\u70b9\uff0c\u90a3\u4e48\u63a7\u5236\u5668\u5c31\u9700\u8981\u5f53\u524d\u96c6\u7fa4\u5916\u7684\u4e00\u4e9b\u670d\u52a1\u5728\u9700\u8981\u65f6\u521b\u5efa\u65b0\u8282\u70b9 \u548c\u5916\u90e8\u72b6\u6001\u4ea4\u4e92\u7684\u63a7\u5236\u5668\u4ece API \u670d\u52a1\u5668\u83b7\u53d6\u5230\u5b83\u60f3\u8981\u7684\u72b6\u6001\uff0c\u7136\u540e\u76f4\u63a5\u548c\u5916\u90e8\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\u5e76\u4f7f\u5f53\u524d\u72b6\u6001\u66f4\u63a5\u8fd1\u671f\u671b\u72b6\u6001 \uff08\u5b9e\u9645\u4e0a\u6709\u4e00\u4e2a \u63a7\u5236\u5668 \u53ef\u4ee5\u6c34\u5e73\u5730\u6269\u5c55\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\uff09 \u8fd9\u91cc\uff0c\u5f88\u91cd\u8981\u7684\u4e00\u70b9\u662f\uff0c\u63a7\u5236\u5668\u505a\u51fa\u4e86\u4e00\u4e9b\u53d8\u66f4\u4ee5\u4f7f\u5f97\u4e8b\u7269\u66f4\u63a5\u8fd1\u4f60\u7684\u671f\u671b\u72b6\u6001\uff0c\u4e4b\u540e\u5c06\u5f53\u524d\u72b6\u6001\u62a5\u544a\u7ed9\u96c6\u7fa4\u7684 API \u670d\u52a1\u5668\u3002\u5176\u4ed6\u63a7\u5236\u56de\u8def\u53ef\u4ee5\u89c2\u6d4b\u5230\u6240\u6c47\u62a5\u7684\u6570\u636e\u7684\u8fd9\u79cd\u53d8\u5316\u5e76\u91c7\u53d6\u5176\u5404\u81ea\u7684\u884c\u52a8 \u5728\u6e29\u5ea6\u8ba1\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u623f\u95f4\u5f88\u51b7\uff0c\u90a3\u4e48\u67d0\u4e2a\u63a7\u5236\u5668\u53ef\u80fd\u8fd8\u4f1a\u542f\u52a8\u4e00\u4e2a\u9632\u51bb\u52a0\u70ed\u5668\u3002\u5c31 Kubernetes \u96c6\u7fa4\u800c\u8a00\uff0c\u63a7\u5236\u9762\u95f4\u63a5\u5730\u4e0e IP \u5730\u5740\u7ba1\u7406\u5de5\u5177\u3001\u5b58\u50a8\u670d\u52a1\u3001\u4e91\u9a71\u52a8 APIs \u4ee5\u53ca\u5176\u4ed6\u670d\u52a1\u534f\u4f5c\uff0c\u901a\u8fc7 \u6269\u5c55 Kubernetes \u6765\u5b9e\u73b0\u8fd9\u70b9 \u671f\u671b\u72b6\u6001\u4e0e\u5f53\u524d\u72b6\u6001 Kubernetes \u91c7\u7528\u4e86\u7cfb\u7edf\u7684\u4e91\u539f\u751f\u89c6\u56fe\uff0c\u5e76\u4e14\u53ef\u4ee5\u5904\u7406\u6301\u7eed\u7684\u53d8\u5316 \u5728\u4efb\u52a1\u6267\u884c\u65f6\uff0c\u96c6\u7fa4\u968f\u65f6\u90fd\u53ef\u80fd\u88ab\u4fee\u6539\uff0c\u5e76\u4e14\u63a7\u5236\u56de\u8def\u4f1a\u81ea\u52a8\u4fee\u590d\u6545\u969c\u3002\u8fd9\u610f\u5473\u7740\u5f88\u53ef\u80fd\u96c6\u7fa4\u6c38\u8fdc\u4e0d\u4f1a\u8fbe\u5230\u7a33\u5b9a\u72b6\u6001 \u53ea\u8981\u96c6\u7fa4\u4e2d\u7684\u63a7\u5236\u5668\u5728\u8fd0\u884c\u5e76\u4e14\u8fdb\u884c\u6709\u6548\u7684\u4fee\u6539\uff0c\u6574\u4f53\u72b6\u6001\u7684\u7a33\u5b9a\u4e0e\u5426\u662f\u65e0\u5173\u7d27\u8981\u7684 \u8bbe\u8ba1 \u4f5c\u4e3a\u8bbe\u8ba1\u539f\u5219\u4e4b\u4e00\uff0cKubernetes \u4f7f\u7528\u4e86\u5f88\u591a\u63a7\u5236\u5668\uff0c\u6bcf\u4e2a\u63a7\u5236\u5668\u7ba1\u7406\u96c6\u7fa4\u72b6\u6001\u7684\u4e00\u4e2a\u7279\u5b9a\u65b9\u9762\u3002\u6700\u5e38\u89c1\u7684\u4e00\u4e2a\u7279\u5b9a\u7684\u63a7\u5236\u5668\u4f7f\u7528\u4e00\u79cd\u7c7b\u578b\u7684\u8d44\u6e90\u4f5c\u4e3a\u5b83\u7684\u671f\u671b\u72b6\u6001\uff0c\u63a7\u5236\u5668\u7ba1\u7406\u63a7\u5236\u53e6\u5916\u4e00\u79cd\u7c7b\u578b\u7684\u8d44\u6e90\u5411\u5b83\u7684\u671f\u671b\u72b6\u6001\u6f14\u5316\u3002\u4f8b\u5982\uff0cJob \u7684\u63a7\u5236\u5668\u8ddf\u8e2a Job \u5bf9\u8c61\uff08\u4ee5\u53d1\u73b0\u65b0\u7684\u4efb\u52a1\uff09\u548c Pod \u5bf9\u8c61\uff08\u4ee5\u8fd0\u884c Job\uff0c\u7136\u540e\u67e5\u770b\u4efb\u52a1\u4f55\u65f6\u5b8c\u6210\uff09\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u65b0\u4efb\u52a1\u4f1a\u521b\u5efa Job\uff0c\u800c Job \u63a7\u5236\u5668\u4f1a\u521b\u5efa Pod \u4f7f\u7528\u7b80\u5355\u7684\u63a7\u5236\u5668\u800c\u4e0d\u662f\u4e00\u7ec4\u76f8\u4e92\u8fde\u63a5\u7684\u5355\u4f53\u63a7\u5236\u56de\u8def\u662f\u5f88\u6709\u7528\u7684\u3002\u63a7\u5236\u5668\u4f1a\u5931\u8d25\uff0c\u6240\u4ee5 Kubernetes \u7684\u8bbe\u8ba1\u6b63\u662f\u8003\u8651\u5230\u4e86\u8fd9\u4e00\u70b9 \u8bf4\u660e\uff1a \u53ef\u4ee5\u6709\u591a\u4e2a\u63a7\u5236\u5668\u6765\u521b\u5efa\u6216\u8005\u66f4\u65b0\u76f8\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\u3002\u5728\u540e\u53f0\uff0cKubernetes \u63a7\u5236\u5668\u786e\u4fdd\u5b83\u4eec\u53ea\u5173\u5fc3\u4e0e\u5176\u63a7\u5236\u8d44\u6e90\u76f8\u5173\u8054\u7684\u8d44\u6e90 \u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa Deployment \u548c Job\uff1b\u5b83\u4eec\u90fd\u53ef\u4ee5\u521b\u5efa Pod\u3002Job \u63a7\u5236\u5668\u4e0d\u4f1a\u5220\u9664 Deployment \u6240\u521b\u5efa\u7684 Pod\uff0c\u56e0\u4e3a\u6709\u4fe1\u606f\uff08\u6807\u7b7e\uff09\u8ba9\u63a7\u5236\u5668\u53ef\u4ee5\u533a\u5206\u8fd9\u4e9b Pod \u8fd0\u884c\u63a7\u5236\u5668\u7684\u65b9\u5f0f Kubernetes \u5185\u7f6e\u4e00\u7ec4\u63a7\u5236\u5668\uff0c\u8fd0\u884c\u5728 kube-controller-manager \u5185\u3002\u8fd9\u4e9b\u5185\u7f6e\u7684\u63a7\u5236\u5668\u63d0\u4f9b\u4e86\u91cd\u8981\u7684\u6838\u5fc3\u529f\u80fd Deployment \u63a7\u5236\u5668\u548c Job \u63a7\u5236\u5668\u662f Kubernetes \u5185\u7f6e\u63a7\u5236\u5668\u7684\u5178\u578b\u4f8b\u5b50\u3002Kubernetes \u5141\u8bb8\u4f60\u8fd0\u884c\u4e00\u4e2a\u7a33\u5b9a\u7684\u63a7\u5236\u5e73\u9762\uff0c\u8fd9\u6837\u5373\u4f7f\u67d0\u4e9b\u5185\u7f6e\u63a7\u5236\u5668\u5931\u8d25\u4e86\uff0c \u63a7\u5236\u5e73\u9762\u7684\u5176\u4ed6\u90e8\u5206\u4f1a\u63a5\u66ff\u5b83\u4eec\u7684\u5de5\u4f5c \u4f60\u4f1a\u9047\u5230\u67d0\u4e9b\u63a7\u5236\u5668\u8fd0\u884c\u5728\u63a7\u5236\u9762\u4e4b\u5916\uff0c\u7528\u4ee5\u6269\u5c55 Kubernetes\u3002\u6216\u8005\uff0c\u5982\u679c\u4f60\u613f\u610f\uff0c\u4f60\u4e5f\u53ef\u4ee5\u81ea\u5df1\u7f16\u5199\u65b0\u63a7\u5236\u5668\u3002\u4f60\u53ef\u4ee5\u4ee5\u4e00\u7ec4 Pod \u6765\u8fd0\u884c\u4f60\u7684\u63a7\u5236\u5668\uff0c\u6216\u8005\u8fd0\u884c\u5728 Kubernetes \u4e4b\u5916\u3002\u6700\u5408\u9002\u7684\u65b9\u6848\u53d6\u51b3\u4e8e\u63a7\u5236\u5668\u6240\u8981\u6267\u884c\u7684\u529f\u80fd\u662f\u4ec0\u4e48","title":"Kubernetes \u67b6\u6784 - \u63a7\u5236\u5668"},{"location":"Chapter02/chapter02-03/#kubernetes-","text":"\u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u63a7\u5236\u5668 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 3309CC3 \u5728\u673a\u5668\u4eba\u6280\u672f\u548c\u81ea\u52a8\u5316\u9886\u57df\uff0c\u63a7\u5236\u56de\u8def\uff08Control Loop\uff09\u662f\u4e00\u4e2a\u975e\u7ec8\u6b62\u56de\u8def\uff0c\u7528\u4e8e\u8c03\u8282\u7cfb\u7edf\u72b6\u6001 \u8fd9\u662f\u4e00\u4e2a\u63a7\u5236\u73af\u7684\u4f8b\u5b50\uff1a\u623f\u95f4\u91cc\u7684\u6e29\u5ea6\u81ea\u52a8\u8c03\u8282\u5668 \u5f53\u4f60\u8bbe\u7f6e\u4e86\u6e29\u5ea6\uff0c\u544a\u8bc9\u4e86\u6e29\u5ea6\u81ea\u52a8\u8c03\u8282\u5668\u4f60\u7684 \u671f\u671b\u72b6\u6001\uff08Desired State\uff09 \u3002\u623f\u95f4\u7684\u5b9e\u9645\u6e29\u5ea6\u662f \u5f53\u524d\u72b6\u6001\uff08Current State\uff09 \u3002\u901a\u8fc7\u5bf9\u8bbe\u5907\u7684\u5f00\u5173\u63a7\u5236\uff0c\u6e29\u5ea6\u81ea\u52a8\u8c03\u8282\u5668\u8ba9\u5176\u5f53\u524d\u72b6\u6001\u63a5\u8fd1\u671f\u671b\u72b6\u6001 \u5728 Kubernetes \u4e2d\uff0c\u63a7\u5236\u5668\u901a\u8fc7\u76d1\u63a7\u96c6\u7fa4\u7684\u516c\u5171\u72b6\u6001\uff0c\u5e76\u81f4\u529b\u4e8e\u5c06\u5f53\u524d\u72b6\u6001\u8f6c\u53d8\u4e3a\u671f\u671b\u7684\u72b6\u6001","title":"Kubernetes \u67b6\u6784 - \u63a7\u5236\u5668"},{"location":"Chapter02/chapter02-03/#controller-pattern","text":"\u4e00\u4e2a\u63a7\u5236\u5668\u81f3\u5c11\u8ffd\u8e2a\u4e00\u79cd\u7c7b\u578b\u7684 Kubernetes \u8d44\u6e90\u3002\u8fd9\u4e9b \u5bf9\u8c61 \u6709\u4e00\u4e2a\u4ee3\u8868\u671f\u671b\u72b6\u6001\u7684 spec \u5b57\u6bb5\u3002\u8be5\u8d44\u6e90\u7684\u63a7\u5236\u5668\u8d1f\u8d23\u786e\u4fdd\u5176\u5f53\u524d\u72b6\u6001\u63a5\u8fd1\u671f\u671b\u72b6\u6001 \u63a7\u5236\u5668\u53ef\u80fd\u4f1a\u81ea\u884c\u6267\u884c\u64cd\u4f5c\uff1b\u5728 Kubernetes \u4e2d\u66f4\u5e38\u89c1\u7684\u662f\u4e00\u4e2a\u63a7\u5236\u5668\u4f1a\u53d1\u9001\u4fe1\u606f\u7ed9 API \u670d\u52a1\u5668\uff0c\u8fd9\u4f1a\u6709\u526f\u4f5c\u7528\u3002\u5177\u4f53\u53ef\u53c2\u770b\u540e\u6587\u7684\u4f8b\u5b50 \u8bf4\u660e\uff1a \u4e00\u4e9b\u5185\u7f6e\u7684\u63a7\u5236\u5668\uff0c\u6bd4\u5982\u540d\u5b57\u7a7a\u95f4\u63a7\u5236\u5668\uff0c\u9488\u5bf9\u6ca1\u6709\u6307\u5b9a spec \u7684\u5bf9\u8c61\u3002\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u672c\u6587\u6ca1\u6709\u8be6\u7ec6\u4ecb\u7ecd\u8fd9\u4e9b\u7ec6\u8282","title":"\u63a7\u5236\u5668\u6a21\u5f0f"},{"location":"Chapter02/chapter02-03/#control-via-API-server","text":"Job \u63a7\u5236\u5668\u662f\u4e00\u4e2a Kubernetes \u5185\u7f6e\u63a7\u5236\u5668\u7684\u4f8b\u5b50\u3002\u5185\u7f6e\u63a7\u5236\u5668\u901a\u8fc7\u548c\u96c6\u7fa4 API \u670d\u52a1\u5668\u4ea4\u4e92\u6765\u7ba1\u7406\u72b6\u6001 Job \u662f\u4e00\u79cd Kubernetes \u8d44\u6e90\uff0c\u5b83\u8fd0\u884c\u4e00\u4e2a\u6216\u8005\u591a\u4e2a Pod\uff0c\u6765\u6267\u884c\u4e00\u4e2a\u4efb\u52a1\u7136\u540e\u505c\u6b62\u3002(\u4e00\u65e6 \u88ab\u8c03\u5ea6\u4e86 \uff0c\u5bf9 kubelet \u6765\u8bf4 Pod \u5bf9\u8c61\u5c31\u4f1a\u53d8\u6210\u4e86\u671f\u671b\u72b6\u6001\u7684\u4e00\u90e8\u5206\uff09 \u5728\u96c6\u7fa4\u4e2d\uff0c\u5f53 Job \u63a7\u5236\u5668\u62ff\u5230\u65b0\u4efb\u52a1\u65f6\uff0c\u5b83\u4f1a\u4fdd\u8bc1\u4e00\u7ec4 Node \u8282\u70b9\u4e0a\u7684 kubelet \u53ef\u4ee5\u8fd0\u884c\u6b63\u786e\u6570\u91cf\u7684 Pod \u6765\u5b8c\u6210\u5de5\u4f5c\u3002Job \u63a7\u5236\u5668\u4e0d\u4f1a\u81ea\u5df1\u8fd0\u884c\u4efb\u4f55\u7684 Pod \u6216\u8005\u5bb9\u5668\u3002Job \u63a7\u5236\u5668\u662f\u901a\u77e5 API \u670d\u52a1\u5668\u6765\u521b\u5efa\u6216\u8005\u79fb\u9664 Pod\u3002\u63a7\u5236\u9762\u4e2d\u7684\u5176\u5b83\u7ec4\u4ef6\u6839\u636e\u65b0\u7684\u6d88\u606f\u4f5c\u51fa\u53cd\u5e94\uff08\u8c03\u5ea6\u5e76\u8fd0\u884c\u65b0 Pod\uff09\u5e76\u4e14\u6700\u7ec8\u5b8c\u6210\u5de5\u4f5c \u521b\u5efa\u65b0 Job \u540e\uff0c\u6240\u671f\u671b\u7684\u72b6\u6001\u5c31\u662f\u5b8c\u6210\u8fd9\u4e2a Job\u3002Job \u63a7\u5236\u5668\u4f1a\u8ba9 Job \u7684\u5f53\u524d\u72b6\u6001\u4e0d\u65ad\u63a5\u8fd1\u671f\u671b\u72b6\u6001\uff1a\u521b\u5efa\u4e3a Job \u8981\u5b8c\u6210\u5de5\u4f5c\u6240\u9700\u8981\u7684 Pod\uff0c\u4f7f Job \u7684\u72b6\u6001\u63a5\u8fd1\u5b8c\u6210 \u63a7\u5236\u5668\u4e5f\u4f1a\u66f4\u65b0\u914d\u7f6e\u5bf9\u8c61\u3002\u4f8b\u5982\uff1a\u4e00\u65e6 Job \u7684\u5de5\u4f5c\u5b8c\u6210\u4e86\uff0cJob \u63a7\u5236\u5668\u4f1a\u66f4\u65b0 Job \u5bf9\u8c61\u7684\u72b6\u6001\u4e3a Finished \uff08\u8fd9\u6709\u70b9\u50cf\u6e29\u5ea6\u81ea\u52a8\u8c03\u8282\u5668\u5173\u95ed\u4e86\u4e00\u4e2a\u706f\uff0c\u4ee5\u6b64\u6765\u544a\u8bc9\u4f60\u623f\u95f4\u7684\u6e29\u5ea6\u73b0\u5728\u5230\u4f60\u8bbe\u5b9a\u7684\u503c\u4e86\uff09","title":"\u901a\u8fc7 API \u670d\u52a1\u5668\u6765\u63a7\u5236"},{"location":"Chapter02/chapter02-03/#direct-control","text":"\u76f8\u6bd4 Job \u63a7\u5236\u5668\uff0c\u6709\u4e9b\u63a7\u5236\u5668\u9700\u8981\u5bf9\u96c6\u7fa4\u5916\u7684\u4e00\u4e9b\u4e1c\u897f\u8fdb\u884c\u4fee\u6539 \u4f8b\u5982\uff0c\u5982\u679c\u4f60\u4f7f\u7528\u4e00\u4e2a\u63a7\u5236\u56de\u8def\u6765\u4fdd\u8bc1\u96c6\u7fa4\u4e2d\u6709\u8db3\u591f\u7684\u8282\u70b9\uff0c\u90a3\u4e48\u63a7\u5236\u5668\u5c31\u9700\u8981\u5f53\u524d\u96c6\u7fa4\u5916\u7684\u4e00\u4e9b\u670d\u52a1\u5728\u9700\u8981\u65f6\u521b\u5efa\u65b0\u8282\u70b9 \u548c\u5916\u90e8\u72b6\u6001\u4ea4\u4e92\u7684\u63a7\u5236\u5668\u4ece API \u670d\u52a1\u5668\u83b7\u53d6\u5230\u5b83\u60f3\u8981\u7684\u72b6\u6001\uff0c\u7136\u540e\u76f4\u63a5\u548c\u5916\u90e8\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\u5e76\u4f7f\u5f53\u524d\u72b6\u6001\u66f4\u63a5\u8fd1\u671f\u671b\u72b6\u6001 \uff08\u5b9e\u9645\u4e0a\u6709\u4e00\u4e2a \u63a7\u5236\u5668 \u53ef\u4ee5\u6c34\u5e73\u5730\u6269\u5c55\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\uff09 \u8fd9\u91cc\uff0c\u5f88\u91cd\u8981\u7684\u4e00\u70b9\u662f\uff0c\u63a7\u5236\u5668\u505a\u51fa\u4e86\u4e00\u4e9b\u53d8\u66f4\u4ee5\u4f7f\u5f97\u4e8b\u7269\u66f4\u63a5\u8fd1\u4f60\u7684\u671f\u671b\u72b6\u6001\uff0c\u4e4b\u540e\u5c06\u5f53\u524d\u72b6\u6001\u62a5\u544a\u7ed9\u96c6\u7fa4\u7684 API \u670d\u52a1\u5668\u3002\u5176\u4ed6\u63a7\u5236\u56de\u8def\u53ef\u4ee5\u89c2\u6d4b\u5230\u6240\u6c47\u62a5\u7684\u6570\u636e\u7684\u8fd9\u79cd\u53d8\u5316\u5e76\u91c7\u53d6\u5176\u5404\u81ea\u7684\u884c\u52a8 \u5728\u6e29\u5ea6\u8ba1\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u623f\u95f4\u5f88\u51b7\uff0c\u90a3\u4e48\u67d0\u4e2a\u63a7\u5236\u5668\u53ef\u80fd\u8fd8\u4f1a\u542f\u52a8\u4e00\u4e2a\u9632\u51bb\u52a0\u70ed\u5668\u3002\u5c31 Kubernetes \u96c6\u7fa4\u800c\u8a00\uff0c\u63a7\u5236\u9762\u95f4\u63a5\u5730\u4e0e IP \u5730\u5740\u7ba1\u7406\u5de5\u5177\u3001\u5b58\u50a8\u670d\u52a1\u3001\u4e91\u9a71\u52a8 APIs \u4ee5\u53ca\u5176\u4ed6\u670d\u52a1\u534f\u4f5c\uff0c\u901a\u8fc7 \u6269\u5c55 Kubernetes \u6765\u5b9e\u73b0\u8fd9\u70b9","title":"\u76f4\u63a5\u63a7\u5236"},{"location":"Chapter02/chapter02-03/#desired-vs-current","text":"Kubernetes \u91c7\u7528\u4e86\u7cfb\u7edf\u7684\u4e91\u539f\u751f\u89c6\u56fe\uff0c\u5e76\u4e14\u53ef\u4ee5\u5904\u7406\u6301\u7eed\u7684\u53d8\u5316 \u5728\u4efb\u52a1\u6267\u884c\u65f6\uff0c\u96c6\u7fa4\u968f\u65f6\u90fd\u53ef\u80fd\u88ab\u4fee\u6539\uff0c\u5e76\u4e14\u63a7\u5236\u56de\u8def\u4f1a\u81ea\u52a8\u4fee\u590d\u6545\u969c\u3002\u8fd9\u610f\u5473\u7740\u5f88\u53ef\u80fd\u96c6\u7fa4\u6c38\u8fdc\u4e0d\u4f1a\u8fbe\u5230\u7a33\u5b9a\u72b6\u6001 \u53ea\u8981\u96c6\u7fa4\u4e2d\u7684\u63a7\u5236\u5668\u5728\u8fd0\u884c\u5e76\u4e14\u8fdb\u884c\u6709\u6548\u7684\u4fee\u6539\uff0c\u6574\u4f53\u72b6\u6001\u7684\u7a33\u5b9a\u4e0e\u5426\u662f\u65e0\u5173\u7d27\u8981\u7684","title":"\u671f\u671b\u72b6\u6001\u4e0e\u5f53\u524d\u72b6\u6001"},{"location":"Chapter02/chapter02-03/#design","text":"\u4f5c\u4e3a\u8bbe\u8ba1\u539f\u5219\u4e4b\u4e00\uff0cKubernetes \u4f7f\u7528\u4e86\u5f88\u591a\u63a7\u5236\u5668\uff0c\u6bcf\u4e2a\u63a7\u5236\u5668\u7ba1\u7406\u96c6\u7fa4\u72b6\u6001\u7684\u4e00\u4e2a\u7279\u5b9a\u65b9\u9762\u3002\u6700\u5e38\u89c1\u7684\u4e00\u4e2a\u7279\u5b9a\u7684\u63a7\u5236\u5668\u4f7f\u7528\u4e00\u79cd\u7c7b\u578b\u7684\u8d44\u6e90\u4f5c\u4e3a\u5b83\u7684\u671f\u671b\u72b6\u6001\uff0c\u63a7\u5236\u5668\u7ba1\u7406\u63a7\u5236\u53e6\u5916\u4e00\u79cd\u7c7b\u578b\u7684\u8d44\u6e90\u5411\u5b83\u7684\u671f\u671b\u72b6\u6001\u6f14\u5316\u3002\u4f8b\u5982\uff0cJob \u7684\u63a7\u5236\u5668\u8ddf\u8e2a Job \u5bf9\u8c61\uff08\u4ee5\u53d1\u73b0\u65b0\u7684\u4efb\u52a1\uff09\u548c Pod \u5bf9\u8c61\uff08\u4ee5\u8fd0\u884c Job\uff0c\u7136\u540e\u67e5\u770b\u4efb\u52a1\u4f55\u65f6\u5b8c\u6210\uff09\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u65b0\u4efb\u52a1\u4f1a\u521b\u5efa Job\uff0c\u800c Job \u63a7\u5236\u5668\u4f1a\u521b\u5efa Pod \u4f7f\u7528\u7b80\u5355\u7684\u63a7\u5236\u5668\u800c\u4e0d\u662f\u4e00\u7ec4\u76f8\u4e92\u8fde\u63a5\u7684\u5355\u4f53\u63a7\u5236\u56de\u8def\u662f\u5f88\u6709\u7528\u7684\u3002\u63a7\u5236\u5668\u4f1a\u5931\u8d25\uff0c\u6240\u4ee5 Kubernetes \u7684\u8bbe\u8ba1\u6b63\u662f\u8003\u8651\u5230\u4e86\u8fd9\u4e00\u70b9 \u8bf4\u660e\uff1a \u53ef\u4ee5\u6709\u591a\u4e2a\u63a7\u5236\u5668\u6765\u521b\u5efa\u6216\u8005\u66f4\u65b0\u76f8\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\u3002\u5728\u540e\u53f0\uff0cKubernetes \u63a7\u5236\u5668\u786e\u4fdd\u5b83\u4eec\u53ea\u5173\u5fc3\u4e0e\u5176\u63a7\u5236\u8d44\u6e90\u76f8\u5173\u8054\u7684\u8d44\u6e90 \u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa Deployment \u548c Job\uff1b\u5b83\u4eec\u90fd\u53ef\u4ee5\u521b\u5efa Pod\u3002Job \u63a7\u5236\u5668\u4e0d\u4f1a\u5220\u9664 Deployment \u6240\u521b\u5efa\u7684 Pod\uff0c\u56e0\u4e3a\u6709\u4fe1\u606f\uff08\u6807\u7b7e\uff09\u8ba9\u63a7\u5236\u5668\u53ef\u4ee5\u533a\u5206\u8fd9\u4e9b Pod","title":"\u8bbe\u8ba1"},{"location":"Chapter02/chapter02-03/#running-controllers","text":"Kubernetes \u5185\u7f6e\u4e00\u7ec4\u63a7\u5236\u5668\uff0c\u8fd0\u884c\u5728 kube-controller-manager \u5185\u3002\u8fd9\u4e9b\u5185\u7f6e\u7684\u63a7\u5236\u5668\u63d0\u4f9b\u4e86\u91cd\u8981\u7684\u6838\u5fc3\u529f\u80fd Deployment \u63a7\u5236\u5668\u548c Job \u63a7\u5236\u5668\u662f Kubernetes \u5185\u7f6e\u63a7\u5236\u5668\u7684\u5178\u578b\u4f8b\u5b50\u3002Kubernetes \u5141\u8bb8\u4f60\u8fd0\u884c\u4e00\u4e2a\u7a33\u5b9a\u7684\u63a7\u5236\u5e73\u9762\uff0c\u8fd9\u6837\u5373\u4f7f\u67d0\u4e9b\u5185\u7f6e\u63a7\u5236\u5668\u5931\u8d25\u4e86\uff0c \u63a7\u5236\u5e73\u9762\u7684\u5176\u4ed6\u90e8\u5206\u4f1a\u63a5\u66ff\u5b83\u4eec\u7684\u5de5\u4f5c \u4f60\u4f1a\u9047\u5230\u67d0\u4e9b\u63a7\u5236\u5668\u8fd0\u884c\u5728\u63a7\u5236\u9762\u4e4b\u5916\uff0c\u7528\u4ee5\u6269\u5c55 Kubernetes\u3002\u6216\u8005\uff0c\u5982\u679c\u4f60\u613f\u610f\uff0c\u4f60\u4e5f\u53ef\u4ee5\u81ea\u5df1\u7f16\u5199\u65b0\u63a7\u5236\u5668\u3002\u4f60\u53ef\u4ee5\u4ee5\u4e00\u7ec4 Pod \u6765\u8fd0\u884c\u4f60\u7684\u63a7\u5236\u5668\uff0c\u6216\u8005\u8fd0\u884c\u5728 Kubernetes \u4e4b\u5916\u3002\u6700\u5408\u9002\u7684\u65b9\u6848\u53d6\u51b3\u4e8e\u63a7\u5236\u5668\u6240\u8981\u6267\u884c\u7684\u529f\u80fd\u662f\u4ec0\u4e48","title":"\u8fd0\u884c\u63a7\u5236\u5668\u7684\u65b9\u5f0f"},{"location":"Chapter02/chapter02-04/","text":"Kubernetes \u67b6\u6784 - \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 \u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 3B77C73 \u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.11 [beta] \u4f7f\u7528\u4e91\u57fa\u7840\u8bbe\u65bd\u6280\u672f\uff0c\u4f60\u53ef\u4ee5\u5728\u516c\u6709\u4e91\u3001\u79c1\u6709\u4e91\u6216\u8005\u6df7\u5408\u4e91\u73af\u5883\u4e2d\u8fd0\u884c Kubernetes\u3002Kubernetes \u7684\u4fe1\u6761\u662f\u57fa\u4e8e\u81ea\u52a8\u5316\u7684\u3001API \u9a71\u52a8\u7684\u57fa\u7840\u8bbe\u65bd\uff0c\u540c\u65f6\u907f\u514d\u7ec4\u4ef6\u95f4\u7d27\u5bc6\u8026\u5408 \u7ec4\u4ef6 cloud-controller-manager \u662f\u6307\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\uff0c\u4e00\u4e2a Kubernetes \u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff0c\u5d4c\u5165\u4e86\u7279\u5b9a\u4e8e\u4e91\u5e73\u53f0\u7684\u63a7\u5236\u903b\u8f91\u3002\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\uff08Cloud Controller Manager\uff09\u5141\u8bb8\u4f60\u5c06\u4f60\u7684\u96c6\u7fa4\u8fde\u63a5\u5230\u4e91\u63d0\u4f9b\u5546\u7684 API \u4e4b\u4e0a\uff0c\u5e76\u5c06\u4e0e\u8be5\u4e91\u5e73\u53f0\u4ea4\u4e92\u7684\u7ec4\u4ef6\u540c\u4e0e\u4f60\u7684\u96c6\u7fa4\u4ea4\u4e92\u7684\u7ec4\u4ef6\u5206\u79bb\u5f00\u6765 \u901a\u8fc7\u5206\u79bb Kubernetes \u548c\u5e95\u5c42\u4e91\u57fa\u7840\u8bbe\u7f6e\u4e4b\u95f4\u7684\u4e92\u64cd\u4f5c\u6027\u903b\u8f91\uff0ccloud-controller-manager \u7ec4\u4ef6\u4f7f\u4e91\u63d0\u4f9b\u5546\u80fd\u591f\u4ee5\u4e0d\u540c\u4e8e Kubernetes \u4e3b\u9879\u76ee\u7684\u6b65\u8c03\u53d1\u5e03\u65b0\u7279\u5f81 cloud-controller-manager \u7ec4\u4ef6\u662f\u57fa\u4e8e\u4e00\u79cd\u63d2\u4ef6\u673a\u5236\u6765\u6784\u9020\u7684\uff0c\u8fd9\u79cd\u673a\u5236\u4f7f\u5f97\u4e0d\u540c\u7684\u4e91\u5382\u5546\u90fd\u80fd\u5c06\u5176\u5e73\u53f0\u4e0e Kubernetes \u96c6\u6210 \u8bbe\u8ba1 \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u4ee5\u4e00\u7ec4\u591a\u526f\u672c\u7684\u8fdb\u7a0b\u96c6\u5408\u7684\u5f62\u5f0f\u8fd0\u884c\u5728\u63a7\u5236\u9762\u4e2d\uff0c\u901a\u5e38\u8868\u73b0\u4e3a Pod \u4e2d\u7684\u5bb9\u5668\u3002\u6bcf\u4e2a cloud-controller-manager \u5728\u540c\u4e00\u8fdb\u7a0b\u4e2d\u5b9e\u73b0\u591a\u4e2a\u63a7\u5236\u5668 \u8bf4\u660e\uff1a \u4f60\u4e5f\u53ef\u4ee5\u7528 Kubernetes \u63d2\u4ef6\u7684\u5f62\u5f0f\u800c\u4e0d\u662f\u63a7\u5236\u9762\u4e2d\u7684\u4e00\u90e8\u5206\u6765\u8fd0\u884c\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u7684\u529f\u80fd \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u4e2d\u7684\u63a7\u5236\u5668\u5305\u62ec\uff1a \u8282\u70b9\u63a7\u5236\u5668 \u8282\u70b9\u63a7\u5236\u5668\u8d1f\u8d23\u5728\u4e91\u57fa\u7840\u8bbe\u65bd\u4e2d\u521b\u5efa\u4e86\u65b0\u670d\u52a1\u5668\u65f6\u4e3a\u4e4b\u66f4\u65b0\u8282\u70b9\uff08Node\uff09\u5bf9\u8c61\u3002\u8282\u70b9\u63a7\u5236\u5668\u4ece\u4e91\u63d0\u4f9b\u5546\u83b7\u53d6\u5f53\u524d\u79df\u6237\u4e2d\u4e3b\u673a\u7684\u4fe1\u606f\u3002\u8282\u70b9\u63a7\u5236\u5668\u6267\u884c\u4ee5\u4e0b\u529f\u80fd\uff1a \u4f7f\u7528\u4ece\u4e91\u5e73\u53f0 API \u83b7\u53d6\u7684\u5bf9\u5e94\u670d\u52a1\u5668\u7684\u552f\u4e00\u6807\u8bc6\u7b26\u66f4\u65b0 Node \u5bf9\u8c61 \u5229\u7528\u7279\u5b9a\u4e91\u5e73\u53f0\u7684\u4fe1\u606f\u4e3a Node \u5bf9\u8c61\u6dfb\u52a0\u6ce8\u89e3\u548c\u6807\u7b7e\uff0c\u4f8b\u5982\u8282\u70b9\u6240\u5728\u7684\u533a\u57df\uff08Region\uff09\u548c\u6240\u5177\u6709\u7684\u8d44\u6e90\uff08CPU\u3001\u5185\u5b58\u7b49\u7b49\uff09 \u83b7\u53d6\u8282\u70b9\u7684\u7f51\u7edc\u5730\u5740\u548c\u4e3b\u673a\u540d \u68c0\u67e5\u8282\u70b9\u7684\u5065\u5eb7\u72b6\u51b5\u3002\u5982\u679c\u8282\u70b9\u65e0\u54cd\u5e94\uff0c\u63a7\u5236\u5668\u901a\u8fc7\u4e91\u5e73\u53f0 API \u67e5\u770b\u8be5\u8282\u70b9\u662f\u5426\u5df2\u4ece\u4e91\u4e2d\u7981\u7528\u3001\u5220\u9664\u6216\u7ec8\u6b62\u3002\u5982\u679c\u8282\u70b9\u5df2\u4ece\u4e91\u4e2d\u5220\u9664\uff0c\u5219\u63a7\u5236\u5668\u4ece Kubernetes \u96c6\u7fa4\u4e2d\u5220\u9664 Node \u5bf9\u8c61 \u67d0\u4e9b\u4e91\u9a71\u52a8\u5b9e\u73b0\u4e2d\uff0c\u8fd9\u4e9b\u4efb\u52a1\u88ab\u5212\u5206\u5230\u4e00\u4e2a\u8282\u70b9\u63a7\u5236\u5668\u548c\u4e00\u4e2a\u8282\u70b9\u751f\u547d\u5468\u671f\u63a7\u5236\u5668\u4e2d \u8def\u7531\u63a7\u5236\u5668 Route \u63a7\u5236\u5668\u8d1f\u8d23\u9002\u5f53\u5730\u914d\u7f6e\u4e91\u5e73\u53f0\u4e2d\u7684\u8def\u7531\uff0c\u4ee5\u4fbf Kubernetes \u96c6\u7fa4\u4e2d\u4e0d\u540c\u8282\u70b9\u4e0a\u7684\u5bb9\u5668\u4e4b\u95f4\u53ef\u4ee5\u76f8\u4e92\u901a\u4fe1 \u53d6\u51b3\u4e8e\u4e91\u9a71\u52a8\u672c\u8eab\uff0c\u8def\u7531\u63a7\u5236\u5668\u53ef\u80fd\u4e5f\u4f1a\u4e3a Pod \u7f51\u7edc\u5206\u914d IP \u5730\u5740\u5757 \u670d\u52a1\u63a7\u5236\u5668 \u670d\u52a1\uff08Service\uff09\u4e0e\u53d7\u63a7\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u3001IP \u5730\u5740\u3001\u7f51\u7edc\u5305\u8fc7\u6ee4\u3001\u76ee\u6807\u5065\u5eb7\u68c0\u67e5\u7b49\u4e91\u57fa\u7840\u8bbe\u65bd\u7ec4\u4ef6\u96c6\u6210\u3002\u670d\u52a1\u63a7\u5236\u5668\u4e0e\u4e91\u9a71\u52a8\u7684 API \u4ea4\u4e92\uff0c\u4ee5\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861\u5668\u548c\u5176\u4ed6\u57fa\u7840\u8bbe\u65bd\u7ec4\u4ef6\u3002\u4f60\u6240\u521b\u5efa\u7684 Service \u8d44\u6e90\u4f1a\u9700\u8981\u8fd9\u4e9b\u7ec4\u4ef6\u670d\u52a1 \u9274\u6743 \u672c\u8282\u5206\u522b\u8bb2\u8ff0\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u4e3a\u4e86\u5b8c\u6210\u81ea\u8eab\u5de5\u4f5c\u800c\u4ea7\u751f\u7684\u5bf9\u5404\u7c7b API \u5bf9\u8c61\u7684\u8bbf\u95ee\u9700\u6c42 \u8282\u70b9\u63a7\u5236\u5668 \u8282\u70b9\u63a7\u5236\u5668\u53ea\u64cd\u4f5c Node \u5bf9\u8c61\u3002\u5b83\u9700\u8981\u8bfb\u53d6\u548c\u4fee\u6539 Node \u5bf9\u8c61\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650 v1/Node \uff1a Get List Create Update Patch Watch Delete \u8def\u7531\u63a7\u5236\u5668 \u8def\u7531\u63a7\u5236\u5668\u4f1a\u76d1\u542c Node \u5bf9\u8c61\u7684\u521b\u5efa\u4e8b\u4ef6\uff0c\u5e76\u636e\u6b64\u914d\u7f6e\u8def\u7531\u8bbe\u65bd\u3002 \u5b83\u9700\u8981\u8bfb\u53d6 Node \u5bf9\u8c61\u7684 Get \u6743\u9650\u3002 v1/Node \uff1a Get \u670d\u52a1\u63a7\u5236\u5668 \u670d\u52a1\u63a7\u5236\u5668\u76d1\u6d4b Service \u5bf9\u8c61\u7684 Create\u3001Update \u548c Delete \u4e8b\u4ef6\uff0c\u5e76\u914d\u7f6e\u5bf9\u5e94\u670d\u52a1\u7684 Endpoints \u5bf9\u8c61\uff08\u5bf9\u4e8e EndpointSlices\uff0ckube-controller-manager \u6309\u9700\u5bf9\u5176\u8fdb\u884c\u7ba1\u7406\uff09 \u4e3a\u4e86\u8bbf\u95ee Service \u5bf9\u8c61\uff0c\u5b83\u9700\u8981 List \u548c Watch \u8bbf\u95ee\u6743\u9650\u3002\u4e3a\u4e86\u66f4\u65b0 Service \u5bf9\u8c61\uff0c\u5b83\u9700\u8981 Patch \u548c Update \u8bbf\u95ee\u6743\u9650 \u4e3a\u4e86\u80fd\u591f\u914d\u7f6e Service \u5bf9\u5e94\u7684 Endpoints \u8d44\u6e90\uff0c\u5b83\u9700\u8981 Create\u3001List\u3001Get\u3001Watch \u548c Update \u7b49\u8bbf\u95ee\u6743\u9650 v1/Service \uff1a List Get Watch Patch Update \u5176\u4ed6 \u5728\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u7684\u5b9e\u73b0\u4e2d\uff0c\u5176\u6838\u5fc3\u90e8\u5206\u9700\u8981\u521b\u5efa Event \u5bf9\u8c61\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u5e76\u521b\u5efa ServiceAccount \u8d44\u6e90\u4ee5\u4fdd\u8bc1\u64cd\u4f5c\u5b89\u5168\u6027\u7684\u6743\u9650 v1/Event \uff1a Create Patch Update v1/ServiceAccount \uff1a Create \u7528\u4e8e\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 RBAC \u7684 ClusterRole \u5982\u4e0b\u4f8b\u6240\u793a\uff1a apiVersion : rbac.authorization.k8s.io/v1 kind : ClusterRole metadata : name : cloud-controller-manager rules : - apiGroups : - \"\" resources : - events verbs : - create - patch - update - apiGroups : - \"\" resources : - nodes verbs : - '*' - apiGroups : - \"\" resources : - nodes/status verbs : - patch - apiGroups : - \"\" resources : - services verbs : - list - patch - update - watch - apiGroups : - \"\" resources : - serviceaccounts verbs : - create - apiGroups : - \"\" resources : - persistentvolumes verbs : - get - list - update - watch - apiGroups : - \"\" resources : - endpoints verbs : - create - get - list - watch - update","title":"Kubernetes \u67b6\u6784 - \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668"},{"location":"Chapter02/chapter02-04/#kubernetes-","text":"\u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 3B77C73 \u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.11 [beta] \u4f7f\u7528\u4e91\u57fa\u7840\u8bbe\u65bd\u6280\u672f\uff0c\u4f60\u53ef\u4ee5\u5728\u516c\u6709\u4e91\u3001\u79c1\u6709\u4e91\u6216\u8005\u6df7\u5408\u4e91\u73af\u5883\u4e2d\u8fd0\u884c Kubernetes\u3002Kubernetes \u7684\u4fe1\u6761\u662f\u57fa\u4e8e\u81ea\u52a8\u5316\u7684\u3001API \u9a71\u52a8\u7684\u57fa\u7840\u8bbe\u65bd\uff0c\u540c\u65f6\u907f\u514d\u7ec4\u4ef6\u95f4\u7d27\u5bc6\u8026\u5408 \u7ec4\u4ef6 cloud-controller-manager \u662f\u6307\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\uff0c\u4e00\u4e2a Kubernetes \u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff0c\u5d4c\u5165\u4e86\u7279\u5b9a\u4e8e\u4e91\u5e73\u53f0\u7684\u63a7\u5236\u903b\u8f91\u3002\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\uff08Cloud Controller Manager\uff09\u5141\u8bb8\u4f60\u5c06\u4f60\u7684\u96c6\u7fa4\u8fde\u63a5\u5230\u4e91\u63d0\u4f9b\u5546\u7684 API \u4e4b\u4e0a\uff0c\u5e76\u5c06\u4e0e\u8be5\u4e91\u5e73\u53f0\u4ea4\u4e92\u7684\u7ec4\u4ef6\u540c\u4e0e\u4f60\u7684\u96c6\u7fa4\u4ea4\u4e92\u7684\u7ec4\u4ef6\u5206\u79bb\u5f00\u6765 \u901a\u8fc7\u5206\u79bb Kubernetes \u548c\u5e95\u5c42\u4e91\u57fa\u7840\u8bbe\u7f6e\u4e4b\u95f4\u7684\u4e92\u64cd\u4f5c\u6027\u903b\u8f91\uff0ccloud-controller-manager \u7ec4\u4ef6\u4f7f\u4e91\u63d0\u4f9b\u5546\u80fd\u591f\u4ee5\u4e0d\u540c\u4e8e Kubernetes \u4e3b\u9879\u76ee\u7684\u6b65\u8c03\u53d1\u5e03\u65b0\u7279\u5f81 cloud-controller-manager \u7ec4\u4ef6\u662f\u57fa\u4e8e\u4e00\u79cd\u63d2\u4ef6\u673a\u5236\u6765\u6784\u9020\u7684\uff0c\u8fd9\u79cd\u673a\u5236\u4f7f\u5f97\u4e0d\u540c\u7684\u4e91\u5382\u5546\u90fd\u80fd\u5c06\u5176\u5e73\u53f0\u4e0e Kubernetes \u96c6\u6210","title":"Kubernetes \u67b6\u6784 - \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668"},{"location":"Chapter02/chapter02-04/#design","text":"\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u4ee5\u4e00\u7ec4\u591a\u526f\u672c\u7684\u8fdb\u7a0b\u96c6\u5408\u7684\u5f62\u5f0f\u8fd0\u884c\u5728\u63a7\u5236\u9762\u4e2d\uff0c\u901a\u5e38\u8868\u73b0\u4e3a Pod \u4e2d\u7684\u5bb9\u5668\u3002\u6bcf\u4e2a cloud-controller-manager \u5728\u540c\u4e00\u8fdb\u7a0b\u4e2d\u5b9e\u73b0\u591a\u4e2a\u63a7\u5236\u5668 \u8bf4\u660e\uff1a \u4f60\u4e5f\u53ef\u4ee5\u7528 Kubernetes \u63d2\u4ef6\u7684\u5f62\u5f0f\u800c\u4e0d\u662f\u63a7\u5236\u9762\u4e2d\u7684\u4e00\u90e8\u5206\u6765\u8fd0\u884c\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668","title":"\u8bbe\u8ba1"},{"location":"Chapter02/chapter02-04/#functions-of-the-ccm","text":"\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u4e2d\u7684\u63a7\u5236\u5668\u5305\u62ec\uff1a","title":"\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u7684\u529f\u80fd"},{"location":"Chapter02/chapter02-04/#node-controller","text":"\u8282\u70b9\u63a7\u5236\u5668\u8d1f\u8d23\u5728\u4e91\u57fa\u7840\u8bbe\u65bd\u4e2d\u521b\u5efa\u4e86\u65b0\u670d\u52a1\u5668\u65f6\u4e3a\u4e4b\u66f4\u65b0\u8282\u70b9\uff08Node\uff09\u5bf9\u8c61\u3002\u8282\u70b9\u63a7\u5236\u5668\u4ece\u4e91\u63d0\u4f9b\u5546\u83b7\u53d6\u5f53\u524d\u79df\u6237\u4e2d\u4e3b\u673a\u7684\u4fe1\u606f\u3002\u8282\u70b9\u63a7\u5236\u5668\u6267\u884c\u4ee5\u4e0b\u529f\u80fd\uff1a \u4f7f\u7528\u4ece\u4e91\u5e73\u53f0 API \u83b7\u53d6\u7684\u5bf9\u5e94\u670d\u52a1\u5668\u7684\u552f\u4e00\u6807\u8bc6\u7b26\u66f4\u65b0 Node \u5bf9\u8c61 \u5229\u7528\u7279\u5b9a\u4e91\u5e73\u53f0\u7684\u4fe1\u606f\u4e3a Node \u5bf9\u8c61\u6dfb\u52a0\u6ce8\u89e3\u548c\u6807\u7b7e\uff0c\u4f8b\u5982\u8282\u70b9\u6240\u5728\u7684\u533a\u57df\uff08Region\uff09\u548c\u6240\u5177\u6709\u7684\u8d44\u6e90\uff08CPU\u3001\u5185\u5b58\u7b49\u7b49\uff09 \u83b7\u53d6\u8282\u70b9\u7684\u7f51\u7edc\u5730\u5740\u548c\u4e3b\u673a\u540d \u68c0\u67e5\u8282\u70b9\u7684\u5065\u5eb7\u72b6\u51b5\u3002\u5982\u679c\u8282\u70b9\u65e0\u54cd\u5e94\uff0c\u63a7\u5236\u5668\u901a\u8fc7\u4e91\u5e73\u53f0 API \u67e5\u770b\u8be5\u8282\u70b9\u662f\u5426\u5df2\u4ece\u4e91\u4e2d\u7981\u7528\u3001\u5220\u9664\u6216\u7ec8\u6b62\u3002\u5982\u679c\u8282\u70b9\u5df2\u4ece\u4e91\u4e2d\u5220\u9664\uff0c\u5219\u63a7\u5236\u5668\u4ece Kubernetes \u96c6\u7fa4\u4e2d\u5220\u9664 Node \u5bf9\u8c61 \u67d0\u4e9b\u4e91\u9a71\u52a8\u5b9e\u73b0\u4e2d\uff0c\u8fd9\u4e9b\u4efb\u52a1\u88ab\u5212\u5206\u5230\u4e00\u4e2a\u8282\u70b9\u63a7\u5236\u5668\u548c\u4e00\u4e2a\u8282\u70b9\u751f\u547d\u5468\u671f\u63a7\u5236\u5668\u4e2d","title":"\u8282\u70b9\u63a7\u5236\u5668"},{"location":"Chapter02/chapter02-04/#route-controller","text":"Route \u63a7\u5236\u5668\u8d1f\u8d23\u9002\u5f53\u5730\u914d\u7f6e\u4e91\u5e73\u53f0\u4e2d\u7684\u8def\u7531\uff0c\u4ee5\u4fbf Kubernetes \u96c6\u7fa4\u4e2d\u4e0d\u540c\u8282\u70b9\u4e0a\u7684\u5bb9\u5668\u4e4b\u95f4\u53ef\u4ee5\u76f8\u4e92\u901a\u4fe1 \u53d6\u51b3\u4e8e\u4e91\u9a71\u52a8\u672c\u8eab\uff0c\u8def\u7531\u63a7\u5236\u5668\u53ef\u80fd\u4e5f\u4f1a\u4e3a Pod \u7f51\u7edc\u5206\u914d IP \u5730\u5740\u5757","title":"\u8def\u7531\u63a7\u5236\u5668"},{"location":"Chapter02/chapter02-04/#service-controller","text":"\u670d\u52a1\uff08Service\uff09\u4e0e\u53d7\u63a7\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u3001IP \u5730\u5740\u3001\u7f51\u7edc\u5305\u8fc7\u6ee4\u3001\u76ee\u6807\u5065\u5eb7\u68c0\u67e5\u7b49\u4e91\u57fa\u7840\u8bbe\u65bd\u7ec4\u4ef6\u96c6\u6210\u3002\u670d\u52a1\u63a7\u5236\u5668\u4e0e\u4e91\u9a71\u52a8\u7684 API \u4ea4\u4e92\uff0c\u4ee5\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861\u5668\u548c\u5176\u4ed6\u57fa\u7840\u8bbe\u65bd\u7ec4\u4ef6\u3002\u4f60\u6240\u521b\u5efa\u7684 Service \u8d44\u6e90\u4f1a\u9700\u8981\u8fd9\u4e9b\u7ec4\u4ef6\u670d\u52a1","title":"\u670d\u52a1\u63a7\u5236\u5668"},{"location":"Chapter02/chapter02-04/#authorization","text":"\u672c\u8282\u5206\u522b\u8bb2\u8ff0\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u4e3a\u4e86\u5b8c\u6210\u81ea\u8eab\u5de5\u4f5c\u800c\u4ea7\u751f\u7684\u5bf9\u5404\u7c7b API \u5bf9\u8c61\u7684\u8bbf\u95ee\u9700\u6c42","title":"\u9274\u6743"},{"location":"Chapter02/chapter02-04/#authorization-node-controller","text":"\u8282\u70b9\u63a7\u5236\u5668\u53ea\u64cd\u4f5c Node \u5bf9\u8c61\u3002\u5b83\u9700\u8981\u8bfb\u53d6\u548c\u4fee\u6539 Node \u5bf9\u8c61\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650 v1/Node \uff1a Get List Create Update Patch Watch Delete","title":"\u8282\u70b9\u63a7\u5236\u5668"},{"location":"Chapter02/chapter02-04/#authorization-route-controller","text":"\u8def\u7531\u63a7\u5236\u5668\u4f1a\u76d1\u542c Node \u5bf9\u8c61\u7684\u521b\u5efa\u4e8b\u4ef6\uff0c\u5e76\u636e\u6b64\u914d\u7f6e\u8def\u7531\u8bbe\u65bd\u3002 \u5b83\u9700\u8981\u8bfb\u53d6 Node \u5bf9\u8c61\u7684 Get \u6743\u9650\u3002 v1/Node \uff1a Get","title":"\u8def\u7531\u63a7\u5236\u5668"},{"location":"Chapter02/chapter02-04/#authorization-service-controller","text":"\u670d\u52a1\u63a7\u5236\u5668\u76d1\u6d4b Service \u5bf9\u8c61\u7684 Create\u3001Update \u548c Delete \u4e8b\u4ef6\uff0c\u5e76\u914d\u7f6e\u5bf9\u5e94\u670d\u52a1\u7684 Endpoints \u5bf9\u8c61\uff08\u5bf9\u4e8e EndpointSlices\uff0ckube-controller-manager \u6309\u9700\u5bf9\u5176\u8fdb\u884c\u7ba1\u7406\uff09 \u4e3a\u4e86\u8bbf\u95ee Service \u5bf9\u8c61\uff0c\u5b83\u9700\u8981 List \u548c Watch \u8bbf\u95ee\u6743\u9650\u3002\u4e3a\u4e86\u66f4\u65b0 Service \u5bf9\u8c61\uff0c\u5b83\u9700\u8981 Patch \u548c Update \u8bbf\u95ee\u6743\u9650 \u4e3a\u4e86\u80fd\u591f\u914d\u7f6e Service \u5bf9\u5e94\u7684 Endpoints \u8d44\u6e90\uff0c\u5b83\u9700\u8981 Create\u3001List\u3001Get\u3001Watch \u548c Update \u7b49\u8bbf\u95ee\u6743\u9650 v1/Service \uff1a List Get Watch Patch Update","title":"\u670d\u52a1\u63a7\u5236\u5668"},{"location":"Chapter02/chapter02-04/#authorization-miscellaneous","text":"\u5728\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u7684\u5b9e\u73b0\u4e2d\uff0c\u5176\u6838\u5fc3\u90e8\u5206\u9700\u8981\u521b\u5efa Event \u5bf9\u8c61\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u5e76\u521b\u5efa ServiceAccount \u8d44\u6e90\u4ee5\u4fdd\u8bc1\u64cd\u4f5c\u5b89\u5168\u6027\u7684\u6743\u9650 v1/Event \uff1a Create Patch Update v1/ServiceAccount \uff1a Create \u7528\u4e8e\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 RBAC \u7684 ClusterRole \u5982\u4e0b\u4f8b\u6240\u793a\uff1a apiVersion : rbac.authorization.k8s.io/v1 kind : ClusterRole metadata : name : cloud-controller-manager rules : - apiGroups : - \"\" resources : - events verbs : - create - patch - update - apiGroups : - \"\" resources : - nodes verbs : - '*' - apiGroups : - \"\" resources : - nodes/status verbs : - patch - apiGroups : - \"\" resources : - services verbs : - list - patch - update - watch - apiGroups : - \"\" resources : - serviceaccounts verbs : - create - apiGroups : - \"\" resources : - persistentvolumes verbs : - get - list - update - watch - apiGroups : - \"\" resources : - endpoints verbs : - create - get - list - watch - update","title":"\u5176\u4ed6"},{"location":"Chapter02/chapter02-05/","text":"Kubernetes \u67b6\u6784 - \u5173\u4e8e cgroup v2 \u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u5173\u4e8e cgroup v2 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a DBE2431 \u5728 Linux \u4e0a\uff0c\u63a7\u5236\u7ec4\u7ea6\u675f\u5206\u914d\u7ed9\u8fdb\u7a0b\u7684\u8d44\u6e90 kubelet \u548c\u5e95\u5c42\u5bb9\u5668\u8fd0\u884c\u65f6\u90fd\u9700\u8981\u5bf9\u63a5 cgroup \u6765\u5f3a\u5236\u6267\u884c \u4e3a Pod \u548c\u5bb9\u5668\u7ba1\u7406\u8d44\u6e90 \uff0c\u8fd9\u5305\u62ec\u4e3a\u5bb9\u5668\u5316\u5de5\u4f5c\u8d1f\u8f7d\u914d\u7f6e CPU/\u5185\u5b58\u8bf7\u6c42\u548c\u9650\u5236 Linux \u4e2d\u6709\u4e24\u4e2a cgroup \u7248\u672c\uff1acgroup v1 \u548c cgroup v2\u3002cgroup v2 \u662f\u65b0\u4e00\u4ee3\u7684 cgroup API \u4ec0\u4e48\u662f cgroup v2\uff1f \u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.25 [stable] cgroup v2 \u662f Linux cgroup API \u7684\u4e0b\u4e00\u4e2a\u7248\u672c\u3002cgroup v2 \u63d0\u4f9b\u4e86\u4e00\u4e2a\u5177\u6709\u589e\u5f3a\u8d44\u6e90\u7ba1\u7406\u80fd\u529b\u7684\u7edf\u4e00\u63a7\u5236\u7cfb\u7edf cgroup v2 \u5bf9 cgroup v1 \u8fdb\u884c\u4e86\u591a\u9879\u6539\u8fdb\uff0c\u4f8b\u5982\uff1a API \u4e2d\u5355\u4e2a\u7edf\u4e00\u7684\u5c42\u6b21\u7ed3\u6784\u8bbe\u8ba1 \u66f4\u5b89\u5168\u7684\u5b50\u6811\u59d4\u6d3e\u7ed9\u5bb9\u5668 \u66f4\u65b0\u7684\u529f\u80fd\u7279\u6027\uff0c\u4f8b\u5982 \u538b\u529b\u963b\u585e\u4fe1\u606f\uff08Pressure Stall Information\uff0cPSI\uff09 \u8de8\u591a\u4e2a\u8d44\u6e90\u7684\u589e\u5f3a\u8d44\u6e90\u5206\u914d\u7ba1\u7406\u548c\u9694\u79bb \u7edf\u4e00\u6838\u7b97\u4e0d\u540c\u7c7b\u578b\u7684\u5185\u5b58\u5206\u914d\uff08\u7f51\u7edc\u5185\u5b58\u3001\u5185\u6838\u5185\u5b58\u7b49\uff09 \u8003\u8651\u975e\u5373\u65f6\u8d44\u6e90\u53d8\u5316\uff0c\u4f8b\u5982\u9875\u9762\u7f13\u5b58\u56de\u5199 \u4e00\u4e9b Kubernetes \u7279\u6027\u4e13\u95e8\u4f7f\u7528 cgroup v2 \u6765\u589e\u5f3a\u8d44\u6e90\u7ba1\u7406\u548c\u9694\u79bb\u3002\u4f8b\u5982\uff0c MemoryQoS \u7279\u6027\u6539\u8fdb\u4e86\u5185\u5b58 QoS \u5e76\u4f9d\u8d56\u4e8e cgroup v2 \u539f\u8bed \u4f7f\u7528 cgroup v2 \u4f7f\u7528 cgroup v2 \u7684\u63a8\u8350\u65b9\u6cd5\u662f\u4f7f\u7528\u4e00\u4e2a\u9ed8\u8ba4\u542f\u7528 cgroup v2 \u7684 Linux \u53d1\u884c\u7248 \u8981\u68c0\u67e5\u4f60\u7684\u53d1\u884c\u7248\u662f\u5426\u4f7f\u7528 cgroup v2\uff0c\u8bf7\u53c2\u9605 \u8bc6\u522b Linux \u8282\u70b9\u4e0a\u7684 cgroup \u7248\u672c \u8981\u6c42 cgroup v2 \u5177\u6709\u4ee5\u4e0b\u8981\u6c42\uff1a \u64cd\u4f5c\u7cfb\u7edf\u53d1\u884c\u7248\u542f\u7528 cgroup v2 Linux \u5185\u6838\u4e3a 5.8 \u6216\u66f4\u9ad8\u7248\u672c \u5bb9\u5668\u8fd0\u884c\u65f6\u652f\u6301 cgroup v2\u3002\u4f8b\u5982\uff1a containerd v1.4 \u548c\u66f4\u9ad8\u7248\u672c cri-o v1.20 \u548c\u66f4\u9ad8\u7248\u672c kubelet \u548c\u5bb9\u5668\u8fd0\u884c\u65f6\u88ab\u914d\u7f6e\u4e3a\u4f7f\u7528 systemd cgroup \u9a71\u52a8 Linux \u53d1\u884c\u7248 cgroup v2 \u652f\u6301 \u6709\u5173\u4f7f\u7528 cgroup v2 \u7684 Linux \u53d1\u884c\u7248\u7684\u5217\u8868\uff0c\u8bf7\u53c2\u9605 cgroup v2 \u6587\u6863 Container-Optimized OS\uff08\u4ece M97 \u5f00\u59cb\uff09 Ubuntu\uff08\u4ece 21.10 \u5f00\u59cb\uff0c\u63a8\u8350 22.04+\uff09 Debian GNU/Linux\uff08\u4ece Debian 11 Bullseye \u5f00\u59cb\uff09 Fedora\uff08\u4ece 31 \u5f00\u59cb\uff09 Arch Linux\uff08\u4ece 2021 \u5e74 4 \u6708\u5f00\u59cb\uff09 RHEL \u548c\u7c7b\u4f3c RHEL \u7684\u53d1\u884c\u7248\uff08\u4ece 9 \u5f00\u59cb\uff09 \u8981\u68c0\u67e5\u4f60\u7684\u53d1\u884c\u7248\u662f\u5426\u4f7f\u7528 cgroup v2\uff0c\u8bf7\u53c2\u9605\u4f60\u7684\u53d1\u884c\u7248\u6587\u6863\u6216\u9075\u5faa \u8bc6\u522b Linux \u8282\u70b9\u4e0a\u7684 cgroup \u7248\u672c \u4e2d\u7684\u6307\u793a\u8bf4\u660e\u3002 \u4f60\u8fd8\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u5185\u6838 cmdline \u5f15\u5bfc\u53c2\u6570\u5728\u4f60\u7684 Linux \u53d1\u884c\u7248\u4e0a\u624b\u52a8\u542f\u7528 cgroup v2\u3002\u5982\u679c\u4f60\u7684\u53d1\u884c\u7248\u4f7f\u7528 GRUB\uff0c\u5219\u5e94\u5728 /etc/default/grub \u4e0b\u7684 GRUB_CMDLINE_LINUX \u4e2d\u6dfb\u52a0 systemd.unified_cgroup_hierarchy=1 \uff0c\u7136\u540e\u6267\u884c sudo update-grub \u3002\u4e0d\u8fc7\uff0c\u63a8\u8350\u7684\u65b9\u6cd5\u4ecd\u662f\u4f7f\u7528\u4e00\u4e2a\u9ed8\u8ba4\u5df2\u542f\u7528 cgroup v2 \u7684\u53d1\u884c\u7248 \u8fc1\u79fb\u5230 cgroup v2 \u8981\u8fc1\u79fb\u5230 cgroup v2\uff0c\u9700\u786e\u4fdd\u6ee1\u8db3 \u8981\u6c42 \uff0c\u7136\u540e\u5347\u7ea7\u5230\u4e00\u4e2a\u9ed8\u8ba4\u542f\u7528 cgroup v2 \u7684\u5185\u6838\u7248\u672c kubelet \u80fd\u591f\u81ea\u52a8\u68c0\u6d4b\u64cd\u4f5c\u7cfb\u7edf\u662f\u5426\u8fd0\u884c\u5728 cgroup v2 \u4e0a\u5e76\u76f8\u5e94\u8c03\u6574\u5176\u64cd\u4f5c\uff0c\u65e0\u9700\u989d\u5916\u914d\u7f6e \u5207\u6362\u5230 cgroup v2 \u65f6\uff0c\u7528\u6237\u4f53\u9a8c\u5e94\u6ca1\u6709\u4efb\u4f55\u660e\u663e\u5dee\u5f02\uff0c\u9664\u975e\u7528\u6237\u76f4\u63a5\u5728\u8282\u70b9\u4e0a\u6216\u4ece\u5bb9\u5668\u5185\u8bbf\u95ee cgroup \u6587\u4ef6\u7cfb\u7edf cgroup v2 \u4f7f\u7528\u4e00\u4e2a\u4e0e cgroup v1 \u4e0d\u540c\u7684 API\uff0c\u56e0\u6b64\u5982\u679c\u6709\u4efb\u4f55\u5e94\u7528\u76f4\u63a5\u8bbf\u95ee cgroup \u6587\u4ef6\u7cfb\u7edf\uff0c\u5219\u9700\u8981\u5c06\u8fd9\u4e9b\u5e94\u7528\u66f4\u65b0\u4e3a\u652f\u6301 cgroup v2 \u7684\u7248\u672c\u3002\u4f8b\u5982\uff1a \u4e00\u4e9b\u7b2c\u4e09\u65b9\u76d1\u63a7\u548c\u5b89\u5168\u4ee3\u7406\u53ef\u80fd\u4f9d\u8d56\u4e8e cgroup \u6587\u4ef6\u7cfb\u7edf\u3002\u4f60\u8981\u5c06\u8fd9\u4e9b\u4ee3\u7406\u66f4\u65b0\u5230\u652f\u6301 cgroup v2 \u7684\u7248\u672c \u5982\u679c\u4ee5\u72ec\u7acb\u7684 DaemonSet \u7684\u5f62\u5f0f\u8fd0\u884c cAdvisor \u4ee5\u76d1\u63a7 Pod \u548c\u5bb9\u5668\uff0c\u9700\u5c06\u5176\u66f4\u65b0\u5230 v0.43.0 \u6216\u66f4\u9ad8\u7248\u672c \u5982\u679c\u4f60\u4f7f\u7528 JDK\uff0c\u63a8\u8350\u4f7f\u7528 JDK 11.0.16 \u53ca\u66f4\u9ad8\u7248\u672c\u6216 JDK 15 \u53ca\u66f4\u9ad8\u7248\u672c\uff0c\u4ee5\u4fbf \u5b8c\u5168\u652f\u6301 cgroup v2 \u8bc6\u522b Linux \u8282\u70b9\u4e0a\u7684 cgroup \u7248\u672c cgroup \u7248\u672c\u53d6\u51b3\u4e8e\u6b63\u5728\u4f7f\u7528\u7684 Linux \u53d1\u884c\u7248\u548c\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u914d\u7f6e\u7684\u9ed8\u8ba4 cgroup \u7248\u672c\u3002\u8981\u68c0\u67e5\u4f60\u7684\u53d1\u884c\u7248\u4f7f\u7528\u7684\u662f\u54ea\u4e2a cgroup \u7248\u672c\uff0c\u8bf7\u5728\u8be5\u8282\u70b9\u4e0a\u8fd0\u884c stat -fc %T /sys/fs/cgroup/ \u547d\u4ee4\uff1a stat -fc %T /sys/fs/cgroup/ \u5bf9\u4e8e cgroup v2\uff0c\u8f93\u51fa\u4e3a cgroup2fs \u5bf9\u4e8e cgroup v1\uff0c\u8f93\u51fa\u4e3a tmpfs","title":"Kubernetes \u67b6\u6784 - \u5173\u4e8e cgroup v2"},{"location":"Chapter02/chapter02-05/#kubernetes-cgroup-v2","text":"\u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u5173\u4e8e cgroup v2 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a DBE2431 \u5728 Linux \u4e0a\uff0c\u63a7\u5236\u7ec4\u7ea6\u675f\u5206\u914d\u7ed9\u8fdb\u7a0b\u7684\u8d44\u6e90 kubelet \u548c\u5e95\u5c42\u5bb9\u5668\u8fd0\u884c\u65f6\u90fd\u9700\u8981\u5bf9\u63a5 cgroup \u6765\u5f3a\u5236\u6267\u884c \u4e3a Pod \u548c\u5bb9\u5668\u7ba1\u7406\u8d44\u6e90 \uff0c\u8fd9\u5305\u62ec\u4e3a\u5bb9\u5668\u5316\u5de5\u4f5c\u8d1f\u8f7d\u914d\u7f6e CPU/\u5185\u5b58\u8bf7\u6c42\u548c\u9650\u5236 Linux \u4e2d\u6709\u4e24\u4e2a cgroup \u7248\u672c\uff1acgroup v1 \u548c cgroup v2\u3002cgroup v2 \u662f\u65b0\u4e00\u4ee3\u7684 cgroup API","title":"Kubernetes \u67b6\u6784 - \u5173\u4e8e cgroup v2"},{"location":"Chapter02/chapter02-05/#cgroup-v2","text":"\u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.25 [stable] cgroup v2 \u662f Linux cgroup API \u7684\u4e0b\u4e00\u4e2a\u7248\u672c\u3002cgroup v2 \u63d0\u4f9b\u4e86\u4e00\u4e2a\u5177\u6709\u589e\u5f3a\u8d44\u6e90\u7ba1\u7406\u80fd\u529b\u7684\u7edf\u4e00\u63a7\u5236\u7cfb\u7edf cgroup v2 \u5bf9 cgroup v1 \u8fdb\u884c\u4e86\u591a\u9879\u6539\u8fdb\uff0c\u4f8b\u5982\uff1a API \u4e2d\u5355\u4e2a\u7edf\u4e00\u7684\u5c42\u6b21\u7ed3\u6784\u8bbe\u8ba1 \u66f4\u5b89\u5168\u7684\u5b50\u6811\u59d4\u6d3e\u7ed9\u5bb9\u5668 \u66f4\u65b0\u7684\u529f\u80fd\u7279\u6027\uff0c\u4f8b\u5982 \u538b\u529b\u963b\u585e\u4fe1\u606f\uff08Pressure Stall Information\uff0cPSI\uff09 \u8de8\u591a\u4e2a\u8d44\u6e90\u7684\u589e\u5f3a\u8d44\u6e90\u5206\u914d\u7ba1\u7406\u548c\u9694\u79bb \u7edf\u4e00\u6838\u7b97\u4e0d\u540c\u7c7b\u578b\u7684\u5185\u5b58\u5206\u914d\uff08\u7f51\u7edc\u5185\u5b58\u3001\u5185\u6838\u5185\u5b58\u7b49\uff09 \u8003\u8651\u975e\u5373\u65f6\u8d44\u6e90\u53d8\u5316\uff0c\u4f8b\u5982\u9875\u9762\u7f13\u5b58\u56de\u5199 \u4e00\u4e9b Kubernetes \u7279\u6027\u4e13\u95e8\u4f7f\u7528 cgroup v2 \u6765\u589e\u5f3a\u8d44\u6e90\u7ba1\u7406\u548c\u9694\u79bb\u3002\u4f8b\u5982\uff0c MemoryQoS \u7279\u6027\u6539\u8fdb\u4e86\u5185\u5b58 QoS \u5e76\u4f9d\u8d56\u4e8e cgroup v2 \u539f\u8bed","title":"\u4ec0\u4e48\u662f cgroup v2\uff1f"},{"location":"Chapter02/chapter02-05/#using-cgroupv2","text":"\u4f7f\u7528 cgroup v2 \u7684\u63a8\u8350\u65b9\u6cd5\u662f\u4f7f\u7528\u4e00\u4e2a\u9ed8\u8ba4\u542f\u7528 cgroup v2 \u7684 Linux \u53d1\u884c\u7248 \u8981\u68c0\u67e5\u4f60\u7684\u53d1\u884c\u7248\u662f\u5426\u4f7f\u7528 cgroup v2\uff0c\u8bf7\u53c2\u9605 \u8bc6\u522b Linux \u8282\u70b9\u4e0a\u7684 cgroup \u7248\u672c","title":"\u4f7f\u7528 cgroup v2"},{"location":"Chapter02/chapter02-05/#requirements","text":"cgroup v2 \u5177\u6709\u4ee5\u4e0b\u8981\u6c42\uff1a \u64cd\u4f5c\u7cfb\u7edf\u53d1\u884c\u7248\u542f\u7528 cgroup v2 Linux \u5185\u6838\u4e3a 5.8 \u6216\u66f4\u9ad8\u7248\u672c \u5bb9\u5668\u8fd0\u884c\u65f6\u652f\u6301 cgroup v2\u3002\u4f8b\u5982\uff1a containerd v1.4 \u548c\u66f4\u9ad8\u7248\u672c cri-o v1.20 \u548c\u66f4\u9ad8\u7248\u672c kubelet \u548c\u5bb9\u5668\u8fd0\u884c\u65f6\u88ab\u914d\u7f6e\u4e3a\u4f7f\u7528 systemd cgroup \u9a71\u52a8","title":"\u8981\u6c42"},{"location":"Chapter02/chapter02-05/#linux-distribution-cgroup-v2-support","text":"\u6709\u5173\u4f7f\u7528 cgroup v2 \u7684 Linux \u53d1\u884c\u7248\u7684\u5217\u8868\uff0c\u8bf7\u53c2\u9605 cgroup v2 \u6587\u6863 Container-Optimized OS\uff08\u4ece M97 \u5f00\u59cb\uff09 Ubuntu\uff08\u4ece 21.10 \u5f00\u59cb\uff0c\u63a8\u8350 22.04+\uff09 Debian GNU/Linux\uff08\u4ece Debian 11 Bullseye \u5f00\u59cb\uff09 Fedora\uff08\u4ece 31 \u5f00\u59cb\uff09 Arch Linux\uff08\u4ece 2021 \u5e74 4 \u6708\u5f00\u59cb\uff09 RHEL \u548c\u7c7b\u4f3c RHEL \u7684\u53d1\u884c\u7248\uff08\u4ece 9 \u5f00\u59cb\uff09 \u8981\u68c0\u67e5\u4f60\u7684\u53d1\u884c\u7248\u662f\u5426\u4f7f\u7528 cgroup v2\uff0c\u8bf7\u53c2\u9605\u4f60\u7684\u53d1\u884c\u7248\u6587\u6863\u6216\u9075\u5faa \u8bc6\u522b Linux \u8282\u70b9\u4e0a\u7684 cgroup \u7248\u672c \u4e2d\u7684\u6307\u793a\u8bf4\u660e\u3002 \u4f60\u8fd8\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u5185\u6838 cmdline \u5f15\u5bfc\u53c2\u6570\u5728\u4f60\u7684 Linux \u53d1\u884c\u7248\u4e0a\u624b\u52a8\u542f\u7528 cgroup v2\u3002\u5982\u679c\u4f60\u7684\u53d1\u884c\u7248\u4f7f\u7528 GRUB\uff0c\u5219\u5e94\u5728 /etc/default/grub \u4e0b\u7684 GRUB_CMDLINE_LINUX \u4e2d\u6dfb\u52a0 systemd.unified_cgroup_hierarchy=1 \uff0c\u7136\u540e\u6267\u884c sudo update-grub \u3002\u4e0d\u8fc7\uff0c\u63a8\u8350\u7684\u65b9\u6cd5\u4ecd\u662f\u4f7f\u7528\u4e00\u4e2a\u9ed8\u8ba4\u5df2\u542f\u7528 cgroup v2 \u7684\u53d1\u884c\u7248","title":"Linux \u53d1\u884c\u7248 cgroup v2 \u652f\u6301"},{"location":"Chapter02/chapter02-05/#migrating-cgroupv2","text":"\u8981\u8fc1\u79fb\u5230 cgroup v2\uff0c\u9700\u786e\u4fdd\u6ee1\u8db3 \u8981\u6c42 \uff0c\u7136\u540e\u5347\u7ea7\u5230\u4e00\u4e2a\u9ed8\u8ba4\u542f\u7528 cgroup v2 \u7684\u5185\u6838\u7248\u672c kubelet \u80fd\u591f\u81ea\u52a8\u68c0\u6d4b\u64cd\u4f5c\u7cfb\u7edf\u662f\u5426\u8fd0\u884c\u5728 cgroup v2 \u4e0a\u5e76\u76f8\u5e94\u8c03\u6574\u5176\u64cd\u4f5c\uff0c\u65e0\u9700\u989d\u5916\u914d\u7f6e \u5207\u6362\u5230 cgroup v2 \u65f6\uff0c\u7528\u6237\u4f53\u9a8c\u5e94\u6ca1\u6709\u4efb\u4f55\u660e\u663e\u5dee\u5f02\uff0c\u9664\u975e\u7528\u6237\u76f4\u63a5\u5728\u8282\u70b9\u4e0a\u6216\u4ece\u5bb9\u5668\u5185\u8bbf\u95ee cgroup \u6587\u4ef6\u7cfb\u7edf cgroup v2 \u4f7f\u7528\u4e00\u4e2a\u4e0e cgroup v1 \u4e0d\u540c\u7684 API\uff0c\u56e0\u6b64\u5982\u679c\u6709\u4efb\u4f55\u5e94\u7528\u76f4\u63a5\u8bbf\u95ee cgroup \u6587\u4ef6\u7cfb\u7edf\uff0c\u5219\u9700\u8981\u5c06\u8fd9\u4e9b\u5e94\u7528\u66f4\u65b0\u4e3a\u652f\u6301 cgroup v2 \u7684\u7248\u672c\u3002\u4f8b\u5982\uff1a \u4e00\u4e9b\u7b2c\u4e09\u65b9\u76d1\u63a7\u548c\u5b89\u5168\u4ee3\u7406\u53ef\u80fd\u4f9d\u8d56\u4e8e cgroup \u6587\u4ef6\u7cfb\u7edf\u3002\u4f60\u8981\u5c06\u8fd9\u4e9b\u4ee3\u7406\u66f4\u65b0\u5230\u652f\u6301 cgroup v2 \u7684\u7248\u672c \u5982\u679c\u4ee5\u72ec\u7acb\u7684 DaemonSet \u7684\u5f62\u5f0f\u8fd0\u884c cAdvisor \u4ee5\u76d1\u63a7 Pod \u548c\u5bb9\u5668\uff0c\u9700\u5c06\u5176\u66f4\u65b0\u5230 v0.43.0 \u6216\u66f4\u9ad8\u7248\u672c \u5982\u679c\u4f60\u4f7f\u7528 JDK\uff0c\u63a8\u8350\u4f7f\u7528 JDK 11.0.16 \u53ca\u66f4\u9ad8\u7248\u672c\u6216 JDK 15 \u53ca\u66f4\u9ad8\u7248\u672c\uff0c\u4ee5\u4fbf \u5b8c\u5168\u652f\u6301 cgroup v2","title":"\u8fc1\u79fb\u5230 cgroup v2"},{"location":"Chapter02/chapter02-05/#check-cgroup-version","text":"cgroup \u7248\u672c\u53d6\u51b3\u4e8e\u6b63\u5728\u4f7f\u7528\u7684 Linux \u53d1\u884c\u7248\u548c\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u914d\u7f6e\u7684\u9ed8\u8ba4 cgroup \u7248\u672c\u3002\u8981\u68c0\u67e5\u4f60\u7684\u53d1\u884c\u7248\u4f7f\u7528\u7684\u662f\u54ea\u4e2a cgroup \u7248\u672c\uff0c\u8bf7\u5728\u8be5\u8282\u70b9\u4e0a\u8fd0\u884c stat -fc %T /sys/fs/cgroup/ \u547d\u4ee4\uff1a stat -fc %T /sys/fs/cgroup/ \u5bf9\u4e8e cgroup v2\uff0c\u8f93\u51fa\u4e3a cgroup2fs \u5bf9\u4e8e cgroup v1\uff0c\u8f93\u51fa\u4e3a tmpfs","title":"\u8bc6\u522b Linux \u8282\u70b9\u4e0a\u7684 cgroup \u7248\u672c"},{"location":"Chapter02/chapter02-06/","text":"Kubernetes \u67b6\u6784 - \u5783\u573e\u6536\u96c6 \u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u5783\u573e\u6536\u96c6 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 7748CA1 \u5783\u573e\u6536\u96c6\uff08Garbage Collection\uff09\u662f Kubernetes \u7528\u4e8e\u6e05\u7406\u96c6\u7fa4\u8d44\u6e90\u7684\u5404\u79cd\u673a\u5236\u7684\u7edf\u79f0\u3002\u5783\u573e\u6536\u96c6\u5141\u8bb8\u7cfb\u7edf\u6e05\u7406\u5982\u4e0b\u8d44\u6e90\uff1a \u7ec8\u6b62\u7684 Pod \u5df2\u5b8c\u6210\u7684 Job \u4e0d\u518d\u5b58\u5728\u5c5e\u4e3b\u5f15\u7528\u7684\u5bf9\u8c61 \u672a\u4f7f\u7528\u7684\u5bb9\u5668\u548c\u5bb9\u5668\u955c\u50cf \u52a8\u6001\u5236\u5907\u7684\u3001StorageClass \u56de\u6536\u7b56\u7565\u4e3a Delete \u7684 PV \u5377 \u963b\u6ede\u6216\u8005\u8fc7\u671f\u7684 CertificateSigningRequest (CSRs) \u5728\u4ee5\u4e0b\u60c5\u5f62\u4e2d\u5220\u9664\u4e86\u7684\u8282\u70b9\u5bf9\u8c61\uff1a \u5f53\u96c6\u7fa4\u4f7f\u7528 \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 \u8fd0\u884c\u4e8e\u4e91\u7aef\u65f6 \u5f53\u96c6\u7fa4\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u7684\u63d2\u4ef6\u8fd0\u884c\u5728\u672c\u5730\u73af\u5883\u4e2d\u65f6 \u8282\u70b9\u79df\u7ea6\u5bf9\u8c61 \u5c5e\u4e3b\u4e0e\u4f9d\u8d56 Kubernetes \u4e2d\u5f88\u591a\u5bf9\u8c61\u901a\u8fc7 \u5c5e\u4e3b\u5f15\u7528 \u94fe\u63a5\u5230\u5f7c\u6b64\u3002\u5c5e\u4e3b\u5f15\u7528\uff08Owner Reference\uff09\u53ef\u4ee5\u544a\u8bc9\u63a7\u5236\u9762\u54ea\u4e9b\u5bf9\u8c61\u4f9d\u8d56\u4e8e\u5176\u4ed6\u5bf9\u8c61\u3002Kubernetes \u4f7f\u7528\u5c5e\u4e3b\u5f15\u7528\u6765\u4e3a\u63a7\u5236\u9762\u4ee5\u53ca\u5176\u4ed6 API \u5ba2\u6237\u7aef\u5728\u5220\u9664\u67d0\u5bf9\u8c61\u65f6\u63d0\u4f9b\u4e00\u4e2a\u6e05\u7406\u5173\u8054\u8d44\u6e90\u7684\u673a\u4f1a\u3002\u5728\u5927\u591a\u6570\u573a\u5408\uff0cKubernetes \u90fd\u662f\u81ea\u52a8\u7ba1\u7406\u5c5e\u4e3b\u5f15\u7528\u7684 \u5c5e\u4e3b\u5173\u7cfb\u4e0e\u67d0\u4e9b\u8d44\u6e90\u6240\u4f7f\u7528\u7684 \u6807\u7b7e\u548c\u9009\u62e9\u7b97\u7b26 \u4e0d\u540c\u3002\u4f8b\u5982\uff0c\u8003\u8651\u4e00\u4e2a\u521b\u5efa EndpointSlice \u5bf9\u8c61\u7684 Service \u5bf9\u8c61\u3002Service \u5bf9\u8c61\u4f7f\u7528 \u6807\u7b7e \u6765\u5141\u8bb8\u63a7\u5236\u9762\u786e\u5b9a\u54ea\u4e9b EndpointSlice \u5bf9\u8c61\u88ab\u8be5Service \u4f7f\u7528\u3002\u9664\u4e86\u6807\u7b7e\uff0c\u6bcf\u4e2a\u88ab Service \u6258\u7ba1\u7684 EndpointSlice \u5bf9\u8c61\u8fd8\u6709\u4e00\u4e2a\u5c5e\u4e3b\u5f15\u7528\u5c5e\u6027\u3002\u5c5e\u4e3b\u5f15\u7528\u53ef\u4ee5\u5e2e\u52a9 Kubernetes \u4e2d\u7684\u4e0d\u540c\u7ec4\u4ef6\u907f\u514d\u5e72\u9884\u5e76\u975e\u7531\u5b83\u4eec\u63a7\u5236\u7684\u5bf9\u8c61 \u8bf4\u660e\uff1a \u6839\u636e\u8bbe\u8ba1\uff0c\u7cfb\u7edf\u4e0d\u5141\u8bb8\u51fa\u73b0\u8de8\u540d\u5b57\u7a7a\u95f4\u7684\u5c5e\u4e3b\u5f15\u7528\u3002\u540d\u5b57\u7a7a\u95f4\u4f5c\u7528\u57df\u7684\u4f9d\u8d56\u5bf9\u8c61\u53ef\u4ee5\u6307\u5b9a\u96c6\u7fa4\u4f5c\u7528\u57df\u6216\u8005\u540d\u5b57\u7a7a\u95f4\u4f5c\u7528\u57df\u7684\u5c5e\u4e3b\u3002\u540d\u5b57\u7a7a\u95f4\u4f5c\u7528\u57df\u7684\u5c5e\u4e3b \u5fc5\u987b \u5b58\u5728\u4e8e\u4f9d\u8d56\u5bf9\u8c61\u6240\u5728\u7684\u540c\u4e00\u540d\u5b57\u7a7a\u95f4\u3002\u5982\u679c\u5c5e\u4e3b\u4f4d\u4e8e\u4e0d\u540c\u540d\u5b57\u7a7a\u95f4\uff0c\u5219\u5c5e\u4e3b\u5f15\u7528\u88ab\u89c6\u4e3a\u4e0d\u5b58\u5728\uff0c\u800c\u5f53\u68c0\u67e5\u53d1\u73b0\u6240\u6709\u5c5e\u4e3b\u90fd\u5df2\u4e0d\u5b58\u5728\u65f6\uff0c\u4f9d\u8d56\u5bf9\u8c61\u4f1a\u88ab\u5220\u9664 \u96c6\u7fa4\u4f5c\u7528\u57df\u7684\u4f9d\u8d56\u5bf9\u8c61\u53ea\u80fd\u6307\u5b9a\u96c6\u7fa4\u4f5c\u7528\u57df\u7684\u5c5e\u4e3b\u3002\u5728 1.20 \u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u5982\u679c\u4e00\u4e2a\u96c6\u7fa4\u4f5c\u7528\u57df\u7684\u4f9d\u8d56\u5bf9\u8c61\u6307\u5b9a\u4e86\u67d0\u4e2a\u540d\u5b57\u7a7a\u95f4\u4f5c\u7528\u57df\u7684\u7c7b\u522b\u4f5c\u4e3a\u5176\u5c5e\u4e3b\uff0c\u5219\u8be5\u5bf9\u8c61\u88ab\u89c6\u4e3a\u62e5\u6709\u4e00\u4e2a\u65e0\u6cd5\u89e3\u6790\u7684\u5c5e\u4e3b\u5f15\u7528\uff0c\u56e0\u800c\u65e0\u6cd5\u88ab\u5783\u573e\u6536\u96c6\u5904\u7406 \u5728 1.20 \u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u5982\u679c\u5783\u573e\u6536\u96c6\u5668\u68c0\u6d4b\u5230\u975e\u6cd5\u7684\u8de8\u540d\u5b57\u7a7a\u95f4 ownerReference \uff0c\u6216\u8005\u67d0\u96c6\u7fa4\u4f5c\u7528\u57df\u7684\u4f9d\u8d56\u5bf9\u8c61\u7684 ownerReference \u5f15\u7528\u67d0\u540d\u5b57\u7a7a\u95f4\u4f5c\u7528\u57df\u7684\u7c7b\u522b\uff0c\u7cfb\u7edf\u4f1a\u751f\u6210\u4e00\u4e2a\u8b66\u544a\u4e8b\u4ef6\uff0c\u5176\u539f\u56e0\u4e3a OwnerRefInvalidNamespace \uff0c involvedObject \u8bbe\u7f6e\u4e3a\u975e\u6cd5\u7684\u4f9d\u8d56\u5bf9\u8c61\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c kubectl get events -A --field-selector=reason=OwnerRefInvalidNamespace \u6765\u68c0\u67e5\u662f\u5426\u5b58\u5728\u8fd9\u7c7b\u4e8b\u4ef6 \u7ea7\u8054\u5220\u9664 Kubernetes \u4f1a\u68c0\u67e5\u5e76\u5220\u9664\u90a3\u4e9b\u4e0d\u518d\u62e5\u6709\u5c5e\u4e3b\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u4f8b\u5982\u5728\u4f60\u5220\u9664\u4e86 ReplicaSet\u4e4b\u540e\u7559\u4e0b\u6765\u7684 Pod\u3002\u5f53\u4f60\u5220\u9664\u67d0\u4e2a\u5bf9\u8c61\u65f6\uff0c\u4f60\u53ef\u4ee5\u63a7\u5236 Kubernetes \u662f\u5426\u53bb\u81ea\u52a8\u5220\u9664\u8be5\u5bf9\u8c61\u7684\u4f9d\u8d56\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a \u7ea7\u8054\u5220\u9664\uff08Cascading Deletion\uff09 \u3002\u7ea7\u8054\u5220\u9664\u6709\u4e24\u79cd\u7c7b\u578b\uff0c\u5206\u522b\u5982\u4e0b\uff1a \u524d\u53f0\u7ea7\u8054\u5220\u9664 \u540e\u53f0\u7ea7\u8054\u5220\u9664 \u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 Kubernetes Finalizers \u6765\u63a7\u5236\u5783\u573e\u6536\u96c6\u673a\u5236\u5982\u4f55\u4ee5\u53ca\u4f55\u65f6\u5220\u9664\u5305\u542b\u5c5e\u4e3b\u5f15\u7528\u7684\u8d44\u6e90 \u524d\u53f0\u7ea7\u8054\u5220\u9664 \u5728\u524d\u53f0\u7ea7\u8054\u5220\u9664\u4e2d\uff0c\u6b63\u5728\u88ab\u4f60\u5220\u9664\u7684\u5c5e\u4e3b\u5bf9\u8c61\u9996\u5148\u8fdb\u5165 deletion in progress \u72b6\u6001\u3002\u5728\u8fd9\u79cd\u72b6\u6001\u4e0b\uff0c\u9488\u5bf9\u5c5e\u4e3b\u5bf9\u8c61\u4f1a\u53d1\u751f\u4ee5\u4e0b\u4e8b\u60c5\uff1a Kubernetes API \u670d\u52a1\u5668\u5c06\u5bf9\u8c61\u7684 metadata.deletionTimestamp \u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u5bf9\u8c61\u88ab\u6807\u8bb0\u4e3a\u8981\u5220\u9664\u7684\u65f6\u95f4\u70b9 Kubernetes API \u670d\u52a1\u5668\u4e5f\u4f1a\u5c06 metadata.finalizers \u5b57\u6bb5\u8bbe\u7f6e\u4e3a foregroundDeletion \u5728\u5220\u9664\u8fc7\u7a0b\u5b8c\u6210\u4e4b\u524d\uff0c\u901a\u8fc7 Kubernetes API \u4ecd\u7136\u53ef\u4ee5\u770b\u5230\u8be5\u5bf9\u8c61 \u5f53\u5c5e\u4e3b\u5bf9\u8c61\u8fdb\u5165\u5220\u9664\u8fc7\u7a0b\u4e2d\u72b6\u6001\u540e\uff0c\u63a7\u5236\u5668\u5220\u9664\u5176\u4f9d\u8d56\u5bf9\u8c61\u3002\u63a7\u5236\u5668\u5728\u5220\u9664\u5b8c\u6240\u6709\u4f9d\u8d56\u5bf9\u8c61\u4e4b\u540e\uff0c\u5220\u9664\u5c5e\u4e3b\u5bf9\u8c61\u3002\u8fd9\u65f6\uff0c\u901a\u8fc7 Kubernetes API \u5c31\u65e0\u6cd5\u518d\u770b\u5230\u8be5\u5bf9\u8c61 \u5728\u524d\u53f0\u7ea7\u8054\u5220\u9664\u8fc7\u7a0b\u4e2d\uff0c\u552f\u4e00\u53ef\u80fd\u963b\u6b62\u5c5e\u4e3b\u5bf9\u8c61\u88ab\u5220\u9664\u7684\u662f\u90a3\u4e9b\u5e26\u6709 ownerReference.blockOwnerDeletion=true \u5b57\u6bb5\u7684\u4f9d\u8d56\u5bf9\u8c61\u3002\u53c2\u9605 \u4f7f\u7528\u524d\u53f0\u7ea7\u8054\u5220\u9664 \u4ee5\u4e86\u89e3\u8fdb\u4e00\u6b65\u7684\u7ec6\u8282 \u540e\u53f0\u7ea7\u8054\u5220\u9664 \u5728\u540e\u53f0\u7ea7\u8054\u5220\u9664\u8fc7\u7a0b\u4e2d\uff0cKubernetes \u670d\u52a1\u5668\u7acb\u5373\u5220\u9664\u5c5e\u4e3b\u5bf9\u8c61\uff0c\u63a7\u5236\u5668\u5728\u540e\u53f0\u6e05\u7406\u6240\u6709\u4f9d\u8d56\u5bf9\u8c61\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cKubernetes \u4f7f\u7528\u540e\u53f0\u7ea7\u8054\u5220\u9664\u65b9\u6848\uff0c\u9664\u975e\u4f60\u624b\u52a8\u8bbe\u7f6e\u4e86\u8981\u4f7f\u7528\u524d\u53f0\u5220\u9664\uff0c\u6216\u8005\u9009\u62e9\u9057\u5f03\u4f9d\u8d56\u5bf9\u8c61 \u53c2\u9605 \u4f7f\u7528\u540e\u53f0\u7ea7\u8054\u5220\u9664 \u4ee5\u4e86\u89e3\u8fdb\u4e00\u6b65\u7684\u7ec6\u8282 \u88ab\u9057\u5f03\u7684\u4f9d\u8d56\u5bf9\u8c61 \u5f53 Kubernetes \u5220\u9664\u67d0\u4e2a\u5c5e\u4e3b\u5bf9\u8c61\u65f6\uff0c\u88ab\u7559\u4e0b\u6765\u7684\u4f9d\u8d56\u5bf9\u8c61\u88ab\u79f0\u4f5c\u88ab\u9057\u5f03\u7684\uff08Orphaned\uff09\u5bf9\u8c61\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cKubernetes \u4f1a\u5220\u9664\u4f9d\u8d56\u5bf9\u8c61\u3002\u8981\u4e86\u89e3\u5982\u4f55\u91cd\u8f7d\u8fd9\u79cd\u9ed8\u8ba4\u884c\u4e3a\uff0c\u53ef\u53c2\u9605 \u5220\u9664\u5c5e\u4e3b\u5bf9\u8c61\u548c\u9057\u5f03\u4f9d\u8d56\u5bf9\u8c61 \u672a\u4f7f\u7528\u5bb9\u5668\u548c\u955c\u50cf\u7684\u5783\u573e\u6536\u96c6 kubelet \u4f1a\u6bcf\u4e94\u5206\u949f\u5bf9\u672a\u4f7f\u7528\u7684\u955c\u50cf\u6267\u884c\u4e00\u6b21\u5783\u573e\u6536\u96c6\uff0c\u6bcf\u5206\u949f\u5bf9\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u6267\u884c\u4e00\u6b21\u5783\u573e\u6536\u96c6\u3002\u4f60\u5e94\u8be5\u907f\u514d\u4f7f\u7528\u5916\u90e8\u7684\u5783\u573e\u6536\u96c6\u5de5\u5177\uff0c\u56e0\u4e3a\u5916\u90e8\u5de5\u5177\u53ef\u80fd\u4f1a\u7834\u574f kubelet \u7684\u884c\u4e3a\uff0c\u79fb\u9664\u5e94\u8be5\u4fdd\u7559\u7684\u5bb9\u5668 \u8981\u914d\u7f6e\u5bf9\u672a\u4f7f\u7528\u5bb9\u5668\u548c\u955c\u50cf\u7684\u5783\u573e\u6536\u96c6\u9009\u9879\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a \u914d\u7f6e\u6587\u4ef6 \uff0c\u57fa\u4e8e KubeletConfiguration \u8d44\u6e90\u7c7b\u578b\u6765\u8c03\u6574\u4e0e\u5783\u573e\u6536\u96c6\u76f8\u5173\u7684 kubelet \u884c\u4e3a \u5bb9\u5668\u955c\u50cf\u751f\u547d\u5468\u671f Kubernetes \u901a\u8fc7\u5176\u955c\u50cf\u7ba1\u7406\u5668\uff08Image Manager\uff09\u6765\u7ba1\u7406\u6240\u6709\u955c\u50cf\u7684\u751f\u547d\u5468\u671f\uff0c\u8be5\u7ba1\u7406\u5668\u662f kubelet \u7684\u4e00\u90e8\u5206\uff0c\u5de5\u4f5c\u65f6\u4e0e cadvisor \u534f\u540c\u3002kubelet \u5728\u4f5c\u51fa\u5783\u573e\u6536\u96c6\u51b3\u5b9a\u65f6\u4f1a\u8003\u8651\u5982\u4e0b\u78c1\u76d8\u7528\u91cf\u7ea6\u675f\uff1a HighThresholdPercent LowThresholdPercent \u78c1\u76d8\u7528\u91cf\u8d85\u51fa\u6240\u914d\u7f6e\u7684 HighThresholdPercent \u503c\u65f6\u4f1a\u89e6\u53d1\u5783\u573e\u6536\u96c6\uff0c\u5783\u573e\u6536\u96c6\u5668\u4f1a\u57fa\u4e8e\u955c\u50cf\u4e0a\u6b21\u88ab\u4f7f\u7528\u7684\u65f6\u95f4\u6765\u6309\u987a\u5e8f\u5220\u9664\u5b83\u4eec\uff0c\u9996\u5148\u5220\u9664\u7684\u662f\u6700\u8fd1\u672a\u4f7f\u7528\u7684\u955c\u50cf\u3002kubelet \u4f1a\u6301\u7eed\u5220\u9664\u955c\u50cf\uff0c\u76f4\u5230\u78c1\u76d8\u7528\u91cf\u5230\u8fbe LowThresholdPercent \u503c\u4e3a\u6b62 \u5bb9\u5668\u5783\u573e\u6536\u96c6 kubelet \u4f1a\u57fa\u4e8e\u5982\u4e0b\u53d8\u91cf\u5bf9\u6240\u6709\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u6267\u884c\u5783\u573e\u6536\u96c6\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u53d8\u91cf\u90fd\u662f\u4f60\u53ef\u4ee5\u5b9a\u4e49\u7684\uff1a MinAge \uff1akubelet \u53ef\u4ee5\u5783\u573e\u56de\u6536\u67d0\u4e2a\u5bb9\u5668\u65f6\u8be5\u5bb9\u5668\u7684\u6700\u5c0f\u5e74\u9f84\u3002\u8bbe\u7f6e\u4e3a 0 \u8868\u793a\u7981\u6b62\u4f7f\u7528\u6b64\u89c4\u5219 MaxPerPodContainer \uff1a\u6bcf\u4e2a Pod \u53ef\u4ee5\u5305\u542b\u7684\u5df2\u6b7b\u4ea1\u7684\u5bb9\u5668\u4e2a\u6570\u4e0a\u9650\u3002\u8bbe\u7f6e\u4e3a\u5c0f\u4e8e 0 \u7684\u503c\u8868\u793a\u7981\u6b62\u4f7f\u7528\u6b64\u89c4\u5219 MaxContainers \uff1a\u96c6\u7fa4\u4e2d\u53ef\u4ee5\u5b58\u5728\u7684\u5df2\u6b7b\u4ea1\u7684\u5bb9\u5668\u4e2a\u6570\u4e0a\u9650\u3002\u8bbe\u7f6e\u4e3a\u5c0f\u4e8e 0 \u7684\u503c\u610f\u5473\u7740\u7981\u6b62\u5e94\u7528\u6b64\u89c4\u5219 \u9664\u4ee5\u4e0a\u53d8\u91cf\u4e4b\u5916\uff0ckubelet \u8fd8\u4f1a\u5783\u573e\u6536\u96c6\u9664\u65e0\u6807\u8bc6\u7684\u4ee5\u53ca\u5df2\u5220\u9664\u7684\u5bb9\u5668\uff0c\u901a\u5e38\u4ece\u6700\u8fd1\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u5f00\u59cb \u5f53\u4fdd\u6301\u6bcf\u4e2a Pod \u7684\u6700\u5927\u6570\u91cf\u7684\u5bb9\u5668\uff08 MaxPerPodContainer \uff09\u4f1a\u4f7f\u5f97\u5168\u5c40\u7684\u5df2\u6b7b\u4ea1\u5bb9\u5668\u4e2a\u6570\u8d85\u51fa\u4e0a\u9650 \uff08 MaxContainers \uff09\u65f6\uff0c MaxPerPodContainers \u548c MaxContainers \u4e4b\u95f4\u53ef\u80fd\u4f1a\u51fa\u73b0\u51b2\u7a81\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0ckubelet \u4f1a\u8c03\u6574 MaxPerPodContainer \u6765\u89e3\u51b3\u8fd9\u4e00\u51b2\u7a81\u3002\u6700\u574f\u7684\u60c5\u5f62\u662f\u5c06 MaxPerPodContainer \u964d\u683c\u4e3a 1 \uff0c\u5e76\u9a71\u9010\u6700\u8fd1\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u3002\u6b64\u5916\uff0c\u5f53\u96b6\u5c5e\u4e8e\u67d0\u5df2\u88ab\u5220\u9664\u7684 Pod \u7684\u5bb9\u5668\u7684\u5e74\u9f84\u8d85\u8fc7 MinAge \u65f6\uff0c\u5b83\u4eec\u4e5f\u4f1a\u88ab\u5220\u9664 \u8bf4\u660e\uff1a kubelet \u4ec5\u4f1a\u56de\u6536\u7531\u5b83\u6240\u7ba1\u7406\u7684\u5bb9\u5668 \u914d\u7f6e\u5783\u573e\u6536\u96c6 \u4f60\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7279\u5b9a\u4e8e\u7ba1\u7406\u8d44\u6e90\u7684\u63a7\u5236\u5668\u6765\u8c03\u6574\u8d44\u6e90\u7684\u5783\u573e\u6536\u96c6\u884c\u4e3a\u3002\u4e0b\u9762\u7684\u9875\u9762\u4e3a\u4f60\u5c55\u793a\u5982\u4f55\u914d\u7f6e\u5783\u573e\u6536\u96c6\uff1a \u914d\u7f6e Kubernetes \u5bf9\u8c61\u7684\u7ea7\u8054\u5220\u9664 \u914d\u7f6e\u5df2\u5b8c\u6210 Job \u7684\u6e05\u7406","title":"Kubernetes \u67b6\u6784 - \u5783\u573e\u6536\u96c6"},{"location":"Chapter02/chapter02-06/#kubernetes-","text":"\u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u5783\u573e\u6536\u96c6 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 7748CA1 \u5783\u573e\u6536\u96c6\uff08Garbage Collection\uff09\u662f Kubernetes \u7528\u4e8e\u6e05\u7406\u96c6\u7fa4\u8d44\u6e90\u7684\u5404\u79cd\u673a\u5236\u7684\u7edf\u79f0\u3002\u5783\u573e\u6536\u96c6\u5141\u8bb8\u7cfb\u7edf\u6e05\u7406\u5982\u4e0b\u8d44\u6e90\uff1a \u7ec8\u6b62\u7684 Pod \u5df2\u5b8c\u6210\u7684 Job \u4e0d\u518d\u5b58\u5728\u5c5e\u4e3b\u5f15\u7528\u7684\u5bf9\u8c61 \u672a\u4f7f\u7528\u7684\u5bb9\u5668\u548c\u5bb9\u5668\u955c\u50cf \u52a8\u6001\u5236\u5907\u7684\u3001StorageClass \u56de\u6536\u7b56\u7565\u4e3a Delete \u7684 PV \u5377 \u963b\u6ede\u6216\u8005\u8fc7\u671f\u7684 CertificateSigningRequest (CSRs) \u5728\u4ee5\u4e0b\u60c5\u5f62\u4e2d\u5220\u9664\u4e86\u7684\u8282\u70b9\u5bf9\u8c61\uff1a \u5f53\u96c6\u7fa4\u4f7f\u7528 \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 \u8fd0\u884c\u4e8e\u4e91\u7aef\u65f6 \u5f53\u96c6\u7fa4\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u7684\u63d2\u4ef6\u8fd0\u884c\u5728\u672c\u5730\u73af\u5883\u4e2d\u65f6 \u8282\u70b9\u79df\u7ea6\u5bf9\u8c61","title":"Kubernetes \u67b6\u6784 - \u5783\u573e\u6536\u96c6"},{"location":"Chapter02/chapter02-06/#owners-dependents","text":"Kubernetes \u4e2d\u5f88\u591a\u5bf9\u8c61\u901a\u8fc7 \u5c5e\u4e3b\u5f15\u7528 \u94fe\u63a5\u5230\u5f7c\u6b64\u3002\u5c5e\u4e3b\u5f15\u7528\uff08Owner Reference\uff09\u53ef\u4ee5\u544a\u8bc9\u63a7\u5236\u9762\u54ea\u4e9b\u5bf9\u8c61\u4f9d\u8d56\u4e8e\u5176\u4ed6\u5bf9\u8c61\u3002Kubernetes \u4f7f\u7528\u5c5e\u4e3b\u5f15\u7528\u6765\u4e3a\u63a7\u5236\u9762\u4ee5\u53ca\u5176\u4ed6 API \u5ba2\u6237\u7aef\u5728\u5220\u9664\u67d0\u5bf9\u8c61\u65f6\u63d0\u4f9b\u4e00\u4e2a\u6e05\u7406\u5173\u8054\u8d44\u6e90\u7684\u673a\u4f1a\u3002\u5728\u5927\u591a\u6570\u573a\u5408\uff0cKubernetes \u90fd\u662f\u81ea\u52a8\u7ba1\u7406\u5c5e\u4e3b\u5f15\u7528\u7684 \u5c5e\u4e3b\u5173\u7cfb\u4e0e\u67d0\u4e9b\u8d44\u6e90\u6240\u4f7f\u7528\u7684 \u6807\u7b7e\u548c\u9009\u62e9\u7b97\u7b26 \u4e0d\u540c\u3002\u4f8b\u5982\uff0c\u8003\u8651\u4e00\u4e2a\u521b\u5efa EndpointSlice \u5bf9\u8c61\u7684 Service \u5bf9\u8c61\u3002Service \u5bf9\u8c61\u4f7f\u7528 \u6807\u7b7e \u6765\u5141\u8bb8\u63a7\u5236\u9762\u786e\u5b9a\u54ea\u4e9b EndpointSlice \u5bf9\u8c61\u88ab\u8be5Service \u4f7f\u7528\u3002\u9664\u4e86\u6807\u7b7e\uff0c\u6bcf\u4e2a\u88ab Service \u6258\u7ba1\u7684 EndpointSlice \u5bf9\u8c61\u8fd8\u6709\u4e00\u4e2a\u5c5e\u4e3b\u5f15\u7528\u5c5e\u6027\u3002\u5c5e\u4e3b\u5f15\u7528\u53ef\u4ee5\u5e2e\u52a9 Kubernetes \u4e2d\u7684\u4e0d\u540c\u7ec4\u4ef6\u907f\u514d\u5e72\u9884\u5e76\u975e\u7531\u5b83\u4eec\u63a7\u5236\u7684\u5bf9\u8c61 \u8bf4\u660e\uff1a \u6839\u636e\u8bbe\u8ba1\uff0c\u7cfb\u7edf\u4e0d\u5141\u8bb8\u51fa\u73b0\u8de8\u540d\u5b57\u7a7a\u95f4\u7684\u5c5e\u4e3b\u5f15\u7528\u3002\u540d\u5b57\u7a7a\u95f4\u4f5c\u7528\u57df\u7684\u4f9d\u8d56\u5bf9\u8c61\u53ef\u4ee5\u6307\u5b9a\u96c6\u7fa4\u4f5c\u7528\u57df\u6216\u8005\u540d\u5b57\u7a7a\u95f4\u4f5c\u7528\u57df\u7684\u5c5e\u4e3b\u3002\u540d\u5b57\u7a7a\u95f4\u4f5c\u7528\u57df\u7684\u5c5e\u4e3b \u5fc5\u987b \u5b58\u5728\u4e8e\u4f9d\u8d56\u5bf9\u8c61\u6240\u5728\u7684\u540c\u4e00\u540d\u5b57\u7a7a\u95f4\u3002\u5982\u679c\u5c5e\u4e3b\u4f4d\u4e8e\u4e0d\u540c\u540d\u5b57\u7a7a\u95f4\uff0c\u5219\u5c5e\u4e3b\u5f15\u7528\u88ab\u89c6\u4e3a\u4e0d\u5b58\u5728\uff0c\u800c\u5f53\u68c0\u67e5\u53d1\u73b0\u6240\u6709\u5c5e\u4e3b\u90fd\u5df2\u4e0d\u5b58\u5728\u65f6\uff0c\u4f9d\u8d56\u5bf9\u8c61\u4f1a\u88ab\u5220\u9664 \u96c6\u7fa4\u4f5c\u7528\u57df\u7684\u4f9d\u8d56\u5bf9\u8c61\u53ea\u80fd\u6307\u5b9a\u96c6\u7fa4\u4f5c\u7528\u57df\u7684\u5c5e\u4e3b\u3002\u5728 1.20 \u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u5982\u679c\u4e00\u4e2a\u96c6\u7fa4\u4f5c\u7528\u57df\u7684\u4f9d\u8d56\u5bf9\u8c61\u6307\u5b9a\u4e86\u67d0\u4e2a\u540d\u5b57\u7a7a\u95f4\u4f5c\u7528\u57df\u7684\u7c7b\u522b\u4f5c\u4e3a\u5176\u5c5e\u4e3b\uff0c\u5219\u8be5\u5bf9\u8c61\u88ab\u89c6\u4e3a\u62e5\u6709\u4e00\u4e2a\u65e0\u6cd5\u89e3\u6790\u7684\u5c5e\u4e3b\u5f15\u7528\uff0c\u56e0\u800c\u65e0\u6cd5\u88ab\u5783\u573e\u6536\u96c6\u5904\u7406 \u5728 1.20 \u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u5982\u679c\u5783\u573e\u6536\u96c6\u5668\u68c0\u6d4b\u5230\u975e\u6cd5\u7684\u8de8\u540d\u5b57\u7a7a\u95f4 ownerReference \uff0c\u6216\u8005\u67d0\u96c6\u7fa4\u4f5c\u7528\u57df\u7684\u4f9d\u8d56\u5bf9\u8c61\u7684 ownerReference \u5f15\u7528\u67d0\u540d\u5b57\u7a7a\u95f4\u4f5c\u7528\u57df\u7684\u7c7b\u522b\uff0c\u7cfb\u7edf\u4f1a\u751f\u6210\u4e00\u4e2a\u8b66\u544a\u4e8b\u4ef6\uff0c\u5176\u539f\u56e0\u4e3a OwnerRefInvalidNamespace \uff0c involvedObject \u8bbe\u7f6e\u4e3a\u975e\u6cd5\u7684\u4f9d\u8d56\u5bf9\u8c61\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c kubectl get events -A --field-selector=reason=OwnerRefInvalidNamespace \u6765\u68c0\u67e5\u662f\u5426\u5b58\u5728\u8fd9\u7c7b\u4e8b\u4ef6","title":"\u5c5e\u4e3b\u4e0e\u4f9d\u8d56"},{"location":"Chapter02/chapter02-06/#cascading-deletion","text":"Kubernetes \u4f1a\u68c0\u67e5\u5e76\u5220\u9664\u90a3\u4e9b\u4e0d\u518d\u62e5\u6709\u5c5e\u4e3b\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u4f8b\u5982\u5728\u4f60\u5220\u9664\u4e86 ReplicaSet\u4e4b\u540e\u7559\u4e0b\u6765\u7684 Pod\u3002\u5f53\u4f60\u5220\u9664\u67d0\u4e2a\u5bf9\u8c61\u65f6\uff0c\u4f60\u53ef\u4ee5\u63a7\u5236 Kubernetes \u662f\u5426\u53bb\u81ea\u52a8\u5220\u9664\u8be5\u5bf9\u8c61\u7684\u4f9d\u8d56\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a \u7ea7\u8054\u5220\u9664\uff08Cascading Deletion\uff09 \u3002\u7ea7\u8054\u5220\u9664\u6709\u4e24\u79cd\u7c7b\u578b\uff0c\u5206\u522b\u5982\u4e0b\uff1a \u524d\u53f0\u7ea7\u8054\u5220\u9664 \u540e\u53f0\u7ea7\u8054\u5220\u9664 \u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 Kubernetes Finalizers \u6765\u63a7\u5236\u5783\u573e\u6536\u96c6\u673a\u5236\u5982\u4f55\u4ee5\u53ca\u4f55\u65f6\u5220\u9664\u5305\u542b\u5c5e\u4e3b\u5f15\u7528\u7684\u8d44\u6e90","title":"\u7ea7\u8054\u5220\u9664"},{"location":"Chapter02/chapter02-06/#foreground-deletion","text":"\u5728\u524d\u53f0\u7ea7\u8054\u5220\u9664\u4e2d\uff0c\u6b63\u5728\u88ab\u4f60\u5220\u9664\u7684\u5c5e\u4e3b\u5bf9\u8c61\u9996\u5148\u8fdb\u5165 deletion in progress \u72b6\u6001\u3002\u5728\u8fd9\u79cd\u72b6\u6001\u4e0b\uff0c\u9488\u5bf9\u5c5e\u4e3b\u5bf9\u8c61\u4f1a\u53d1\u751f\u4ee5\u4e0b\u4e8b\u60c5\uff1a Kubernetes API \u670d\u52a1\u5668\u5c06\u5bf9\u8c61\u7684 metadata.deletionTimestamp \u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u5bf9\u8c61\u88ab\u6807\u8bb0\u4e3a\u8981\u5220\u9664\u7684\u65f6\u95f4\u70b9 Kubernetes API \u670d\u52a1\u5668\u4e5f\u4f1a\u5c06 metadata.finalizers \u5b57\u6bb5\u8bbe\u7f6e\u4e3a foregroundDeletion \u5728\u5220\u9664\u8fc7\u7a0b\u5b8c\u6210\u4e4b\u524d\uff0c\u901a\u8fc7 Kubernetes API \u4ecd\u7136\u53ef\u4ee5\u770b\u5230\u8be5\u5bf9\u8c61 \u5f53\u5c5e\u4e3b\u5bf9\u8c61\u8fdb\u5165\u5220\u9664\u8fc7\u7a0b\u4e2d\u72b6\u6001\u540e\uff0c\u63a7\u5236\u5668\u5220\u9664\u5176\u4f9d\u8d56\u5bf9\u8c61\u3002\u63a7\u5236\u5668\u5728\u5220\u9664\u5b8c\u6240\u6709\u4f9d\u8d56\u5bf9\u8c61\u4e4b\u540e\uff0c\u5220\u9664\u5c5e\u4e3b\u5bf9\u8c61\u3002\u8fd9\u65f6\uff0c\u901a\u8fc7 Kubernetes API \u5c31\u65e0\u6cd5\u518d\u770b\u5230\u8be5\u5bf9\u8c61 \u5728\u524d\u53f0\u7ea7\u8054\u5220\u9664\u8fc7\u7a0b\u4e2d\uff0c\u552f\u4e00\u53ef\u80fd\u963b\u6b62\u5c5e\u4e3b\u5bf9\u8c61\u88ab\u5220\u9664\u7684\u662f\u90a3\u4e9b\u5e26\u6709 ownerReference.blockOwnerDeletion=true \u5b57\u6bb5\u7684\u4f9d\u8d56\u5bf9\u8c61\u3002\u53c2\u9605 \u4f7f\u7528\u524d\u53f0\u7ea7\u8054\u5220\u9664 \u4ee5\u4e86\u89e3\u8fdb\u4e00\u6b65\u7684\u7ec6\u8282","title":"\u524d\u53f0\u7ea7\u8054\u5220\u9664"},{"location":"Chapter02/chapter02-06/#background-deletion","text":"\u5728\u540e\u53f0\u7ea7\u8054\u5220\u9664\u8fc7\u7a0b\u4e2d\uff0cKubernetes \u670d\u52a1\u5668\u7acb\u5373\u5220\u9664\u5c5e\u4e3b\u5bf9\u8c61\uff0c\u63a7\u5236\u5668\u5728\u540e\u53f0\u6e05\u7406\u6240\u6709\u4f9d\u8d56\u5bf9\u8c61\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cKubernetes \u4f7f\u7528\u540e\u53f0\u7ea7\u8054\u5220\u9664\u65b9\u6848\uff0c\u9664\u975e\u4f60\u624b\u52a8\u8bbe\u7f6e\u4e86\u8981\u4f7f\u7528\u524d\u53f0\u5220\u9664\uff0c\u6216\u8005\u9009\u62e9\u9057\u5f03\u4f9d\u8d56\u5bf9\u8c61 \u53c2\u9605 \u4f7f\u7528\u540e\u53f0\u7ea7\u8054\u5220\u9664 \u4ee5\u4e86\u89e3\u8fdb\u4e00\u6b65\u7684\u7ec6\u8282","title":"\u540e\u53f0\u7ea7\u8054\u5220\u9664"},{"location":"Chapter02/chapter02-06/#orphaned-dependents","text":"\u5f53 Kubernetes \u5220\u9664\u67d0\u4e2a\u5c5e\u4e3b\u5bf9\u8c61\u65f6\uff0c\u88ab\u7559\u4e0b\u6765\u7684\u4f9d\u8d56\u5bf9\u8c61\u88ab\u79f0\u4f5c\u88ab\u9057\u5f03\u7684\uff08Orphaned\uff09\u5bf9\u8c61\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cKubernetes \u4f1a\u5220\u9664\u4f9d\u8d56\u5bf9\u8c61\u3002\u8981\u4e86\u89e3\u5982\u4f55\u91cd\u8f7d\u8fd9\u79cd\u9ed8\u8ba4\u884c\u4e3a\uff0c\u53ef\u53c2\u9605 \u5220\u9664\u5c5e\u4e3b\u5bf9\u8c61\u548c\u9057\u5f03\u4f9d\u8d56\u5bf9\u8c61","title":"\u88ab\u9057\u5f03\u7684\u4f9d\u8d56\u5bf9\u8c61"},{"location":"Chapter02/chapter02-06/#containers-images","text":"kubelet \u4f1a\u6bcf\u4e94\u5206\u949f\u5bf9\u672a\u4f7f\u7528\u7684\u955c\u50cf\u6267\u884c\u4e00\u6b21\u5783\u573e\u6536\u96c6\uff0c\u6bcf\u5206\u949f\u5bf9\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u6267\u884c\u4e00\u6b21\u5783\u573e\u6536\u96c6\u3002\u4f60\u5e94\u8be5\u907f\u514d\u4f7f\u7528\u5916\u90e8\u7684\u5783\u573e\u6536\u96c6\u5de5\u5177\uff0c\u56e0\u4e3a\u5916\u90e8\u5de5\u5177\u53ef\u80fd\u4f1a\u7834\u574f kubelet \u7684\u884c\u4e3a\uff0c\u79fb\u9664\u5e94\u8be5\u4fdd\u7559\u7684\u5bb9\u5668 \u8981\u914d\u7f6e\u5bf9\u672a\u4f7f\u7528\u5bb9\u5668\u548c\u955c\u50cf\u7684\u5783\u573e\u6536\u96c6\u9009\u9879\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a \u914d\u7f6e\u6587\u4ef6 \uff0c\u57fa\u4e8e KubeletConfiguration \u8d44\u6e90\u7c7b\u578b\u6765\u8c03\u6574\u4e0e\u5783\u573e\u6536\u96c6\u76f8\u5173\u7684 kubelet \u884c\u4e3a","title":"\u672a\u4f7f\u7528\u5bb9\u5668\u548c\u955c\u50cf\u7684\u5783\u573e\u6536\u96c6"},{"location":"Chapter02/chapter02-06/#container-image-lifecycle","text":"Kubernetes \u901a\u8fc7\u5176\u955c\u50cf\u7ba1\u7406\u5668\uff08Image Manager\uff09\u6765\u7ba1\u7406\u6240\u6709\u955c\u50cf\u7684\u751f\u547d\u5468\u671f\uff0c\u8be5\u7ba1\u7406\u5668\u662f kubelet \u7684\u4e00\u90e8\u5206\uff0c\u5de5\u4f5c\u65f6\u4e0e cadvisor \u534f\u540c\u3002kubelet \u5728\u4f5c\u51fa\u5783\u573e\u6536\u96c6\u51b3\u5b9a\u65f6\u4f1a\u8003\u8651\u5982\u4e0b\u78c1\u76d8\u7528\u91cf\u7ea6\u675f\uff1a HighThresholdPercent LowThresholdPercent \u78c1\u76d8\u7528\u91cf\u8d85\u51fa\u6240\u914d\u7f6e\u7684 HighThresholdPercent \u503c\u65f6\u4f1a\u89e6\u53d1\u5783\u573e\u6536\u96c6\uff0c\u5783\u573e\u6536\u96c6\u5668\u4f1a\u57fa\u4e8e\u955c\u50cf\u4e0a\u6b21\u88ab\u4f7f\u7528\u7684\u65f6\u95f4\u6765\u6309\u987a\u5e8f\u5220\u9664\u5b83\u4eec\uff0c\u9996\u5148\u5220\u9664\u7684\u662f\u6700\u8fd1\u672a\u4f7f\u7528\u7684\u955c\u50cf\u3002kubelet \u4f1a\u6301\u7eed\u5220\u9664\u955c\u50cf\uff0c\u76f4\u5230\u78c1\u76d8\u7528\u91cf\u5230\u8fbe LowThresholdPercent \u503c\u4e3a\u6b62","title":"\u5bb9\u5668\u955c\u50cf\u751f\u547d\u5468\u671f"},{"location":"Chapter02/chapter02-06/#container-image-garbage-collection","text":"kubelet \u4f1a\u57fa\u4e8e\u5982\u4e0b\u53d8\u91cf\u5bf9\u6240\u6709\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u6267\u884c\u5783\u573e\u6536\u96c6\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u53d8\u91cf\u90fd\u662f\u4f60\u53ef\u4ee5\u5b9a\u4e49\u7684\uff1a MinAge \uff1akubelet \u53ef\u4ee5\u5783\u573e\u56de\u6536\u67d0\u4e2a\u5bb9\u5668\u65f6\u8be5\u5bb9\u5668\u7684\u6700\u5c0f\u5e74\u9f84\u3002\u8bbe\u7f6e\u4e3a 0 \u8868\u793a\u7981\u6b62\u4f7f\u7528\u6b64\u89c4\u5219 MaxPerPodContainer \uff1a\u6bcf\u4e2a Pod \u53ef\u4ee5\u5305\u542b\u7684\u5df2\u6b7b\u4ea1\u7684\u5bb9\u5668\u4e2a\u6570\u4e0a\u9650\u3002\u8bbe\u7f6e\u4e3a\u5c0f\u4e8e 0 \u7684\u503c\u8868\u793a\u7981\u6b62\u4f7f\u7528\u6b64\u89c4\u5219 MaxContainers \uff1a\u96c6\u7fa4\u4e2d\u53ef\u4ee5\u5b58\u5728\u7684\u5df2\u6b7b\u4ea1\u7684\u5bb9\u5668\u4e2a\u6570\u4e0a\u9650\u3002\u8bbe\u7f6e\u4e3a\u5c0f\u4e8e 0 \u7684\u503c\u610f\u5473\u7740\u7981\u6b62\u5e94\u7528\u6b64\u89c4\u5219 \u9664\u4ee5\u4e0a\u53d8\u91cf\u4e4b\u5916\uff0ckubelet \u8fd8\u4f1a\u5783\u573e\u6536\u96c6\u9664\u65e0\u6807\u8bc6\u7684\u4ee5\u53ca\u5df2\u5220\u9664\u7684\u5bb9\u5668\uff0c\u901a\u5e38\u4ece\u6700\u8fd1\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u5f00\u59cb \u5f53\u4fdd\u6301\u6bcf\u4e2a Pod \u7684\u6700\u5927\u6570\u91cf\u7684\u5bb9\u5668\uff08 MaxPerPodContainer \uff09\u4f1a\u4f7f\u5f97\u5168\u5c40\u7684\u5df2\u6b7b\u4ea1\u5bb9\u5668\u4e2a\u6570\u8d85\u51fa\u4e0a\u9650 \uff08 MaxContainers \uff09\u65f6\uff0c MaxPerPodContainers \u548c MaxContainers \u4e4b\u95f4\u53ef\u80fd\u4f1a\u51fa\u73b0\u51b2\u7a81\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0ckubelet \u4f1a\u8c03\u6574 MaxPerPodContainer \u6765\u89e3\u51b3\u8fd9\u4e00\u51b2\u7a81\u3002\u6700\u574f\u7684\u60c5\u5f62\u662f\u5c06 MaxPerPodContainer \u964d\u683c\u4e3a 1 \uff0c\u5e76\u9a71\u9010\u6700\u8fd1\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u3002\u6b64\u5916\uff0c\u5f53\u96b6\u5c5e\u4e8e\u67d0\u5df2\u88ab\u5220\u9664\u7684 Pod \u7684\u5bb9\u5668\u7684\u5e74\u9f84\u8d85\u8fc7 MinAge \u65f6\uff0c\u5b83\u4eec\u4e5f\u4f1a\u88ab\u5220\u9664 \u8bf4\u660e\uff1a kubelet \u4ec5\u4f1a\u56de\u6536\u7531\u5b83\u6240\u7ba1\u7406\u7684\u5bb9\u5668","title":"\u5bb9\u5668\u5783\u573e\u6536\u96c6"},{"location":"Chapter02/chapter02-06/#configuring-gc","text":"\u4f60\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7279\u5b9a\u4e8e\u7ba1\u7406\u8d44\u6e90\u7684\u63a7\u5236\u5668\u6765\u8c03\u6574\u8d44\u6e90\u7684\u5783\u573e\u6536\u96c6\u884c\u4e3a\u3002\u4e0b\u9762\u7684\u9875\u9762\u4e3a\u4f60\u5c55\u793a\u5982\u4f55\u914d\u7f6e\u5783\u573e\u6536\u96c6\uff1a \u914d\u7f6e Kubernetes \u5bf9\u8c61\u7684\u7ea7\u8054\u5220\u9664 \u914d\u7f6e\u5df2\u5b8c\u6210 Job \u7684\u6e05\u7406","title":"\u914d\u7f6e\u5783\u573e\u6536\u96c6"},{"location":"Chapter02/chapter02-07/","text":"Kubernetes \u67b6\u6784 - \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\uff08CRI\uff09 \u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\uff08CRI\uff09 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 5E58C40 CRI \u662f\u4e00\u4e2a\u63d2\u4ef6\u63a5\u53e3\uff0c\u5b83\u4f7f kubelet \u80fd\u591f\u4f7f\u7528\u5404\u79cd\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u65e0\u9700\u91cd\u65b0\u7f16\u8bd1\u96c6\u7fa4\u7ec4\u4ef6 \u4f60\u9700\u8981\u5728\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u4e0a\u90fd\u6709\u4e00\u4e2a\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c \u8fd9\u6837 kubelet \u80fd\u542f\u52a8 Pod \u53ca\u5176\u5bb9\u5668 \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\uff08CRI\uff09\u662f kubelet \u548c\u5bb9\u5668\u8fd0\u884c\u65f6\u4e4b\u95f4\u901a\u4fe1\u7684\u4e3b\u8981\u534f\u8bae Kubernetes \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\uff08Container Runtime Interface\uff1bCRI\uff09\u5b9a\u4e49\u4e86\u4e3b\u8981 gRPC \u534f\u8bae\uff0c\u7528\u4e8e \u96c6\u7fa4\u7ec4\u4ef6 kubelet \u548c\u5bb9\u5668\u8fd0\u884c\u65f6 API \u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.23 [stable] \u5f53\u901a\u8fc7 gRPC \u8fde\u63a5\u5230\u5bb9\u5668\u8fd0\u884c\u65f6\u65f6\uff0ckubelet \u5145\u5f53\u5ba2\u6237\u7aef\u3002\u8fd0\u884c\u65f6\u548c\u955c\u50cf\u670d\u52a1\u7aef\u70b9\u5fc5\u987b\u5728\u5bb9\u5668\u8fd0\u884c\u65f6\u4e2d\u53ef\u7528\uff0c\u53ef\u4ee5\u4f7f\u7528 \u547d\u4ee4\u884c\u6807\u5fd7 \u7684 --image-service-endpoint \u548c --container-runtime-endpoint \u5728 kubelet \u4e2d\u5355\u72ec\u914d\u7f6e \u5bf9 Kubernetes v1.25\uff0ckubelet \u504f\u5411\u4e8e\u4f7f\u7528 CRI v1 \u7248\u672c\u3002\u5982\u679c\u5bb9\u5668\u8fd0\u884c\u65f6\u4e0d\u652f\u6301 CRI \u7684 v1 \u7248\u672c\uff0c\u90a3\u4e48 kubelet \u4f1a\u5c1d\u8bd5\u534f\u5546\u4efb\u4f55\u65e7\u7684\u5176\u4ed6\u652f\u6301\u7248\u672c\u3002\u5982\u679c kubelet \u65e0\u6cd5\u534f\u5546\u652f\u6301\u7684 CRI \u7248\u672c\uff0c\u5219 kubelet \u653e\u5f03\u5e76\u4e14\u4e0d\u4f1a\u6ce8\u518c\u4e3a\u8282\u70b9 \u5347\u7ea7 \u5347\u7ea7 Kubernetes \u65f6\uff0ckubelet \u4f1a\u5c1d\u8bd5\u5728\u7ec4\u4ef6\u91cd\u542f\u65f6\u81ea\u52a8\u9009\u62e9\u6700\u65b0\u7684 CRI \u7248\u672c\u3002\u5982\u679c\u5931\u8d25\uff0c\u5219\u5c06\u5982\u4e0a\u6240\u8ff0\u8fdb\u884c\u56de\u9000\u3002\u5982\u679c\u7531\u4e8e\u5bb9\u5668\u8fd0\u884c\u65f6\u5df2\u5347\u7ea7\u800c\u9700\u8981 gRPC \u91cd\u62e8\uff0c\u5219\u5bb9\u5668\u8fd0\u884c\u65f6\u8fd8\u5fc5\u987b\u652f\u6301\u6700\u521d\u9009\u62e9\u7684\u7248\u672c\uff0c\u5426\u5219\u91cd\u62e8\u9884\u8ba1\u4f1a\u5931\u8d25\u3002\u8fd9\u9700\u8981\u91cd\u65b0\u542f\u52a8 kubelet","title":"Kubernetes \u67b6\u6784 - \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\uff08CRI\uff09"},{"location":"Chapter02/chapter02-07/#kubernetes-cri","text":"\u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 - \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\uff08CRI\uff09 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 5E58C40 CRI \u662f\u4e00\u4e2a\u63d2\u4ef6\u63a5\u53e3\uff0c\u5b83\u4f7f kubelet \u80fd\u591f\u4f7f\u7528\u5404\u79cd\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u65e0\u9700\u91cd\u65b0\u7f16\u8bd1\u96c6\u7fa4\u7ec4\u4ef6 \u4f60\u9700\u8981\u5728\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u4e0a\u90fd\u6709\u4e00\u4e2a\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c \u8fd9\u6837 kubelet \u80fd\u542f\u52a8 Pod \u53ca\u5176\u5bb9\u5668 \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\uff08CRI\uff09\u662f kubelet \u548c\u5bb9\u5668\u8fd0\u884c\u65f6\u4e4b\u95f4\u901a\u4fe1\u7684\u4e3b\u8981\u534f\u8bae Kubernetes \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\uff08Container Runtime Interface\uff1bCRI\uff09\u5b9a\u4e49\u4e86\u4e3b\u8981 gRPC \u534f\u8bae\uff0c\u7528\u4e8e \u96c6\u7fa4\u7ec4\u4ef6 kubelet \u548c\u5bb9\u5668\u8fd0\u884c\u65f6","title":"Kubernetes \u67b6\u6784 - \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\uff08CRI\uff09"},{"location":"Chapter02/chapter02-07/#api","text":"\u7279\u6027\u72b6\u6001\uff1a Kubernetes v1.23 [stable] \u5f53\u901a\u8fc7 gRPC \u8fde\u63a5\u5230\u5bb9\u5668\u8fd0\u884c\u65f6\u65f6\uff0ckubelet \u5145\u5f53\u5ba2\u6237\u7aef\u3002\u8fd0\u884c\u65f6\u548c\u955c\u50cf\u670d\u52a1\u7aef\u70b9\u5fc5\u987b\u5728\u5bb9\u5668\u8fd0\u884c\u65f6\u4e2d\u53ef\u7528\uff0c\u53ef\u4ee5\u4f7f\u7528 \u547d\u4ee4\u884c\u6807\u5fd7 \u7684 --image-service-endpoint \u548c --container-runtime-endpoint \u5728 kubelet \u4e2d\u5355\u72ec\u914d\u7f6e \u5bf9 Kubernetes v1.25\uff0ckubelet \u504f\u5411\u4e8e\u4f7f\u7528 CRI v1 \u7248\u672c\u3002\u5982\u679c\u5bb9\u5668\u8fd0\u884c\u65f6\u4e0d\u652f\u6301 CRI \u7684 v1 \u7248\u672c\uff0c\u90a3\u4e48 kubelet \u4f1a\u5c1d\u8bd5\u534f\u5546\u4efb\u4f55\u65e7\u7684\u5176\u4ed6\u652f\u6301\u7248\u672c\u3002\u5982\u679c kubelet \u65e0\u6cd5\u534f\u5546\u652f\u6301\u7684 CRI \u7248\u672c\uff0c\u5219 kubelet \u653e\u5f03\u5e76\u4e14\u4e0d\u4f1a\u6ce8\u518c\u4e3a\u8282\u70b9","title":"API"},{"location":"Chapter02/chapter02-07/#upgrading","text":"\u5347\u7ea7 Kubernetes \u65f6\uff0ckubelet \u4f1a\u5c1d\u8bd5\u5728\u7ec4\u4ef6\u91cd\u542f\u65f6\u81ea\u52a8\u9009\u62e9\u6700\u65b0\u7684 CRI \u7248\u672c\u3002\u5982\u679c\u5931\u8d25\uff0c\u5219\u5c06\u5982\u4e0a\u6240\u8ff0\u8fdb\u884c\u56de\u9000\u3002\u5982\u679c\u7531\u4e8e\u5bb9\u5668\u8fd0\u884c\u65f6\u5df2\u5347\u7ea7\u800c\u9700\u8981 gRPC \u91cd\u62e8\uff0c\u5219\u5bb9\u5668\u8fd0\u884c\u65f6\u8fd8\u5fc5\u987b\u652f\u6301\u6700\u521d\u9009\u62e9\u7684\u7248\u672c\uff0c\u5426\u5219\u91cd\u62e8\u9884\u8ba1\u4f1a\u5931\u8d25\u3002\u8fd9\u9700\u8981\u91cd\u65b0\u542f\u52a8 kubelet","title":"\u5347\u7ea7"},{"location":"Chapter02/chapter02/","text":"Kubernetes \u67b6\u6784 \u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 44CF6E6 \u8282\u70b9 \u8282\u70b9\u4e0e\u63a7\u5236\u9762\u4e4b\u95f4\u7684\u901a\u4fe1 \u63a7\u5236\u5668 \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 \u5173\u4e8e cgroup v2 \u5783\u573e\u6536\u96c6 \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\uff08CRI\uff09","title":"Kubernetes \u67b6\u6784"},{"location":"Chapter02/chapter02/#kubernetes","text":"\u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u67b6\u6784 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u672a\u6539\u52a8\u6587\u672c\u5185\u5bb9\uff08\u5220\u6389\u4e86 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 44CF6E6 \u8282\u70b9 \u8282\u70b9\u4e0e\u63a7\u5236\u9762\u4e4b\u95f4\u7684\u901a\u4fe1 \u63a7\u5236\u5668 \u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 \u5173\u4e8e cgroup v2 \u5783\u573e\u6536\u96c6 \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\uff08CRI\uff09","title":"Kubernetes \u67b6\u6784"},{"location":"Chapter03/chapter03/","text":"Kubernetes \u7ec4\u4ef6 \u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u7ec4\u4ef6 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u5bf9\u6587\u672c\u4e2d\u7684\u4e66\u5199\u9519\u8bef\u8fdb\u884c\u4e86\u4fee\u6539\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 9318636 \u5f53\u4f60\u90e8\u7f72\u5b8c Kubernetes\uff0c\u4fbf\u62e5\u6709\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684\u96c6\u7fa4 \u4e00\u7ec4\u5de5\u4f5c\u673a\u5668\uff0c\u79f0\u4e3a\u8282\u70b9\uff0c\u4f1a\u8fd0\u884c\u5bb9\u5668\u5316\u5e94\u7528\u7a0b\u5e8f\u3002\u6bcf\u4e2a\u96c6\u7fa4\u81f3\u5c11\u6709\u4e00\u4e2a\u5de5\u4f5c\u8282\u70b9 \u5de5\u4f5c\u8282\u70b9\u4f1a\u6258\u7ba1 Pod\uff0c\u800c Pod \u5c31\u662f\u4f5c\u4e3a\u5e94\u7528\u8d1f\u8f7d\u7684\u7ec4\u4ef6\u3002\u63a7\u5236\u5e73\u9762\u7ba1\u7406\u96c6\u7fa4\u4e2d\u7684\u5de5\u4f5c\u8282\u70b9\u548c Pod\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u63a7\u5236\u5e73\u9762\u901a\u5e38\u8de8\u591a\u53f0\u8ba1\u7b97\u673a\u8fd0\u884c\uff0c\u4e00\u4e2a\u96c6\u7fa4\u901a\u5e38\u8fd0\u884c\u591a\u4e2a\u8282\u70b9\uff0c\u63d0\u4f9b\u5bb9\u9519\u6027\u548c\u9ad8\u53ef\u7528\u6027 \u672c\u6587\u6863\u6982\u8ff0\u4e86\u4e00\u4e2a\u6b63\u5e38\u8fd0\u884c\u7684 Kubernetes \u96c6\u7fa4\u6240\u9700\u7684\u5404\u79cd\u7ec4\u4ef6 \u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff08Control Plane Components\uff09 \u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\u4f1a\u4e3a\u96c6\u7fa4\u505a\u51fa\u5168\u5c40\u51b3\u7b56\uff0c\u6bd4\u5982\u8d44\u6e90\u7684\u8c03\u5ea6\u3002\u4ee5\u53ca\u68c0\u6d4b\u548c\u54cd\u5e94\u96c6\u7fa4\u4e8b\u4ef6\uff0c\u4f8b\u5982\u5f53\u4e0d\u6ee1\u8db3\u90e8\u7f72\u7684 replicas \u5b57\u6bb5\u65f6\uff0c\u8981\u542f\u52a8\u65b0\u7684 pod \u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\u53ef\u4ee5\u5728\u96c6\u7fa4\u4e2d\u7684\u4efb\u4f55\u8282\u70b9\u4e0a\u8fd0\u884c\u3002\u7136\u800c\uff0c\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u8bbe\u7f6e\u811a\u672c\u901a\u5e38\u4f1a\u5728\u540c\u4e00\u4e2a\u8ba1\u7b97\u673a\u4e0a\u542f\u52a8\u6240\u6709\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5728\u6b64\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u7528\u6237\u5bb9\u5668\u3002\u8bf7\u53c2\u9605 \u4f7f\u7528 kubeadm \u6784\u5efa\u9ad8\u53ef\u7528\u6027\u96c6\u7fa4 \u4e2d\u5173\u4e8e\u8de8\u591a\u673a\u5668\u63a7\u5236\u5e73\u9762\u8bbe\u7f6e\u7684\u793a\u4f8b kube-apiserver API \u670d\u52a1\u5668\u662f Kubernetes \u63a7\u5236\u5e73\u9762\u7684\u7ec4\u4ef6\uff0c\u8be5\u7ec4\u4ef6\u8d1f\u8d23\u516c\u5f00 Kubernetes API 1 \uff0c\u8d1f\u8d23\u5904\u7406\u63a5\u53d7\u8bf7\u6c42\u7684\u5de5\u4f5c\u3002API \u670d\u52a1\u5668\u662f Kubernetes \u63a7\u5236\u5e73\u9762\u7684\u524d\u7aef Kubernetes API \u670d\u52a1\u5668\u7684\u4e3b\u8981\u5b9e\u73b0\u662f kube-apiserver \u3002 kube-apiserver \u8bbe\u8ba1\u4e0a\u8003\u8651\u4e86\u6c34\u5e73\u6269\u7f29\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u53ef\u901a\u8fc7\u90e8\u7f72\u591a\u4e2a\u5b9e\u4f8b\u6765\u8fdb\u884c\u6269\u7f29\u3002\u4f60\u53ef\u4ee5\u8fd0\u884c kube-apiserver \u7684\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5e76\u5728\u8fd9\u4e9b\u5b9e\u4f8b\u4e4b\u95f4\u5e73\u8861\u6d41\u91cf etcd \u4e00\u81f4\u4e14\u9ad8\u5ea6\u53ef\u7528\u7684\u952e\u503c\u5b58\u50a8\uff0c\u7528\u4f5c Kubernetes \u7684\u6240\u6709\u96c6\u7fa4\u6570\u636e\u7684\u540e\u53f0\u6570\u636e\u5e93 \u5982\u679c\u4f60\u7684 Kubernetes \u96c6\u7fa4\u4f7f\u7528 etcd \u4f5c\u4e3a\u5176\u540e\u53f0\u6570\u636e\u5e93\uff0c\u8bf7\u786e\u4fdd\u4f60\u9488\u5bf9\u8fd9\u4e9b\u6570\u636e\u6709\u4e00\u4efd \u5907\u4efd \u8ba1\u5212 \u4f60\u53ef\u4ee5\u5728\u5b98\u65b9 \u6587\u6863 \u4e2d\u627e\u5230\u6709\u5173 etcd \u7684\u6df1\u5165\u77e5\u8bc6 kube-scheduler kube-scheduler \u662f\u63a7\u5236\u5e73\u9762\u7684\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u76d1\u89c6\u65b0\u521b\u5efa\u7684\u3001\u672a\u6307\u5b9a\u8fd0\u884c\u8282\u70b9\uff08node\uff09\u7684 Pods\uff0c\u5e76\u9009\u62e9\u8282\u70b9\u6765\u8ba9 Pod \u5728\u4e0a\u9762\u8fd0\u884c \u8c03\u5ea6\u51b3\u7b56\u8003\u8651\u7684\u56e0\u7d20\u5305\u62ec\u5355\u4e2a Pod \u53ca Pods \u96c6\u5408\u7684\u8d44\u6e90\u9700\u6c42\u3001\u8f6f\u786c\u4ef6\u53ca\u7b56\u7565\u7ea6\u675f\u3001\u4eb2\u548c\u6027\u53ca\u53cd\u4eb2\u548c\u6027\u89c4\u8303\u3001\u6570\u636e\u4f4d\u7f6e\u3001\u5de5\u4f5c\u8d1f\u8f7d\u95f4\u7684\u5e72\u6270\u53ca\u6700\u540e\u65f6\u9650 kube-controller-manager kube-controller-manager \u662f\u63a7\u5236\u5e73\u9762\u7684\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u8fd0\u884c\u63a7\u5236\u5668\u8fdb\u7a0b \u4ece\u903b\u8f91\u4e0a\u8bb2\uff0c\u6bcf\u4e2a\u63a7\u5236\u5668\u90fd\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b\uff0c\u4f46\u662f\u4e3a\u4e86\u964d\u4f4e\u590d\u6742\u6027\uff0c\u5b83\u4eec\u90fd\u88ab\u7f16\u8bd1\u5230\u540c\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u8fd0\u884c \u8fd9\u4e9b\u63a7\u5236\u5668\u5305\u62ec\uff1a \u8282\u70b9\u63a7\u5236\u5668\uff08Node Controller\uff09\uff1a\u8d1f\u8d23\u5728\u8282\u70b9\u51fa\u73b0\u6545\u969c\u65f6\u8fdb\u884c\u901a\u77e5\u548c\u54cd\u5e94 \u4efb\u52a1\u63a7\u5236\u5668\uff08Job Controller\uff09\uff1a\u76d1\u6d4b\u4ee3\u8868\u4e00\u6b21\u6027\u4efb\u52a1\u7684 Job \u5bf9\u8c61\uff0c\u7136\u540e\u521b\u5efa Pods \u6765\u8fd0\u884c\u8fd9\u4e9b\u4efb\u52a1\u76f4\u81f3\u5b8c\u6210 \u7aef\u70b9\u63a7\u5236\u5668\uff08Endpoints Controller\uff09\uff1a\u586b\u5145\u7aef\u70b9\uff08Endpoints\uff09\u5bf9\u8c61\uff08\u5373\u52a0\u5165 Service \u4e0e Pod\uff09 \u670d\u52a1\u5e10\u6237\u548c\u4ee4\u724c\u63a7\u5236\u5668\uff08Service Account & Token Controllers\uff09\uff1a\u4e3a\u65b0\u7684\u547d\u540d\u7a7a\u95f4\u521b\u5efa\u9ed8\u8ba4\u5e10\u6237\u548c API \u8bbf\u95ee\u4ee4\u724c cloud-controller-manager \u4e00\u4e2a Kubernetes \u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff0c\u5d4c\u5165\u4e86\u7279\u5b9a\u4e8e\u4e91\u5e73\u53f0\u7684\u63a7\u5236\u903b\u8f91\u3002\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\uff08Cloud Controller Manager\uff09\u5141\u8bb8\u4f60\u5c06\u4f60\u7684\u96c6\u7fa4\u8fde\u63a5\u5230\u4e91\u63d0\u4f9b\u5546\u7684 API \u4e4b\u4e0a\uff0c\u5e76\u5c06\u4e0e\u8be5\u4e91\u5e73\u53f0\u4ea4\u4e92\u7684\u7ec4\u4ef6\u540c\u4e0e\u4f60\u7684\u96c6\u7fa4\u4ea4\u4e92\u7684\u7ec4\u4ef6\u5206\u79bb\u5f00\u6765 cloud-controller-manager \u4ec5\u8fd0\u884c\u7279\u5b9a\u4e8e\u4e91\u5e73\u53f0\u7684\u63a7\u5236\u5668\u3002\u56e0\u6b64\u5982\u679c\u4f60\u5728\u81ea\u5df1\u7684\u73af\u5883\u4e2d\u8fd0\u884c Kubernetes\uff0c\u6216\u8005\u5728\u672c\u5730\u8ba1\u7b97\u673a\u4e2d\u8fd0\u884c\u5b66\u4e60\u73af\u5883\uff0c\u6240\u90e8\u7f72\u7684\u96c6\u7fa4\u4e0d\u9700\u8981\u6709\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 \u4e0e kube-controller-manager \u7c7b\u4f3c\uff0c cloud-controller-manager \u5c06\u82e5\u5e72\u903b\u8f91\u4e0a\u72ec\u7acb\u7684\u63a7\u5236\u56de\u8def\u7ec4\u5408\u5230\u540c\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\uff0c\u4f9b\u4f60\u4ee5\u540c\u4e00\u8fdb\u7a0b\u7684\u65b9\u5f0f\u8fd0\u884c\u3002\u4f60\u53ef\u4ee5\u5bf9\u5176\u6267\u884c\u6c34\u5e73\u6269\u5bb9\uff08\u8fd0\u884c\u4e0d\u6b62\u4e00\u4e2a\u526f\u672c\uff09\u4ee5\u63d0\u5347\u6027\u80fd\u6216\u8005\u589e\u5f3a\u5bb9\u9519\u80fd\u529b \u4e0b\u9762\u7684\u63a7\u5236\u5668\u90fd\u5305\u542b\u5bf9\u4e91\u5e73\u53f0\u9a71\u52a8\u7684\u4f9d\u8d56\uff1a \u8282\u70b9\u63a7\u5236\u5668\uff08Node Controller\uff09\uff1a\u7528\u4e8e\u5728\u8282\u70b9\u7ec8\u6b62\u54cd\u5e94\u540e\u68c0\u67e5\u4e91\u63d0\u4f9b\u5546\u4ee5\u786e\u5b9a\u8282\u70b9\u662f\u5426\u5df2\u88ab\u5220\u9664 \u8def\u7531\u63a7\u5236\u5668\uff08Route Controller\uff09\uff1a\u7528\u4e8e\u5728\u5e95\u5c42\u4e91\u57fa\u7840\u67b6\u6784\u4e2d\u8bbe\u7f6e\u8def\u7531 \u670d\u52a1\u63a7\u5236\u5668\uff08Service Controller\uff09\uff1a\u7528\u4e8e\u521b\u5efa\u3001\u66f4\u65b0\u548c\u5220\u9664\u4e91\u63d0\u4f9b\u5546\u8d1f\u8f7d\u5747\u8861\u5668 Node \u7ec4\u4ef6 \u8282\u70b9\u7ec4\u4ef6\u4f1a\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u8d1f\u8d23\u7ef4\u62a4\u8fd0\u884c\u7684 Pod \u5e76\u63d0\u4f9b Kubernetes \u8fd0\u884c\u73af\u5883 kubelet kubelet \u4f1a\u5728\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\uff08node\uff09\u4e0a\u8fd0\u884c\u3002\u5b83\u4fdd\u8bc1\u5bb9\u5668\uff08containers\uff09\u90fd\u8fd0\u884c\u5728 Pod \u4e2d kubelet \u63a5\u6536\u4e00\u7ec4\u901a\u8fc7\u5404\u7c7b\u673a\u5236\u63d0\u4f9b\u7ed9\u5b83\u7684 PodSpecs\uff0c\u786e\u4fdd\u8fd9\u4e9b PodSpecs \u4e2d\u63cf\u8ff0\u7684\u5bb9\u5668\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u4e14\u5065\u5eb7\u3002kubelet \u4e0d\u4f1a\u7ba1\u7406\u4e0d\u662f\u7531 Kubernetes \u521b\u5efa\u7684\u5bb9\u5668 kube-proxy kube-proxy \u662f\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\uff08node\uff09\u6240\u4e0a\u8fd0\u884c\u7684\u7f51\u7edc\u4ee3\u7406\uff0c\u5b9e\u73b0 Kubernetes \u670d\u52a1\uff08Service\uff09\u6982\u5ff5\u7684\u4e00\u90e8\u5206 kube-proxy \u7ef4\u62a4\u8282\u70b9\u4e0a\u7684\u4e00\u4e9b\u7f51\u7edc\u89c4\u5219\uff0c\u8fd9\u4e9b\u7f51\u7edc\u89c4\u5219\u4f1a\u5141\u8bb8\u4ece\u96c6\u7fa4\u5185\u90e8\u6216\u5916\u90e8\u7684\u7f51\u7edc\u4f1a\u8bdd\u4e0e Pod \u8fdb\u884c\u7f51\u7edc\u901a\u4fe1 \u5982\u679c\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e86\u53ef\u7528\u7684\u6570\u636e\u5305\u8fc7\u6ee4\u5c42\uff0c\u5219 kube-proxy \u4f1a\u901a\u8fc7\u5b83\u6765\u5b9e\u73b0\u7f51\u7edc\u89c4\u5219\u3002\u5426\u5219\uff0ckube-proxy \u4ec5\u505a\u6d41\u91cf\u8f6c\u53d1 \u5bb9\u5668\u8fd0\u884c\u65f6\uff08Container Runtime\uff09 \u5bb9\u5668\u8fd0\u884c\u73af\u5883\u662f\u8d1f\u8d23\u8fd0\u884c\u5bb9\u5668\u7684\u8f6f\u4ef6 Kubernetes \u652f\u6301\u8bb8\u591a\u5bb9\u5668\u8fd0\u884c\u73af\u5883\uff0c\u4f8b\u5982 containerd\u3001CRI-O \u4ee5\u53ca Kubernetes CRI (\u5bb9\u5668\u8fd0\u884c\u73af\u5883\u63a5\u53e3) \u7684\u5176\u4ed6\u4efb\u4f55\u5b9e\u73b0 \u63d2\u4ef6\uff08Addons\uff09 \u63d2\u4ef6\u4f7f\u7528 Kubernetes \u8d44\u6e90\uff08DaemonSet\u3001 Deployment \u7b49\uff09\u5b9e\u73b0\u96c6\u7fa4\u529f\u80fd\u3002\u56e0\u4e3a\u8fd9\u4e9b\u63d2\u4ef6\u63d0\u4f9b\u96c6\u7fa4\u7ea7\u522b\u7684\u529f\u80fd\uff0c\u63d2\u4ef6\u4e2d\u547d\u540d\u7a7a\u95f4\u57df\u7684\u8d44\u6e90\u5c5e\u4e8e kube-system \u547d\u540d\u7a7a\u95f4 \u4e0b\u9762\u63cf\u8ff0\u4f17\u591a\u63d2\u4ef6\u4e2d\u7684\u51e0\u79cd\u3002\u6709\u5173\u53ef\u7528\u63d2\u4ef6\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u89c1 \u63d2\u4ef6\uff08Addons\uff09 DNS \u5c3d\u7ba1\u5176\u4ed6\u63d2\u4ef6\u90fd\u5e76\u975e\u4e25\u683c\u610f\u4e49\u4e0a\u7684\u5fc5\u9700\u7ec4\u4ef6\uff0c\u4f46\u51e0\u4e4e\u6240\u6709 Kubernetes \u96c6\u7fa4\u90fd\u5e94\u8be5\u6709 \u96c6\u7fa4 DNS \uff0c\u56e0\u4e3a\u5f88\u591a\u793a\u4f8b\u90fd\u9700\u8981 DNS \u670d\u52a1 \u96c6\u7fa4 DNS \u662f\u4e00\u4e2a DNS \u670d\u52a1\u5668\uff0c\u548c\u73af\u5883\u4e2d\u7684\u5176\u4ed6 DNS \u670d\u52a1\u5668\u4e00\u8d77\u5de5\u4f5c\uff0c\u5b83\u4e3a Kubernetes \u670d\u52a1\u63d0\u4f9b DNS \u8bb0\u5f55 Kubernetes \u542f\u52a8\u7684\u5bb9\u5668\u81ea\u52a8\u5c06\u6b64 DNS \u670d\u52a1\u5668\u5305\u542b\u5728\u5176 DNS \u641c\u7d22\u5217\u8868\u4e2d Web \u754c\u9762\uff08\u4eea\u8868\u76d8\uff09 Dashboard \u662f Kubernetes \u96c6\u7fa4\u7684\u901a\u7528\u7684\u3001\u57fa\u4e8e Web \u7684\u7528\u6237\u754c\u9762\u3002\u5b83\u4f7f\u7528\u6237\u53ef\u4ee5\u7ba1\u7406\u96c6\u7fa4\u4e2d\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u4ee5\u53ca\u96c6\u7fa4\u672c\u8eab\uff0c\u5e76\u8fdb\u884c\u6545\u969c\u6392\u9664 \u5bb9\u5668\u8d44\u6e90\u76d1\u63a7 \u5bb9\u5668\u8d44\u6e90\u76d1\u63a7 \u5c06\u5173\u4e8e\u5bb9\u5668\u7684\u4e00\u4e9b\u5e38\u89c1\u7684\u65f6\u95f4\u5e8f\u5217\u5ea6\u91cf\u503c\u4fdd\u5b58\u5230\u4e00\u4e2a\u96c6\u4e2d\u7684\u6570\u636e\u5e93\u4e2d\uff0c\u5e76\u63d0\u4f9b\u6d4f\u89c8\u8fd9\u4e9b\u6570\u636e\u7684\u754c\u9762 \u96c6\u7fa4\u5c42\u9762\u65e5\u5fd7 \u96c6\u7fa4\u5c42\u9762\u65e5\u5fd7 \u673a\u5236\u8d1f\u8d23\u5c06\u5bb9\u5668\u7684\u65e5\u5fd7\u6570\u636e\u4fdd\u5b58\u5230\u4e00\u4e2a\u96c6\u4e2d\u7684\u65e5\u5fd7\u5b58\u50a8\u4e2d\uff0c\u8fd9\u79cd\u96c6\u4e2d\u65e5\u5fd7\u5b58\u50a8\u63d0\u4f9b\u641c\u7d22\u548c\u6d4f\u89c8\u63a5\u53e3 \u539f\u6587\u63cf\u8ff0\u201c\u8be5\u7ec4\u4ef6\u8d1f\u8d23\u516c\u5f00\u4e86 Kubernetes API\u201d \u4fee\u6539\u4e3a \u201c\u8be5\u7ec4\u4ef6\u8d1f\u8d23\u516c\u5f00 \u4e86 Kubernetes API\u201d \u21a9","title":"Kubernetes \u7ec4\u4ef6"},{"location":"Chapter03/chapter03/#kubernetes","text":"\u7ae0\u8282\u8bf4\u660e \u672c\u6587\u5bf9\u5b98\u65b9\u6587\u6863 Kubernetes \u7ec4\u4ef6 \u9875\u9762\u8fdb\u884c\u4e86\u6392\u7248\u4fee\u6539\uff0c\u5e76\u5bf9\u6587\u672c\u4e2d\u7684\u4e66\u5199\u9519\u8bef\u8fdb\u884c\u4e86\u4fee\u6539\uff08\u5220\u6389\u4e86 \u63a5\u4e0b\u6765 \u3001 \u53cd\u9988 \uff09\uff0c\u6392\u7248\u903b\u8f91\u53ef\u53c2\u8003 \u5982\u4f55\u8d21\u732e \u4e2d\u7684\u4e66\u5199\u5efa\u8bae\u3002\u5f53\u524d\u6458\u5f55\u7248\u672c\uff1a 9318636 \u5f53\u4f60\u90e8\u7f72\u5b8c Kubernetes\uff0c\u4fbf\u62e5\u6709\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684\u96c6\u7fa4 \u4e00\u7ec4\u5de5\u4f5c\u673a\u5668\uff0c\u79f0\u4e3a\u8282\u70b9\uff0c\u4f1a\u8fd0\u884c\u5bb9\u5668\u5316\u5e94\u7528\u7a0b\u5e8f\u3002\u6bcf\u4e2a\u96c6\u7fa4\u81f3\u5c11\u6709\u4e00\u4e2a\u5de5\u4f5c\u8282\u70b9 \u5de5\u4f5c\u8282\u70b9\u4f1a\u6258\u7ba1 Pod\uff0c\u800c Pod \u5c31\u662f\u4f5c\u4e3a\u5e94\u7528\u8d1f\u8f7d\u7684\u7ec4\u4ef6\u3002\u63a7\u5236\u5e73\u9762\u7ba1\u7406\u96c6\u7fa4\u4e2d\u7684\u5de5\u4f5c\u8282\u70b9\u548c Pod\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u63a7\u5236\u5e73\u9762\u901a\u5e38\u8de8\u591a\u53f0\u8ba1\u7b97\u673a\u8fd0\u884c\uff0c\u4e00\u4e2a\u96c6\u7fa4\u901a\u5e38\u8fd0\u884c\u591a\u4e2a\u8282\u70b9\uff0c\u63d0\u4f9b\u5bb9\u9519\u6027\u548c\u9ad8\u53ef\u7528\u6027 \u672c\u6587\u6863\u6982\u8ff0\u4e86\u4e00\u4e2a\u6b63\u5e38\u8fd0\u884c\u7684 Kubernetes \u96c6\u7fa4\u6240\u9700\u7684\u5404\u79cd\u7ec4\u4ef6","title":"Kubernetes \u7ec4\u4ef6"},{"location":"Chapter03/chapter03/#control-plane-components","text":"\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\u4f1a\u4e3a\u96c6\u7fa4\u505a\u51fa\u5168\u5c40\u51b3\u7b56\uff0c\u6bd4\u5982\u8d44\u6e90\u7684\u8c03\u5ea6\u3002\u4ee5\u53ca\u68c0\u6d4b\u548c\u54cd\u5e94\u96c6\u7fa4\u4e8b\u4ef6\uff0c\u4f8b\u5982\u5f53\u4e0d\u6ee1\u8db3\u90e8\u7f72\u7684 replicas \u5b57\u6bb5\u65f6\uff0c\u8981\u542f\u52a8\u65b0\u7684 pod \u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\u53ef\u4ee5\u5728\u96c6\u7fa4\u4e2d\u7684\u4efb\u4f55\u8282\u70b9\u4e0a\u8fd0\u884c\u3002\u7136\u800c\uff0c\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u8bbe\u7f6e\u811a\u672c\u901a\u5e38\u4f1a\u5728\u540c\u4e00\u4e2a\u8ba1\u7b97\u673a\u4e0a\u542f\u52a8\u6240\u6709\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5728\u6b64\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u7528\u6237\u5bb9\u5668\u3002\u8bf7\u53c2\u9605 \u4f7f\u7528 kubeadm \u6784\u5efa\u9ad8\u53ef\u7528\u6027\u96c6\u7fa4 \u4e2d\u5173\u4e8e\u8de8\u591a\u673a\u5668\u63a7\u5236\u5e73\u9762\u8bbe\u7f6e\u7684\u793a\u4f8b","title":"\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff08Control Plane Components\uff09"},{"location":"Chapter03/chapter03/#kube-apiserver","text":"API \u670d\u52a1\u5668\u662f Kubernetes \u63a7\u5236\u5e73\u9762\u7684\u7ec4\u4ef6\uff0c\u8be5\u7ec4\u4ef6\u8d1f\u8d23\u516c\u5f00 Kubernetes API 1 \uff0c\u8d1f\u8d23\u5904\u7406\u63a5\u53d7\u8bf7\u6c42\u7684\u5de5\u4f5c\u3002API \u670d\u52a1\u5668\u662f Kubernetes \u63a7\u5236\u5e73\u9762\u7684\u524d\u7aef Kubernetes API \u670d\u52a1\u5668\u7684\u4e3b\u8981\u5b9e\u73b0\u662f kube-apiserver \u3002 kube-apiserver \u8bbe\u8ba1\u4e0a\u8003\u8651\u4e86\u6c34\u5e73\u6269\u7f29\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u53ef\u901a\u8fc7\u90e8\u7f72\u591a\u4e2a\u5b9e\u4f8b\u6765\u8fdb\u884c\u6269\u7f29\u3002\u4f60\u53ef\u4ee5\u8fd0\u884c kube-apiserver \u7684\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5e76\u5728\u8fd9\u4e9b\u5b9e\u4f8b\u4e4b\u95f4\u5e73\u8861\u6d41\u91cf","title":"kube-apiserver"},{"location":"Chapter03/chapter03/#etcd","text":"\u4e00\u81f4\u4e14\u9ad8\u5ea6\u53ef\u7528\u7684\u952e\u503c\u5b58\u50a8\uff0c\u7528\u4f5c Kubernetes \u7684\u6240\u6709\u96c6\u7fa4\u6570\u636e\u7684\u540e\u53f0\u6570\u636e\u5e93 \u5982\u679c\u4f60\u7684 Kubernetes \u96c6\u7fa4\u4f7f\u7528 etcd \u4f5c\u4e3a\u5176\u540e\u53f0\u6570\u636e\u5e93\uff0c\u8bf7\u786e\u4fdd\u4f60\u9488\u5bf9\u8fd9\u4e9b\u6570\u636e\u6709\u4e00\u4efd \u5907\u4efd \u8ba1\u5212 \u4f60\u53ef\u4ee5\u5728\u5b98\u65b9 \u6587\u6863 \u4e2d\u627e\u5230\u6709\u5173 etcd \u7684\u6df1\u5165\u77e5\u8bc6","title":"etcd"},{"location":"Chapter03/chapter03/#kube-scheduler","text":"kube-scheduler \u662f\u63a7\u5236\u5e73\u9762\u7684\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u76d1\u89c6\u65b0\u521b\u5efa\u7684\u3001\u672a\u6307\u5b9a\u8fd0\u884c\u8282\u70b9\uff08node\uff09\u7684 Pods\uff0c\u5e76\u9009\u62e9\u8282\u70b9\u6765\u8ba9 Pod \u5728\u4e0a\u9762\u8fd0\u884c \u8c03\u5ea6\u51b3\u7b56\u8003\u8651\u7684\u56e0\u7d20\u5305\u62ec\u5355\u4e2a Pod \u53ca Pods \u96c6\u5408\u7684\u8d44\u6e90\u9700\u6c42\u3001\u8f6f\u786c\u4ef6\u53ca\u7b56\u7565\u7ea6\u675f\u3001\u4eb2\u548c\u6027\u53ca\u53cd\u4eb2\u548c\u6027\u89c4\u8303\u3001\u6570\u636e\u4f4d\u7f6e\u3001\u5de5\u4f5c\u8d1f\u8f7d\u95f4\u7684\u5e72\u6270\u53ca\u6700\u540e\u65f6\u9650","title":"kube-scheduler"},{"location":"Chapter03/chapter03/#kube-controller-manager","text":"kube-controller-manager \u662f\u63a7\u5236\u5e73\u9762\u7684\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u8fd0\u884c\u63a7\u5236\u5668\u8fdb\u7a0b \u4ece\u903b\u8f91\u4e0a\u8bb2\uff0c\u6bcf\u4e2a\u63a7\u5236\u5668\u90fd\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b\uff0c\u4f46\u662f\u4e3a\u4e86\u964d\u4f4e\u590d\u6742\u6027\uff0c\u5b83\u4eec\u90fd\u88ab\u7f16\u8bd1\u5230\u540c\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u8fd0\u884c \u8fd9\u4e9b\u63a7\u5236\u5668\u5305\u62ec\uff1a \u8282\u70b9\u63a7\u5236\u5668\uff08Node Controller\uff09\uff1a\u8d1f\u8d23\u5728\u8282\u70b9\u51fa\u73b0\u6545\u969c\u65f6\u8fdb\u884c\u901a\u77e5\u548c\u54cd\u5e94 \u4efb\u52a1\u63a7\u5236\u5668\uff08Job Controller\uff09\uff1a\u76d1\u6d4b\u4ee3\u8868\u4e00\u6b21\u6027\u4efb\u52a1\u7684 Job \u5bf9\u8c61\uff0c\u7136\u540e\u521b\u5efa Pods \u6765\u8fd0\u884c\u8fd9\u4e9b\u4efb\u52a1\u76f4\u81f3\u5b8c\u6210 \u7aef\u70b9\u63a7\u5236\u5668\uff08Endpoints Controller\uff09\uff1a\u586b\u5145\u7aef\u70b9\uff08Endpoints\uff09\u5bf9\u8c61\uff08\u5373\u52a0\u5165 Service \u4e0e Pod\uff09 \u670d\u52a1\u5e10\u6237\u548c\u4ee4\u724c\u63a7\u5236\u5668\uff08Service Account & Token Controllers\uff09\uff1a\u4e3a\u65b0\u7684\u547d\u540d\u7a7a\u95f4\u521b\u5efa\u9ed8\u8ba4\u5e10\u6237\u548c API \u8bbf\u95ee\u4ee4\u724c","title":"kube-controller-manager"},{"location":"Chapter03/chapter03/#cloud-controller-manager","text":"\u4e00\u4e2a Kubernetes \u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff0c\u5d4c\u5165\u4e86\u7279\u5b9a\u4e8e\u4e91\u5e73\u53f0\u7684\u63a7\u5236\u903b\u8f91\u3002\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\uff08Cloud Controller Manager\uff09\u5141\u8bb8\u4f60\u5c06\u4f60\u7684\u96c6\u7fa4\u8fde\u63a5\u5230\u4e91\u63d0\u4f9b\u5546\u7684 API \u4e4b\u4e0a\uff0c\u5e76\u5c06\u4e0e\u8be5\u4e91\u5e73\u53f0\u4ea4\u4e92\u7684\u7ec4\u4ef6\u540c\u4e0e\u4f60\u7684\u96c6\u7fa4\u4ea4\u4e92\u7684\u7ec4\u4ef6\u5206\u79bb\u5f00\u6765 cloud-controller-manager \u4ec5\u8fd0\u884c\u7279\u5b9a\u4e8e\u4e91\u5e73\u53f0\u7684\u63a7\u5236\u5668\u3002\u56e0\u6b64\u5982\u679c\u4f60\u5728\u81ea\u5df1\u7684\u73af\u5883\u4e2d\u8fd0\u884c Kubernetes\uff0c\u6216\u8005\u5728\u672c\u5730\u8ba1\u7b97\u673a\u4e2d\u8fd0\u884c\u5b66\u4e60\u73af\u5883\uff0c\u6240\u90e8\u7f72\u7684\u96c6\u7fa4\u4e0d\u9700\u8981\u6709\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668 \u4e0e kube-controller-manager \u7c7b\u4f3c\uff0c cloud-controller-manager \u5c06\u82e5\u5e72\u903b\u8f91\u4e0a\u72ec\u7acb\u7684\u63a7\u5236\u56de\u8def\u7ec4\u5408\u5230\u540c\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\uff0c\u4f9b\u4f60\u4ee5\u540c\u4e00\u8fdb\u7a0b\u7684\u65b9\u5f0f\u8fd0\u884c\u3002\u4f60\u53ef\u4ee5\u5bf9\u5176\u6267\u884c\u6c34\u5e73\u6269\u5bb9\uff08\u8fd0\u884c\u4e0d\u6b62\u4e00\u4e2a\u526f\u672c\uff09\u4ee5\u63d0\u5347\u6027\u80fd\u6216\u8005\u589e\u5f3a\u5bb9\u9519\u80fd\u529b \u4e0b\u9762\u7684\u63a7\u5236\u5668\u90fd\u5305\u542b\u5bf9\u4e91\u5e73\u53f0\u9a71\u52a8\u7684\u4f9d\u8d56\uff1a \u8282\u70b9\u63a7\u5236\u5668\uff08Node Controller\uff09\uff1a\u7528\u4e8e\u5728\u8282\u70b9\u7ec8\u6b62\u54cd\u5e94\u540e\u68c0\u67e5\u4e91\u63d0\u4f9b\u5546\u4ee5\u786e\u5b9a\u8282\u70b9\u662f\u5426\u5df2\u88ab\u5220\u9664 \u8def\u7531\u63a7\u5236\u5668\uff08Route Controller\uff09\uff1a\u7528\u4e8e\u5728\u5e95\u5c42\u4e91\u57fa\u7840\u67b6\u6784\u4e2d\u8bbe\u7f6e\u8def\u7531 \u670d\u52a1\u63a7\u5236\u5668\uff08Service Controller\uff09\uff1a\u7528\u4e8e\u521b\u5efa\u3001\u66f4\u65b0\u548c\u5220\u9664\u4e91\u63d0\u4f9b\u5546\u8d1f\u8f7d\u5747\u8861\u5668","title":"cloud-controller-manager"},{"location":"Chapter03/chapter03/#node","text":"\u8282\u70b9\u7ec4\u4ef6\u4f1a\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u8d1f\u8d23\u7ef4\u62a4\u8fd0\u884c\u7684 Pod \u5e76\u63d0\u4f9b Kubernetes \u8fd0\u884c\u73af\u5883","title":"Node \u7ec4\u4ef6"},{"location":"Chapter03/chapter03/#kubelet","text":"kubelet \u4f1a\u5728\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\uff08node\uff09\u4e0a\u8fd0\u884c\u3002\u5b83\u4fdd\u8bc1\u5bb9\u5668\uff08containers\uff09\u90fd\u8fd0\u884c\u5728 Pod \u4e2d kubelet \u63a5\u6536\u4e00\u7ec4\u901a\u8fc7\u5404\u7c7b\u673a\u5236\u63d0\u4f9b\u7ed9\u5b83\u7684 PodSpecs\uff0c\u786e\u4fdd\u8fd9\u4e9b PodSpecs \u4e2d\u63cf\u8ff0\u7684\u5bb9\u5668\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u4e14\u5065\u5eb7\u3002kubelet \u4e0d\u4f1a\u7ba1\u7406\u4e0d\u662f\u7531 Kubernetes \u521b\u5efa\u7684\u5bb9\u5668","title":"kubelet"},{"location":"Chapter03/chapter03/#kube-proxy","text":"kube-proxy \u662f\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\uff08node\uff09\u6240\u4e0a\u8fd0\u884c\u7684\u7f51\u7edc\u4ee3\u7406\uff0c\u5b9e\u73b0 Kubernetes \u670d\u52a1\uff08Service\uff09\u6982\u5ff5\u7684\u4e00\u90e8\u5206 kube-proxy \u7ef4\u62a4\u8282\u70b9\u4e0a\u7684\u4e00\u4e9b\u7f51\u7edc\u89c4\u5219\uff0c\u8fd9\u4e9b\u7f51\u7edc\u89c4\u5219\u4f1a\u5141\u8bb8\u4ece\u96c6\u7fa4\u5185\u90e8\u6216\u5916\u90e8\u7684\u7f51\u7edc\u4f1a\u8bdd\u4e0e Pod \u8fdb\u884c\u7f51\u7edc\u901a\u4fe1 \u5982\u679c\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e86\u53ef\u7528\u7684\u6570\u636e\u5305\u8fc7\u6ee4\u5c42\uff0c\u5219 kube-proxy \u4f1a\u901a\u8fc7\u5b83\u6765\u5b9e\u73b0\u7f51\u7edc\u89c4\u5219\u3002\u5426\u5219\uff0ckube-proxy \u4ec5\u505a\u6d41\u91cf\u8f6c\u53d1","title":"kube-proxy"},{"location":"Chapter03/chapter03/#container-runtime","text":"\u5bb9\u5668\u8fd0\u884c\u73af\u5883\u662f\u8d1f\u8d23\u8fd0\u884c\u5bb9\u5668\u7684\u8f6f\u4ef6 Kubernetes \u652f\u6301\u8bb8\u591a\u5bb9\u5668\u8fd0\u884c\u73af\u5883\uff0c\u4f8b\u5982 containerd\u3001CRI-O \u4ee5\u53ca Kubernetes CRI (\u5bb9\u5668\u8fd0\u884c\u73af\u5883\u63a5\u53e3) \u7684\u5176\u4ed6\u4efb\u4f55\u5b9e\u73b0","title":"\u5bb9\u5668\u8fd0\u884c\u65f6\uff08Container Runtime\uff09"},{"location":"Chapter03/chapter03/#addons","text":"\u63d2\u4ef6\u4f7f\u7528 Kubernetes \u8d44\u6e90\uff08DaemonSet\u3001 Deployment \u7b49\uff09\u5b9e\u73b0\u96c6\u7fa4\u529f\u80fd\u3002\u56e0\u4e3a\u8fd9\u4e9b\u63d2\u4ef6\u63d0\u4f9b\u96c6\u7fa4\u7ea7\u522b\u7684\u529f\u80fd\uff0c\u63d2\u4ef6\u4e2d\u547d\u540d\u7a7a\u95f4\u57df\u7684\u8d44\u6e90\u5c5e\u4e8e kube-system \u547d\u540d\u7a7a\u95f4 \u4e0b\u9762\u63cf\u8ff0\u4f17\u591a\u63d2\u4ef6\u4e2d\u7684\u51e0\u79cd\u3002\u6709\u5173\u53ef\u7528\u63d2\u4ef6\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u89c1 \u63d2\u4ef6\uff08Addons\uff09","title":"\u63d2\u4ef6\uff08Addons\uff09"},{"location":"Chapter03/chapter03/#dns","text":"\u5c3d\u7ba1\u5176\u4ed6\u63d2\u4ef6\u90fd\u5e76\u975e\u4e25\u683c\u610f\u4e49\u4e0a\u7684\u5fc5\u9700\u7ec4\u4ef6\uff0c\u4f46\u51e0\u4e4e\u6240\u6709 Kubernetes \u96c6\u7fa4\u90fd\u5e94\u8be5\u6709 \u96c6\u7fa4 DNS \uff0c\u56e0\u4e3a\u5f88\u591a\u793a\u4f8b\u90fd\u9700\u8981 DNS \u670d\u52a1 \u96c6\u7fa4 DNS \u662f\u4e00\u4e2a DNS \u670d\u52a1\u5668\uff0c\u548c\u73af\u5883\u4e2d\u7684\u5176\u4ed6 DNS \u670d\u52a1\u5668\u4e00\u8d77\u5de5\u4f5c\uff0c\u5b83\u4e3a Kubernetes \u670d\u52a1\u63d0\u4f9b DNS \u8bb0\u5f55 Kubernetes \u542f\u52a8\u7684\u5bb9\u5668\u81ea\u52a8\u5c06\u6b64 DNS \u670d\u52a1\u5668\u5305\u542b\u5728\u5176 DNS \u641c\u7d22\u5217\u8868\u4e2d","title":"DNS"},{"location":"Chapter03/chapter03/#web","text":"Dashboard \u662f Kubernetes \u96c6\u7fa4\u7684\u901a\u7528\u7684\u3001\u57fa\u4e8e Web \u7684\u7528\u6237\u754c\u9762\u3002\u5b83\u4f7f\u7528\u6237\u53ef\u4ee5\u7ba1\u7406\u96c6\u7fa4\u4e2d\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u4ee5\u53ca\u96c6\u7fa4\u672c\u8eab\uff0c\u5e76\u8fdb\u884c\u6545\u969c\u6392\u9664","title":"Web \u754c\u9762\uff08\u4eea\u8868\u76d8\uff09"},{"location":"Chapter03/chapter03/#_1","text":"\u5bb9\u5668\u8d44\u6e90\u76d1\u63a7 \u5c06\u5173\u4e8e\u5bb9\u5668\u7684\u4e00\u4e9b\u5e38\u89c1\u7684\u65f6\u95f4\u5e8f\u5217\u5ea6\u91cf\u503c\u4fdd\u5b58\u5230\u4e00\u4e2a\u96c6\u4e2d\u7684\u6570\u636e\u5e93\u4e2d\uff0c\u5e76\u63d0\u4f9b\u6d4f\u89c8\u8fd9\u4e9b\u6570\u636e\u7684\u754c\u9762","title":"\u5bb9\u5668\u8d44\u6e90\u76d1\u63a7"},{"location":"Chapter03/chapter03/#_2","text":"\u96c6\u7fa4\u5c42\u9762\u65e5\u5fd7 \u673a\u5236\u8d1f\u8d23\u5c06\u5bb9\u5668\u7684\u65e5\u5fd7\u6570\u636e\u4fdd\u5b58\u5230\u4e00\u4e2a\u96c6\u4e2d\u7684\u65e5\u5fd7\u5b58\u50a8\u4e2d\uff0c\u8fd9\u79cd\u96c6\u4e2d\u65e5\u5fd7\u5b58\u50a8\u63d0\u4f9b\u641c\u7d22\u548c\u6d4f\u89c8\u63a5\u53e3 \u539f\u6587\u63cf\u8ff0\u201c\u8be5\u7ec4\u4ef6\u8d1f\u8d23\u516c\u5f00\u4e86 Kubernetes API\u201d \u4fee\u6539\u4e3a \u201c\u8be5\u7ec4\u4ef6\u8d1f\u8d23\u516c\u5f00 \u4e86 Kubernetes API\u201d \u21a9","title":"\u96c6\u7fa4\u5c42\u9762\u65e5\u5fd7"},{"location":"Chapter04/chapter04/","text":"\u4f7f\u7528 Minikube \u642d\u5efa\u5355\u8282\u70b9\u96c6\u7fa4 \u524d\u8a00 Minikube \u662f Kubernetes \u5b98\u65b9\u793e\u533a\u63a8\u8350\u4f7f\u7528\u7684\u5355\u8282\u70b9\u5b66\u4e60\u73af\u5883\u5de5\u5177\uff0c\u4e5f\u662f\u6211\u4eec\u672c\u8bfe\u7a0b\u4e4b\u540e\u9700\u8981\u4f7f\u7528\u7684\u5b66\u4e60\u73af\u5883\uff0c\u7531\u4e8e\u5355\u8282\u70b9\u7684\u7279\u70b9\uff0c\u5e76\u4e0d\u80fd\u5b8c\u5168\u5c55\u793a\u591a\u96c6\u7fa4\u7ba1\u7406\u7684\u7279\u6027\uff0c\u5bf9\u4e8e\u8fd9\u90e8\u5206\u7f3a\u5931\u7684\u5185\u5bb9\u5c06\u8fdb\u884c\u7279\u522b\u6807\u6ce8 Minikube \u53ef\u4ee5\u652f\u6301 Kubernetes \u7684\u8bb8\u591a\u7279\u6027\uff0c\u4ee5\u4e0b\u4e3a\u6b63\u5728\u652f\u6301\u7684\u7279\u6027 # supported for standard Kubernetes features LoadBalancer - using minikube tunnel Multi-cluster - using minikube start -p <name> NodePorts - using minikube service Persistent Volumes Ingress Dashboard - minikube dashboard Container runtimes - minikube start --container-runtime Configure apiserver and kubelet options via command-line flags Supports common CI environments # Developer-friendly features Addons - a marketplace for developers to share configurations for running services on minikube NVIDIA GPU support - for machine learning Filesystem mounts \u5b9e\u9a8c\u73af\u5883 K8s \u539f\u751f\u955c\u50cf\u9700\u8981\u4ece k8s.gcr.io \u4e0a\u62c9\u53d6\uff0c\u5728\u7f51\u7edc\u73af\u5883\u5e76\u4e0d\u592a\u597d\u7684\u5730\u533a\u53ef\u80fd\u4f1a\u5b58\u5728\u591a\u6b21\u62c9\u53d6\u5931\u8d25\u7684\u60c5\u51b5\uff0c\u4e3a\u4e86\u80fd\u591f\u5728\u63a5\u4e0b\u6765\u7684\u5b66\u4e60\u4e2d\u4e0d\u88ab\u7f51\u7edc\u95ee\u9898\u6253\u6270\uff0c\u63a8\u8350\u8d2d\u4e70\u9999\u6e2f\u5730\u533a\u7684\u4e91\u670d\u52a1\u5668\u8fdb\u884c\u642d\u5efa\u5de5\u4f5c\u3002\u8fd9\u91cc\u9009\u62e9\u817e\u8baf\u4e91\u63d0\u4f9b\u7684\u4e91\u670d\u52a1\u5668\uff0c\u8be6\u7ec6\u914d\u7f6e\u5982\u4e0b\uff1a Region: ap-hongkong InstanceType: S5.LARGE8 CPUS: 4 MEMS: 8 DISK: 50GB SYSM: TencentOS Server 2.4 \u73af\u5883\u521d\u59cb\u5316 TencentOS \u5728\u8bbe\u8ba1\u7684\u65f6\u5019\u5df2\u7ecf\u5bf9\u5bb9\u5668\u8fdb\u884c\u4e86\u5185\u6838\u4f18\u5316\uff0c\u57fa\u672c\u4e0d\u7528\u518d\u8fdb\u884c\u7279\u522b\u6539\u9020\uff0c\u53ef\u4ee5\u67e5\u9605 TencentOS \u4ea7\u54c1\u7279\u6027 \u7528\u4e8e\u4e86\u89e3\u8fdb\u884c\u4e86\u54ea\u4e9b\u7279\u522b\u4f18\u5316 \u5e76\u4e14 TencentOS \u9ed8\u8ba4\u5b89\u88c5\u4e86 Docker\uff0c\u53ea\u9700\u8981\u5728\u4f7f\u7528\u524d\u8fdb\u884c\u4e00\u6b21\u66f4\u65b0\u5e76\u542f\u7528\u5373\u53ef\uff0c\u5982\u679c\u662f\u5728\u5176\u4ed6\u73af\u5883\u4e2d\u5219\u9700\u8981\u91cd\u65b0\u5b89\u88c5\u914d\u7f6e Docker \u73af\u5883\uff0c\u53ef\u4ee5\u53c2\u8003 Install Docker Engine \u9875\u9762\u4e86\u89e3\u5982\u4f55\u8fdb\u884c\u5b89\u88c5\u914d\u7f6e \u5f00\u59cb\u90e8\u7f72 \u521b\u5efa\u666e\u901a\u7528\u6237 Minikube \u63a8\u8350\u4f7f\u7528\u666e\u901a\u7528\u6237\u8fdb\u884c\u5de5\u4f5c\uff0c\u8fd9\u91cc\u521b\u5efa\u4e00\u4e2a\u666e\u901a\u7528\u6237 minikube \u7528\u4e8e\u8fd0\u884c\u4e3b\u7a0b\u5e8f # \u521b\u5efa minikube \u7528\u6237 useradd -m minikube # \u6dfb\u52a0 minikube \u5230 docker \u7528\u6237\u7ec4 usermod -aG docker minikube # \u53ef\u9009\uff1a\u4e3a minikube \u7528\u6237\u8bbe\u7f6e\u5bc6\u7801 passwd minikube \u521b\u5efa\u5b8c\u6210\u540e\u4f7f\u7528 su - minikube \u5207\u6362\u5230 minikube \u7528\u6237\uff0c\u5e76\u6267\u884c docker info \u7528\u4e8e\u9a8c\u8bc1\u662f\u5426\u53ef\u4ee5\u4f7f\u7528 Docker \u5b89\u88c5 Minikube \u7a0b\u5e8f\u5305 TencentOS 2.4 \u662f\u57fa\u4e8e CentOS 7 \u8fdb\u884c\u7684\u5b9a\u5236\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0b\u8f7d\u5b89\u88c5 RPM package # \u4e0b\u8f7d\u5b89\u88c5\u5305 curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-latest.x86_64.rpm # \u5b89\u88c5 Minikube\u3002\u6ce8\u610f\u5728\u521a\u521a\u521b\u5efa\u7528\u6237\u7684\u65f6\u5019\u5e76\u6ca1\u6709\u914d\u7f6e sudoers\uff0c\u53ef\u4ee5\u5728 root \u7528\u6237\u4e2d\u8fdb\u884c\u5b89\u88c5 rpm -Uvh minikube-latest.x86_64.rpm \u8f93\u5165 minikube status \u547d\u4ee4\u9a8c\u8bc1\u662f\u5426\u6b63\u786e\u5b89\u88c5 Minikube \u57fa\u672c\u914d\u7f6e Minikube \u5728\u5b89\u88c5\u540e\u5982\u679c\u76f4\u63a5 start \uff0c\u4f1a\u9ed8\u8ba4\u6700\u5927\u7a0b\u5ea6\u7684\u4f7f\u7528\u7cfb\u7edf\u8d44\u6e90\uff0c\u4e0d\u7ba1\u662f\u5f00\u53d1\u6d4b\u8bd5\u73af\u5883\u8fd8\u662f\u6b63\u5f0f\u751f\u4ea7\u73af\u5883\u8fd9\u6837\u90fd\u662f\u9ad8\u98ce\u9669\u7684\u64cd\u4f5c\uff0c\u6240\u4ee5\u9700\u8981\u5728\u6b63\u5f0f\u8fd0\u884c\u524d\u8fdb\u884c\u7279\u522b\u914d\u7f6e\uff0c\u4ee5\u4e0b\u4e3a\u9ed8\u8ba4\u53ef\u914d\u7f6e\u53c2\u6570 # \u83b7\u53d6\u9ed8\u8ba4\u914d\u7f6e\u53c2\u6570 minikube config # \u8be6\u7ec6\u914d\u7f6e\u53c2\u6570\u5217\u8868 * driver * vm-driver * container-runtime * feature-gates * v * cpus * disk-size * host-only-cidr * memory * log_dir * kubernetes-version * iso-url * WantUpdateNotification * WantBetaUpdateNotification * ReminderWaitPeriodInHours * WantNoneDriverWarning * WantVirtualBoxDriverWarning * profile * bootstrapper * insecure-registry * hyperv-virtual-switch * disable-driver-mounts * cache * EmbedCerts * native-ssh * rootless * MaxAuditEntries \u6839\u636e\u6211\u4eec\u8d2d\u4e70\u7684\u4e91\u670d\u52a1\u5668\u914d\u7f6e\uff0c\u8fd9\u91cc\u63a8\u8350\u4f7f\u7528\u4ee5\u4e0b\u914d\u7f6e # \u914d\u7f6e\u6587\u4ef6\u5730\u5740\uff1a/home/minikube/.minikube/config/config.json - container-runtime: docker - cpus: 2 - disk-size: 20GB - driver: docker - memory: 4096MB \u9664\u6b64\u4e4b\u5916\uff0c\u6211\u4eec\u63a8\u8350\u540c\u65f6\u7981\u7528 Emoji\uff0c\u5728 CLI \u6a21\u5f0f\u4e0b\u770b Emoji \u786e\u5b9e\u6709\u70b9\u602a\u602a\u7684~ # \u914d\u7f6e\u9879\u5199\u5165 ~/.bashrc echo \"export MINIKUBE_IN_STYLE=false\" >> ~/.bashrc # \u6fc0\u6d3b\u914d\u7f6e source ~/.bashrc \u53ef\u9009 - \u914d\u7f6e\u7f51\u7edc\u4ee3\u7406 \u5728\u6211\u4eec\u5373\u5c06\u642d\u5efa\u7684\u5b66\u4e60\u73af\u5883\u4e2d\u5176\u5b9e\u5e76\u4e0d\u662f\u5f88\u9700\u8981\u8fdb\u884c\u8fd9\u4e00\u9879\u914d\u7f6e\uff0c\u4f46\u5bf9\u4e8e\u751f\u4ea7\u73af\u5883\u6216\u8005\u6709\u4ee3\u7406\u914d\u7f6e\u7684\u73af\u5883\uff0c\u8fdb\u884c\u7f51\u7edc\u4ee3\u7406\u914d\u7f6e\u662f\u975e\u5e38\u5fc5\u8981\u7684\uff0c\u4ee5\u4e0b\u662f\u63a8\u8350\u7684\u914d\u7f6e # \u7f51\u7edc\u4ee3\u7406\u914d\u7f6e\u53c2\u8003\uff0c\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u914d\u7f6e echo \"export HTTP_PROXY=http://<proxy hostname:port>\" >> ~/.bashrc echo \"export HTTPS_PROXY=https://<proxy hostname:port>\" >> ~/.bashrc # \u4e0d\u4f7f\u7528\u4ee3\u7406\u7684\u7f51\u6bb5 echo \"export NO_PROXY=localhost,127.0.0.1,10.96.0.0/12,192.168.59.0/24,192.168.49.0/24,192.168.39.0/24\" >> ~/.bashrc Minikube \u542f\u52a8 \u5728\u4ee5\u4e0a\u914d\u7f6e\u53c2\u6570\u5b8c\u6210\u540e\uff0c\u5373\u53ef\u6b63\u5f0f\u542f\u52a8 Minikube\uff0c\u542f\u52a8 Minikube \u7684\u65b9\u5f0f\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u4ec5\u9700\u8981\u6267\u884c minikube start \u547d\u4ee4\u5373\u53ef\uff0c\u4ee5\u4e0b\u4e3a\u521d\u6b21\u542f\u52a8\u65f6\u7684\u72b6\u6001\u53c2\u8003 # Minikube \u521d\u6b21\u542f\u52a8\u72b6\u6001 * minikube v1.27.1 on Tencentos ( amd64 ) - MINIKUBE_IN_STYLE = false * Using the docker driver based on user configuration * Using Docker driver with root privileges * Starting control plane node minikube in cluster minikube * Pulling base image ... * Downloading Kubernetes v1.25.2 preload ... > preloaded-images-k8s-v18-v1...: 385 .41 MiB / 385 .41 MiB 100 .00% 6 .52 Mi > gcr.io/k8s-minikube/kicbase: 387 .11 MiB / 387 .11 MiB 100 .00% 5 .74 MiB p > gcr.io/k8s-minikube/kicbase: 0 B [ ________________________ ] ?% ? p/s 36s * Creating docker container ( CPUs = 2 , Memory = 4096MB ) ... * Preparing Kubernetes v1.25.2 on Docker 20 .10.18 ... - Generating certificates and keys ... - Booting up control plane ... - Configuring RBAC rules ... * Verifying Kubernetes components... - Using image gcr.io/k8s-minikube/storage-provisioner:v5 * Enabled addons: storage-provisioner, default-storageclass * kubectl not found. If you need it, try: 'minikube kubectl -- get pods -A' * Done! kubectl is now configured to use \"minikube\" cluster and \"default\" namespace by default Minikube Addons \u4e3a\u4e86\u7ee7\u7eed\u540e\u9762\u7684\u5b66\u4e60\uff0c\u8fd9\u91cc\u63a8\u8350\u540c\u65f6\u542f\u7528\u63d2\u4ef6\u529f\u80fd\uff0c\u63a8\u8350\u542f\u7528 dashboard default-storageclass ingress ingress-dns storage-provisioner # \u83b7\u53d6\u63d2\u4ef6\u6e05\u5355 minikube addons list # \u5b8c\u6574\u7684\u63d2\u4ef6\u5217\u8868 | ----------------------------- | ---------- | -------------- | -------------------------------- | | ADDON NAME | PROFILE | STATUS | MAINTAINER | | ----------------------------- | ---------- | -------------- | -------------------------------- | | ambassador | minikube | disabled | 3rd party ( Ambassador ) | | auto-pause | minikube | disabled | Google | | csi-hostpath-driver | minikube | disabled | Kubernetes | | dashboard | minikube | enabled \u2705 | Kubernetes | | default-storageclass | minikube | enabled \u2705 | Kubernetes | | efk | minikube | disabled | 3rd party ( Elastic ) | | freshpod | minikube | disabled | Google | | gcp-auth | minikube | disabled | Google | | gvisor | minikube | disabled | Google | | headlamp | minikube | disabled | 3rd party ( kinvolk.io ) | | helm-tiller | minikube | disabled | 3rd party ( Helm ) | | inaccel | minikube | disabled | 3rd party ( InAccel | | | | | [ info@inaccel.com ]) | | ingress | minikube | enabled \u2705 | Kubernetes | | ingress-dns | minikube | enabled \u2705 | Google | | istio | minikube | disabled | 3rd party ( Istio ) | | istio-provisioner | minikube | disabled | 3rd party ( Istio ) | | kong | minikube | disabled | 3rd party ( Kong HQ ) | | kubevirt | minikube | disabled | 3rd party ( KubeVirt ) | | logviewer | minikube | disabled | 3rd party ( unknown ) | | metallb | minikube | disabled | 3rd party ( MetalLB ) | | metrics-server | minikube | disabled | Kubernetes | | nvidia-driver-installer | minikube | disabled | Google | | nvidia-gpu-device-plugin | minikube | disabled | 3rd party ( Nvidia ) | | olm | minikube | disabled | 3rd party ( Operator Framework ) | | pod-security-policy | minikube | disabled | 3rd party ( unknown ) | | portainer | minikube | disabled | 3rd party ( Portainer.io ) | | registry | minikube | disabled | Google | | registry-aliases | minikube | disabled | 3rd party ( unknown ) | | registry-creds | minikube | disabled | 3rd party ( UPMC Enterprises ) | | storage-provisioner | minikube | enabled \u2705 | Google | | storage-provisioner-gluster | minikube | disabled | 3rd party ( Gluster ) | | volumesnapshots | minikube | disabled | Kubernetes | | ----------------------------- | ---------- | -------------- | -------------------------------- | \u5b89\u88c5 kubectl \u5de5\u5177 Minikube \u9ed8\u8ba4\u63d0\u4f9b\u4e86 kubectl \u5de5\u5177\uff0c\u4f7f\u7528\u65b9\u6cd5\u662f minikube kubectl \uff0c\u5bf9\u4e8e\u5df2\u7ecf\u5f62\u6210\u808c\u8089\u8bb0\u5fc6\u7684\u64cd\u4f5c\u4e0d\u592a\u53cb\u597d\uff0c\u6240\u4ee5\u8fd9\u91cc\u5b89\u88c5 Kubernetes \u81ea\u5e26\u7684 kubectl \u5de5\u5177\u8fdb\u884c\u96c6\u7fa4\u7ba1\u7406 # \u4e0b\u8f7d kubectl \u5de5\u5177 curl -LO \"https://dl.k8s.io/release/ $( curl -L -s https://dl.k8s.io/release/stable.txt ) /bin/linux/amd64/kubectl\" # \u79fb\u52a8\u81f3 /usr/local/bin/ \u76ee\u5f55 mv ~/kubectl /usr/local/bin/ # \u6388\u6743\u53ef\u6267\u884c\u6743\u9650\u3002\u6ce8\u610f\u6211\u4eec\u7684 minikube \u7528\u6237\u5e76\u6ca1\u6709\u914d\u7f6e sudoers\uff0c\u9700\u8981\u5728 root \u7528\u6237\u4e0b\u64cd\u4f5c chmod +x /usr/local/bin/kubectl \u8f93\u5165\u547d\u4ee4 kubectl version \u9a8c\u8bc1\u53ef\u7528\u6027\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u4f1a\u8fd4\u56de\u4ee5\u4e0b\u5185\u5bb9 # kubectl version \u547d\u4ee4\u7ed3\u679c Client Version: version.Info { Major: \"1\" , Minor: \"25\" , GitVersion: \"v1.25.3\" , GitCommit: \"434bfd82814af038ad94d62ebe59b133fcb50506\" , GitTreeState: \"clean\" , BuildDate: \"2022-10-12T10:57:26Z\" , GoVersion: \"go1.19.2\" , Compiler: \"gc\" , Platform: \"linux/amd64\" } Kustomize Version: v4.5.7 \u5f00\u59cb\u4f7f\u7528 \u5230\u6b64\u4e3a\u6b62\u6211\u4eec\u5df2\u7ecf\u4f7f\u7528 Minikube \u5b8c\u6574\u642d\u5efa\u4e86\u5355\u8282\u70b9\u96c6\u7fa4\uff0c\u4e0b\u9762\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e9b\u57fa\u672c\u64cd\u4f5c \u72b6\u6001\u68c0\u67e5 \u67e5\u770b\u96c6\u7fa4\u72b6\u6001 # \u67e5\u770b\u96c6\u7fa4\u72b6\u6001 kubectl cluster-info Kubernetes control plane is running at https://192.168.49.2:8443 CoreDNS is running at https://192.168.49.2:8443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy To further debug and diagnose cluster problems, use 'kubectl cluster-info dump' . \u67e5\u770b Nodes \u72b6\u6001 # \u67e5\u770b nodes \u72b6\u6001\uff0c\u6307\u5b9a\u6253\u5370\u6240\u6709 namespace \u548c\u6240\u6709\u4fe1\u606f kubectl get nodes -A -o wide NAME STATUS ROLES AGE VERSION INTERNAL-IP EXTERNAL-IP OS-IMAGE KERNEL-VERSION CONTAINER-RUNTIME minikube Ready control-plane 5d20h v1.25.2 192 .168.49.2 <none> Ubuntu 20 .04.5 LTS 4 .14.105-19-0024 docker://20.10.18 \u67e5\u770b Pods \u72b6\u6001 # \u67e5\u770b pods \u72b6\u6001\uff0c\u6307\u5b9a\u6253\u5370\u6240\u6709 namespace \u548c\u6240\u6709\u4fe1\u606f kubectl get pods -A -o wide NAMESPACE NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES ingress-nginx ingress-nginx-admission-create-6f969 0 /1 Completed 0 5d20h 172 .17.0.3 minikube <none> <none> ingress-nginx ingress-nginx-admission-patch-qbdl6 0 /1 Completed 0 5d20h 172 .17.0.4 minikube <none> <none> ingress-nginx ingress-nginx-controller-5959f988fd-2dt6b 1 /1 Running 1 ( 5d20h ago ) 5d20h 172 .17.0.5 minikube <none> <none> kube-system coredns-565d847f94-lr6hk 1 /1 Running 1 ( 5d20h ago ) 5d20h 172 .17.0.2 minikube <none> <none> kube-system etcd-minikube 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system kube-apiserver-minikube 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system kube-controller-manager-minikube 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system kube-ingress-dns-minikube 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system kube-proxy-d8zpf 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system kube-scheduler-minikube 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system storage-provisioner 1 /1 Running 2 ( 3m56s ago ) 5d20h 192 .168.49.2 minikube <none> <none> kubernetes-dashboard dashboard-metrics-scraper-b74747df5-prqfq 1 /1 Running 1 ( 5d20h ago ) 5d20h 172 .17.0.4 minikube <none> <none> kubernetes-dashboard kubernetes-dashboard-57bbdc5f89-gx8zs 1 /1 Running 2 ( 3m56s ago ) 5d20h 172 .17.0.3 minikube <none> <none> # \u67e5\u770b\u6307\u5b9a namespace pods \u72b6\u6001 kubectl get pods -n ingress-nginx -o wide NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES ingress-nginx-admission-create-6f969 0 /1 Completed 0 5d20h 172 .17.0.3 minikube <none> <none> ingress-nginx-admission-patch-qbdl6 0 /1 Completed 0 5d20h 172 .17.0.4 minikube <none> <none> ingress-nginx-controller-5959f988fd-2dt6b 1 /1 Running 1 ( 5d20h ago ) 5d20h 172 .17.0.5 minikube <none> <none> \u68c0\u67e5 Pods \u8be6\u7ec6\u4fe1\u606f # \u67e5\u770b namespace \u4e3a kube-system\uff0cpod \u4e3a etcd-minikube \u7684\u8be6\u7ec6\u4fe1\u606f kubectl describe -n kube-system pod etcd-minikube Name: etcd-minikube Namespace: kube-system Priority: 2000001000 Priority Class Name: system-node-critical Node: minikube/192.168.49.2 Start Time: Tue, 18 Oct 2022 14 :25:42 +0800 Labels: component = etcd tier = control-plane Annotations: kubeadm.kubernetes.io/etcd.advertise-client-urls: https://192.168.49.2:2379 kubernetes.io/config.hash: bd495b7643dfc9d3194bd002e968bc3d kubernetes.io/config.mirror: bd495b7643dfc9d3194bd002e968bc3d kubernetes.io/config.seen: 2022 -10-18T06:25:31.559325794Z kubernetes.io/config.source: file Status: Running IP: 192 .168.49.2 IPs: IP: 192 .168.49.2 Controlled By: Node/minikube ... # \u6700\u5e38\u67e5\u770b\u7684\u662f Events \u9879\uff0c\u53ef\u4ee5\u5e2e\u6211\u4eec\u5206\u6790 Pods \u95ee\u9898 Events: Type Reason Age From Message ---- ------ ---- ---- ------- Normal SandboxChanged 18m kubelet Pod sandbox changed, it will be killed and re-created. Normal Pulled 18m kubelet Container image \"registry.k8s.io/etcd:3.5.4-0\" already present on machine Normal Created 18m kubelet Created container etcd Normal Started 18m kubelet Started container etcd \u4ee5 JSON \u683c\u5f0f\u8f93\u51fa Pods \u4fe1\u606f # \u8f93\u51fa namespace \u4e3a kube-system\uff0cpod \u4e3a etcd-minikube \u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f7f\u7528 JSON \u683c\u5f0f\u6253\u5370\u51fa\u6765 kubectl get -o json -n kube-system pod etcd-minikube { \"apiVersion\" : \"v1\" , \"kind\" : \"Pod\" , \"metadata\" : { \"annotations\" : { \"kubeadm.kubernetes.io/etcd.advertise-client-urls\" : \"https://192.168.49.2:2379\" , \"kubernetes.io/config.hash\" : \"bd495b7643dfc9d3194bd002e968bc3d\" , \"kubernetes.io/config.mirror\" : \"bd495b7643dfc9d3194bd002e968bc3d\" , \"kubernetes.io/config.seen\" : \"2022-10-18T06:25:31.559325794Z\" , \"kubernetes.io/config.source\" : \"file\" } , \"creationTimestamp\" : \"2022-10-18T06:25:40Z\" , \"labels\" : { \"component\" : \"etcd\" , \"tier\" : \"control-plane\" } , \"name\" : \"etcd-minikube\" , \"namespace\" : \"kube-system\" , \"ownerReferences\" : [ { \"apiVersion\" : \"v1\" , \"controller\" : true, \"kind\" : \"Node\" , \"name\" : \"minikube\" , \"uid\" : \"7e1475aa-5bf6-4c76-8180-ae8f006b6adf\" } ] , ... \u5217\u51fa\u6240\u6709\u7684 Services # \u5217\u51fa\u6240\u6709\u7684 services\uff0c-o wide \u6253\u5370\u51fa\u6240\u6709\u7684\u4fe1\u606f kubectl get services -o wide NAME TYPE CLUSTER-IP EXTERNAL-IP PORT ( S ) AGE SELECTOR kubernetes ClusterIP 10 .96.0.1 <none> 443 /TCP 5d20h <none> \u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684\u670d\u52a1 \u521b\u5efa\u8d44\u6e90\u5bf9\u8c61 \u8fd9\u91cc\u6211\u4eec\u5c1d\u8bd5\u521b\u5efa NGINX \u670d\u52a1\u7528\u4e8e\u9a8c\u8bc1\u96c6\u7fa4\u53ef\u7528\u6027 # \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8d44\u6e90\u5bf9\u8c61\uff0c\u547d\u540d\u4e3a nginx-master\uff0cpod \u6570\u91cf\u6307\u5b9a\u4e3a 2 \u4e2a kubectl create deployment nginx-master --image = docker.io/nginx:latest --replicas = 2 deployment.apps/nginx-master created # \u4f7f\u7528\u521a\u521a\u521b\u5efa\u7684 nginx-master \u521b\u5efa\u65b0\u7684 services kubectl expose deployment nginx-master --type = NodePort --port = 80 service/nginx-master exposed \u5bf9\u5916\u5f00\u542f\u670d\u52a1 \u521a\u521a\u521b\u5efa\u7684 NGINX \u670d\u52a1\u662f\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u4f7f\u7528\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4f7f\u7528 port-forward \u529f\u80fd\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1 # \u7531\u4e8e\u662f\u4e91\u670d\u52a1\u5668\u4e0d\u662f\u672c\u5730\u670d\u52a1\u5668\uff0c\u6240\u4ee5\u5b8c\u5168\u5f00\u653e\u7f51\u7edc\u4ee5\u4fbf\u9a8c\u8bc1\uff0c\u5bf9\u5916\u7aef\u53e3 7080 kubectl port-forward --address 0 .0.0.0 service/nginx-master 7080 :80 \u5982\u679c\u4e00\u5207\u6b63\u5e38\u4f1a\u8fd4\u56de\u5982\u4e0b\u9875\u9762 \u914d\u7f6e\u8d1f\u8f7d\u5747\u8861 \u5bf9\u4e8e\u751f\u4ea7\u73af\u5883\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u662f\u975e\u5e38\u5b89\u5168\u7684\u65b9\u5f0f\uff0c\u8fd9\u91cc\u7b80\u5355\u7684\u4ecb\u7ecd\u8d1f\u8f7d\u5747\u8861\u7684\u914d\u7f6e\uff0c\u66f4\u8be6\u7ec6\u7684\u914d\u7f6e\u53ef\u4ee5\u53c2\u8003 Kubernetes \u8d1f\u8f7d\u5747\u8861 \u4e0e\u521a\u521a\u8fdb\u884c\u7684\u670d\u52a1\u90e8\u7f72\u7c7b\u4f3c\uff0c\u8fd9\u91cc\u6211\u4eec\u5728\u521b\u5efa\u8d1f\u8f7d\u5747\u8861\u7684\u65f6\u5019\u9700\u8981\u6307\u5b9a --type=LoadBalancer \uff0c\u4e4b\u540e\u4f7f\u7528 Minikube \u63d0\u4f9b\u7684 tunnel \u5de5\u5177\u53ef\u4ee5\u5feb\u901f\u5f00\u542f\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e # \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8d44\u6e90\u5bf9\u8c61\uff0c\u547d\u540d\u4e3a nginx-lb\uff0cpod \u6570\u91cf\u6307\u5b9a\u4e3a 2 \u4e2a # kubectl create deployment nginx-lb --image=docker.io/nginx:latest --replicas=2 deployment.apps/nginx-lb created # \u4f7f\u7528\u521a\u521a\u521b\u5efa\u7684 nginx-lb \u521b\u5efa\u65b0\u7684 services # kubectl expose deployment nginx-lb --type=LoadBalancer --port=80 service/nginx-lb exposed # sudoers \u6587\u4ef6\u4e2d\u6dfb\u52a0 minikube\uff0croot \u7528\u6237\u4e0b\u6267\u884c sudoedit /etc/sudoers # \u4e3a\u7528\u6237 minikube \u521b\u5efa\u4e00\u4e2a\u5bc6\u7801 passwd minikube # \u5f00\u542f\u8d1f\u8f7d\u5747\u8861 minikube tunnel # \u8d1f\u8f7d\u5747\u8861\u72b6\u6001\u8f93\u51fa Status: machine: minikube pid: 257973 route: 10 .96.0.0/12 -> 192 .168.49.2 minikube: Running services: [ nginx-lb ] errors: minikube: no errors router: no errors loadbalancer emulator: no errors \u7ed3\u8bed \u81f3\u6b64\u6211\u4eec\u5df2\u7ecf\u5b66\u4e60\u4e86\u4f7f\u7528 Minikube \u642d\u5efa\u5355\u8282\u70b9\u96c6\u7fa4\u8bfe\u7a0b\u3001\u4e86\u89e3\u4e86\u57fa\u672c\u7684 K8s \u5e38\u7528\u7684\u64cd\u4f5c\u547d\u4ee4\uff0c\u5e76\u5b9e\u65bd\u90e8\u7f72\u4e86\u4e00\u6b21\u670d\u52a1\u642d\u5efa\uff0c\u4e4b\u540e\u7684\u8bfe\u7a0b\u6211\u4eec\u8bb2\u56f4\u7ed5 K8s \u7684\u5173\u952e\u7ec4\u4ef6\u8fdb\u884c\u66f4\u52a0\u7ec6\u81f4\u7684\u5b66\u4e60\uff0c\u6b22\u8fce\u7ee7\u7eed\u8fdb\u884c\u9605\u8bfb","title":"\u4f7f\u7528 Minikube \u642d\u5efa\u5355\u8282\u70b9\u96c6\u7fa4"},{"location":"Chapter04/chapter04/#minikube","text":"","title":"\u4f7f\u7528 Minikube \u642d\u5efa\u5355\u8282\u70b9\u96c6\u7fa4"},{"location":"Chapter04/chapter04/#_1","text":"Minikube \u662f Kubernetes \u5b98\u65b9\u793e\u533a\u63a8\u8350\u4f7f\u7528\u7684\u5355\u8282\u70b9\u5b66\u4e60\u73af\u5883\u5de5\u5177\uff0c\u4e5f\u662f\u6211\u4eec\u672c\u8bfe\u7a0b\u4e4b\u540e\u9700\u8981\u4f7f\u7528\u7684\u5b66\u4e60\u73af\u5883\uff0c\u7531\u4e8e\u5355\u8282\u70b9\u7684\u7279\u70b9\uff0c\u5e76\u4e0d\u80fd\u5b8c\u5168\u5c55\u793a\u591a\u96c6\u7fa4\u7ba1\u7406\u7684\u7279\u6027\uff0c\u5bf9\u4e8e\u8fd9\u90e8\u5206\u7f3a\u5931\u7684\u5185\u5bb9\u5c06\u8fdb\u884c\u7279\u522b\u6807\u6ce8 Minikube \u53ef\u4ee5\u652f\u6301 Kubernetes \u7684\u8bb8\u591a\u7279\u6027\uff0c\u4ee5\u4e0b\u4e3a\u6b63\u5728\u652f\u6301\u7684\u7279\u6027 # supported for standard Kubernetes features LoadBalancer - using minikube tunnel Multi-cluster - using minikube start -p <name> NodePorts - using minikube service Persistent Volumes Ingress Dashboard - minikube dashboard Container runtimes - minikube start --container-runtime Configure apiserver and kubelet options via command-line flags Supports common CI environments # Developer-friendly features Addons - a marketplace for developers to share configurations for running services on minikube NVIDIA GPU support - for machine learning Filesystem mounts","title":"\u524d\u8a00"},{"location":"Chapter04/chapter04/#_2","text":"K8s \u539f\u751f\u955c\u50cf\u9700\u8981\u4ece k8s.gcr.io \u4e0a\u62c9\u53d6\uff0c\u5728\u7f51\u7edc\u73af\u5883\u5e76\u4e0d\u592a\u597d\u7684\u5730\u533a\u53ef\u80fd\u4f1a\u5b58\u5728\u591a\u6b21\u62c9\u53d6\u5931\u8d25\u7684\u60c5\u51b5\uff0c\u4e3a\u4e86\u80fd\u591f\u5728\u63a5\u4e0b\u6765\u7684\u5b66\u4e60\u4e2d\u4e0d\u88ab\u7f51\u7edc\u95ee\u9898\u6253\u6270\uff0c\u63a8\u8350\u8d2d\u4e70\u9999\u6e2f\u5730\u533a\u7684\u4e91\u670d\u52a1\u5668\u8fdb\u884c\u642d\u5efa\u5de5\u4f5c\u3002\u8fd9\u91cc\u9009\u62e9\u817e\u8baf\u4e91\u63d0\u4f9b\u7684\u4e91\u670d\u52a1\u5668\uff0c\u8be6\u7ec6\u914d\u7f6e\u5982\u4e0b\uff1a Region: ap-hongkong InstanceType: S5.LARGE8 CPUS: 4 MEMS: 8 DISK: 50GB SYSM: TencentOS Server 2.4","title":"\u5b9e\u9a8c\u73af\u5883"},{"location":"Chapter04/chapter04/#_3","text":"TencentOS \u5728\u8bbe\u8ba1\u7684\u65f6\u5019\u5df2\u7ecf\u5bf9\u5bb9\u5668\u8fdb\u884c\u4e86\u5185\u6838\u4f18\u5316\uff0c\u57fa\u672c\u4e0d\u7528\u518d\u8fdb\u884c\u7279\u522b\u6539\u9020\uff0c\u53ef\u4ee5\u67e5\u9605 TencentOS \u4ea7\u54c1\u7279\u6027 \u7528\u4e8e\u4e86\u89e3\u8fdb\u884c\u4e86\u54ea\u4e9b\u7279\u522b\u4f18\u5316 \u5e76\u4e14 TencentOS \u9ed8\u8ba4\u5b89\u88c5\u4e86 Docker\uff0c\u53ea\u9700\u8981\u5728\u4f7f\u7528\u524d\u8fdb\u884c\u4e00\u6b21\u66f4\u65b0\u5e76\u542f\u7528\u5373\u53ef\uff0c\u5982\u679c\u662f\u5728\u5176\u4ed6\u73af\u5883\u4e2d\u5219\u9700\u8981\u91cd\u65b0\u5b89\u88c5\u914d\u7f6e Docker \u73af\u5883\uff0c\u53ef\u4ee5\u53c2\u8003 Install Docker Engine \u9875\u9762\u4e86\u89e3\u5982\u4f55\u8fdb\u884c\u5b89\u88c5\u914d\u7f6e","title":"\u73af\u5883\u521d\u59cb\u5316"},{"location":"Chapter04/chapter04/#_4","text":"","title":"\u5f00\u59cb\u90e8\u7f72"},{"location":"Chapter04/chapter04/#_5","text":"Minikube \u63a8\u8350\u4f7f\u7528\u666e\u901a\u7528\u6237\u8fdb\u884c\u5de5\u4f5c\uff0c\u8fd9\u91cc\u521b\u5efa\u4e00\u4e2a\u666e\u901a\u7528\u6237 minikube \u7528\u4e8e\u8fd0\u884c\u4e3b\u7a0b\u5e8f # \u521b\u5efa minikube \u7528\u6237 useradd -m minikube # \u6dfb\u52a0 minikube \u5230 docker \u7528\u6237\u7ec4 usermod -aG docker minikube # \u53ef\u9009\uff1a\u4e3a minikube \u7528\u6237\u8bbe\u7f6e\u5bc6\u7801 passwd minikube \u521b\u5efa\u5b8c\u6210\u540e\u4f7f\u7528 su - minikube \u5207\u6362\u5230 minikube \u7528\u6237\uff0c\u5e76\u6267\u884c docker info \u7528\u4e8e\u9a8c\u8bc1\u662f\u5426\u53ef\u4ee5\u4f7f\u7528 Docker","title":"\u521b\u5efa\u666e\u901a\u7528\u6237"},{"location":"Chapter04/chapter04/#minikube_1","text":"TencentOS 2.4 \u662f\u57fa\u4e8e CentOS 7 \u8fdb\u884c\u7684\u5b9a\u5236\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0b\u8f7d\u5b89\u88c5 RPM package # \u4e0b\u8f7d\u5b89\u88c5\u5305 curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-latest.x86_64.rpm # \u5b89\u88c5 Minikube\u3002\u6ce8\u610f\u5728\u521a\u521a\u521b\u5efa\u7528\u6237\u7684\u65f6\u5019\u5e76\u6ca1\u6709\u914d\u7f6e sudoers\uff0c\u53ef\u4ee5\u5728 root \u7528\u6237\u4e2d\u8fdb\u884c\u5b89\u88c5 rpm -Uvh minikube-latest.x86_64.rpm \u8f93\u5165 minikube status \u547d\u4ee4\u9a8c\u8bc1\u662f\u5426\u6b63\u786e\u5b89\u88c5","title":"\u5b89\u88c5 Minikube \u7a0b\u5e8f\u5305"},{"location":"Chapter04/chapter04/#minikube_2","text":"Minikube \u5728\u5b89\u88c5\u540e\u5982\u679c\u76f4\u63a5 start \uff0c\u4f1a\u9ed8\u8ba4\u6700\u5927\u7a0b\u5ea6\u7684\u4f7f\u7528\u7cfb\u7edf\u8d44\u6e90\uff0c\u4e0d\u7ba1\u662f\u5f00\u53d1\u6d4b\u8bd5\u73af\u5883\u8fd8\u662f\u6b63\u5f0f\u751f\u4ea7\u73af\u5883\u8fd9\u6837\u90fd\u662f\u9ad8\u98ce\u9669\u7684\u64cd\u4f5c\uff0c\u6240\u4ee5\u9700\u8981\u5728\u6b63\u5f0f\u8fd0\u884c\u524d\u8fdb\u884c\u7279\u522b\u914d\u7f6e\uff0c\u4ee5\u4e0b\u4e3a\u9ed8\u8ba4\u53ef\u914d\u7f6e\u53c2\u6570 # \u83b7\u53d6\u9ed8\u8ba4\u914d\u7f6e\u53c2\u6570 minikube config # \u8be6\u7ec6\u914d\u7f6e\u53c2\u6570\u5217\u8868 * driver * vm-driver * container-runtime * feature-gates * v * cpus * disk-size * host-only-cidr * memory * log_dir * kubernetes-version * iso-url * WantUpdateNotification * WantBetaUpdateNotification * ReminderWaitPeriodInHours * WantNoneDriverWarning * WantVirtualBoxDriverWarning * profile * bootstrapper * insecure-registry * hyperv-virtual-switch * disable-driver-mounts * cache * EmbedCerts * native-ssh * rootless * MaxAuditEntries \u6839\u636e\u6211\u4eec\u8d2d\u4e70\u7684\u4e91\u670d\u52a1\u5668\u914d\u7f6e\uff0c\u8fd9\u91cc\u63a8\u8350\u4f7f\u7528\u4ee5\u4e0b\u914d\u7f6e # \u914d\u7f6e\u6587\u4ef6\u5730\u5740\uff1a/home/minikube/.minikube/config/config.json - container-runtime: docker - cpus: 2 - disk-size: 20GB - driver: docker - memory: 4096MB \u9664\u6b64\u4e4b\u5916\uff0c\u6211\u4eec\u63a8\u8350\u540c\u65f6\u7981\u7528 Emoji\uff0c\u5728 CLI \u6a21\u5f0f\u4e0b\u770b Emoji \u786e\u5b9e\u6709\u70b9\u602a\u602a\u7684~ # \u914d\u7f6e\u9879\u5199\u5165 ~/.bashrc echo \"export MINIKUBE_IN_STYLE=false\" >> ~/.bashrc # \u6fc0\u6d3b\u914d\u7f6e source ~/.bashrc","title":"Minikube \u57fa\u672c\u914d\u7f6e"},{"location":"Chapter04/chapter04/#-","text":"\u5728\u6211\u4eec\u5373\u5c06\u642d\u5efa\u7684\u5b66\u4e60\u73af\u5883\u4e2d\u5176\u5b9e\u5e76\u4e0d\u662f\u5f88\u9700\u8981\u8fdb\u884c\u8fd9\u4e00\u9879\u914d\u7f6e\uff0c\u4f46\u5bf9\u4e8e\u751f\u4ea7\u73af\u5883\u6216\u8005\u6709\u4ee3\u7406\u914d\u7f6e\u7684\u73af\u5883\uff0c\u8fdb\u884c\u7f51\u7edc\u4ee3\u7406\u914d\u7f6e\u662f\u975e\u5e38\u5fc5\u8981\u7684\uff0c\u4ee5\u4e0b\u662f\u63a8\u8350\u7684\u914d\u7f6e # \u7f51\u7edc\u4ee3\u7406\u914d\u7f6e\u53c2\u8003\uff0c\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u914d\u7f6e echo \"export HTTP_PROXY=http://<proxy hostname:port>\" >> ~/.bashrc echo \"export HTTPS_PROXY=https://<proxy hostname:port>\" >> ~/.bashrc # \u4e0d\u4f7f\u7528\u4ee3\u7406\u7684\u7f51\u6bb5 echo \"export NO_PROXY=localhost,127.0.0.1,10.96.0.0/12,192.168.59.0/24,192.168.49.0/24,192.168.39.0/24\" >> ~/.bashrc","title":"\u53ef\u9009 - \u914d\u7f6e\u7f51\u7edc\u4ee3\u7406"},{"location":"Chapter04/chapter04/#minikube_3","text":"\u5728\u4ee5\u4e0a\u914d\u7f6e\u53c2\u6570\u5b8c\u6210\u540e\uff0c\u5373\u53ef\u6b63\u5f0f\u542f\u52a8 Minikube\uff0c\u542f\u52a8 Minikube \u7684\u65b9\u5f0f\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u4ec5\u9700\u8981\u6267\u884c minikube start \u547d\u4ee4\u5373\u53ef\uff0c\u4ee5\u4e0b\u4e3a\u521d\u6b21\u542f\u52a8\u65f6\u7684\u72b6\u6001\u53c2\u8003 # Minikube \u521d\u6b21\u542f\u52a8\u72b6\u6001 * minikube v1.27.1 on Tencentos ( amd64 ) - MINIKUBE_IN_STYLE = false * Using the docker driver based on user configuration * Using Docker driver with root privileges * Starting control plane node minikube in cluster minikube * Pulling base image ... * Downloading Kubernetes v1.25.2 preload ... > preloaded-images-k8s-v18-v1...: 385 .41 MiB / 385 .41 MiB 100 .00% 6 .52 Mi > gcr.io/k8s-minikube/kicbase: 387 .11 MiB / 387 .11 MiB 100 .00% 5 .74 MiB p > gcr.io/k8s-minikube/kicbase: 0 B [ ________________________ ] ?% ? p/s 36s * Creating docker container ( CPUs = 2 , Memory = 4096MB ) ... * Preparing Kubernetes v1.25.2 on Docker 20 .10.18 ... - Generating certificates and keys ... - Booting up control plane ... - Configuring RBAC rules ... * Verifying Kubernetes components... - Using image gcr.io/k8s-minikube/storage-provisioner:v5 * Enabled addons: storage-provisioner, default-storageclass * kubectl not found. If you need it, try: 'minikube kubectl -- get pods -A' * Done! kubectl is now configured to use \"minikube\" cluster and \"default\" namespace by default","title":"Minikube \u542f\u52a8"},{"location":"Chapter04/chapter04/#minikube-addons","text":"\u4e3a\u4e86\u7ee7\u7eed\u540e\u9762\u7684\u5b66\u4e60\uff0c\u8fd9\u91cc\u63a8\u8350\u540c\u65f6\u542f\u7528\u63d2\u4ef6\u529f\u80fd\uff0c\u63a8\u8350\u542f\u7528 dashboard default-storageclass ingress ingress-dns storage-provisioner # \u83b7\u53d6\u63d2\u4ef6\u6e05\u5355 minikube addons list # \u5b8c\u6574\u7684\u63d2\u4ef6\u5217\u8868 | ----------------------------- | ---------- | -------------- | -------------------------------- | | ADDON NAME | PROFILE | STATUS | MAINTAINER | | ----------------------------- | ---------- | -------------- | -------------------------------- | | ambassador | minikube | disabled | 3rd party ( Ambassador ) | | auto-pause | minikube | disabled | Google | | csi-hostpath-driver | minikube | disabled | Kubernetes | | dashboard | minikube | enabled \u2705 | Kubernetes | | default-storageclass | minikube | enabled \u2705 | Kubernetes | | efk | minikube | disabled | 3rd party ( Elastic ) | | freshpod | minikube | disabled | Google | | gcp-auth | minikube | disabled | Google | | gvisor | minikube | disabled | Google | | headlamp | minikube | disabled | 3rd party ( kinvolk.io ) | | helm-tiller | minikube | disabled | 3rd party ( Helm ) | | inaccel | minikube | disabled | 3rd party ( InAccel | | | | | [ info@inaccel.com ]) | | ingress | minikube | enabled \u2705 | Kubernetes | | ingress-dns | minikube | enabled \u2705 | Google | | istio | minikube | disabled | 3rd party ( Istio ) | | istio-provisioner | minikube | disabled | 3rd party ( Istio ) | | kong | minikube | disabled | 3rd party ( Kong HQ ) | | kubevirt | minikube | disabled | 3rd party ( KubeVirt ) | | logviewer | minikube | disabled | 3rd party ( unknown ) | | metallb | minikube | disabled | 3rd party ( MetalLB ) | | metrics-server | minikube | disabled | Kubernetes | | nvidia-driver-installer | minikube | disabled | Google | | nvidia-gpu-device-plugin | minikube | disabled | 3rd party ( Nvidia ) | | olm | minikube | disabled | 3rd party ( Operator Framework ) | | pod-security-policy | minikube | disabled | 3rd party ( unknown ) | | portainer | minikube | disabled | 3rd party ( Portainer.io ) | | registry | minikube | disabled | Google | | registry-aliases | minikube | disabled | 3rd party ( unknown ) | | registry-creds | minikube | disabled | 3rd party ( UPMC Enterprises ) | | storage-provisioner | minikube | enabled \u2705 | Google | | storage-provisioner-gluster | minikube | disabled | 3rd party ( Gluster ) | | volumesnapshots | minikube | disabled | Kubernetes | | ----------------------------- | ---------- | -------------- | -------------------------------- |","title":"Minikube Addons"},{"location":"Chapter04/chapter04/#kubectl","text":"Minikube \u9ed8\u8ba4\u63d0\u4f9b\u4e86 kubectl \u5de5\u5177\uff0c\u4f7f\u7528\u65b9\u6cd5\u662f minikube kubectl \uff0c\u5bf9\u4e8e\u5df2\u7ecf\u5f62\u6210\u808c\u8089\u8bb0\u5fc6\u7684\u64cd\u4f5c\u4e0d\u592a\u53cb\u597d\uff0c\u6240\u4ee5\u8fd9\u91cc\u5b89\u88c5 Kubernetes \u81ea\u5e26\u7684 kubectl \u5de5\u5177\u8fdb\u884c\u96c6\u7fa4\u7ba1\u7406 # \u4e0b\u8f7d kubectl \u5de5\u5177 curl -LO \"https://dl.k8s.io/release/ $( curl -L -s https://dl.k8s.io/release/stable.txt ) /bin/linux/amd64/kubectl\" # \u79fb\u52a8\u81f3 /usr/local/bin/ \u76ee\u5f55 mv ~/kubectl /usr/local/bin/ # \u6388\u6743\u53ef\u6267\u884c\u6743\u9650\u3002\u6ce8\u610f\u6211\u4eec\u7684 minikube \u7528\u6237\u5e76\u6ca1\u6709\u914d\u7f6e sudoers\uff0c\u9700\u8981\u5728 root \u7528\u6237\u4e0b\u64cd\u4f5c chmod +x /usr/local/bin/kubectl \u8f93\u5165\u547d\u4ee4 kubectl version \u9a8c\u8bc1\u53ef\u7528\u6027\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u4f1a\u8fd4\u56de\u4ee5\u4e0b\u5185\u5bb9 # kubectl version \u547d\u4ee4\u7ed3\u679c Client Version: version.Info { Major: \"1\" , Minor: \"25\" , GitVersion: \"v1.25.3\" , GitCommit: \"434bfd82814af038ad94d62ebe59b133fcb50506\" , GitTreeState: \"clean\" , BuildDate: \"2022-10-12T10:57:26Z\" , GoVersion: \"go1.19.2\" , Compiler: \"gc\" , Platform: \"linux/amd64\" } Kustomize Version: v4.5.7","title":"\u5b89\u88c5 kubectl \u5de5\u5177"},{"location":"Chapter04/chapter04/#_6","text":"\u5230\u6b64\u4e3a\u6b62\u6211\u4eec\u5df2\u7ecf\u4f7f\u7528 Minikube \u5b8c\u6574\u642d\u5efa\u4e86\u5355\u8282\u70b9\u96c6\u7fa4\uff0c\u4e0b\u9762\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e9b\u57fa\u672c\u64cd\u4f5c","title":"\u5f00\u59cb\u4f7f\u7528"},{"location":"Chapter04/chapter04/#_7","text":"","title":"\u72b6\u6001\u68c0\u67e5"},{"location":"Chapter04/chapter04/#_8","text":"# \u67e5\u770b\u96c6\u7fa4\u72b6\u6001 kubectl cluster-info Kubernetes control plane is running at https://192.168.49.2:8443 CoreDNS is running at https://192.168.49.2:8443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy To further debug and diagnose cluster problems, use 'kubectl cluster-info dump' .","title":"\u67e5\u770b\u96c6\u7fa4\u72b6\u6001"},{"location":"Chapter04/chapter04/#nodes","text":"# \u67e5\u770b nodes \u72b6\u6001\uff0c\u6307\u5b9a\u6253\u5370\u6240\u6709 namespace \u548c\u6240\u6709\u4fe1\u606f kubectl get nodes -A -o wide NAME STATUS ROLES AGE VERSION INTERNAL-IP EXTERNAL-IP OS-IMAGE KERNEL-VERSION CONTAINER-RUNTIME minikube Ready control-plane 5d20h v1.25.2 192 .168.49.2 <none> Ubuntu 20 .04.5 LTS 4 .14.105-19-0024 docker://20.10.18","title":"\u67e5\u770b Nodes \u72b6\u6001"},{"location":"Chapter04/chapter04/#pods","text":"# \u67e5\u770b pods \u72b6\u6001\uff0c\u6307\u5b9a\u6253\u5370\u6240\u6709 namespace \u548c\u6240\u6709\u4fe1\u606f kubectl get pods -A -o wide NAMESPACE NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES ingress-nginx ingress-nginx-admission-create-6f969 0 /1 Completed 0 5d20h 172 .17.0.3 minikube <none> <none> ingress-nginx ingress-nginx-admission-patch-qbdl6 0 /1 Completed 0 5d20h 172 .17.0.4 minikube <none> <none> ingress-nginx ingress-nginx-controller-5959f988fd-2dt6b 1 /1 Running 1 ( 5d20h ago ) 5d20h 172 .17.0.5 minikube <none> <none> kube-system coredns-565d847f94-lr6hk 1 /1 Running 1 ( 5d20h ago ) 5d20h 172 .17.0.2 minikube <none> <none> kube-system etcd-minikube 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system kube-apiserver-minikube 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system kube-controller-manager-minikube 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system kube-ingress-dns-minikube 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system kube-proxy-d8zpf 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system kube-scheduler-minikube 1 /1 Running 1 ( 5d20h ago ) 5d20h 192 .168.49.2 minikube <none> <none> kube-system storage-provisioner 1 /1 Running 2 ( 3m56s ago ) 5d20h 192 .168.49.2 minikube <none> <none> kubernetes-dashboard dashboard-metrics-scraper-b74747df5-prqfq 1 /1 Running 1 ( 5d20h ago ) 5d20h 172 .17.0.4 minikube <none> <none> kubernetes-dashboard kubernetes-dashboard-57bbdc5f89-gx8zs 1 /1 Running 2 ( 3m56s ago ) 5d20h 172 .17.0.3 minikube <none> <none> # \u67e5\u770b\u6307\u5b9a namespace pods \u72b6\u6001 kubectl get pods -n ingress-nginx -o wide NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES ingress-nginx-admission-create-6f969 0 /1 Completed 0 5d20h 172 .17.0.3 minikube <none> <none> ingress-nginx-admission-patch-qbdl6 0 /1 Completed 0 5d20h 172 .17.0.4 minikube <none> <none> ingress-nginx-controller-5959f988fd-2dt6b 1 /1 Running 1 ( 5d20h ago ) 5d20h 172 .17.0.5 minikube <none> <none>","title":"\u67e5\u770b Pods \u72b6\u6001"},{"location":"Chapter04/chapter04/#pods_1","text":"# \u67e5\u770b namespace \u4e3a kube-system\uff0cpod \u4e3a etcd-minikube \u7684\u8be6\u7ec6\u4fe1\u606f kubectl describe -n kube-system pod etcd-minikube Name: etcd-minikube Namespace: kube-system Priority: 2000001000 Priority Class Name: system-node-critical Node: minikube/192.168.49.2 Start Time: Tue, 18 Oct 2022 14 :25:42 +0800 Labels: component = etcd tier = control-plane Annotations: kubeadm.kubernetes.io/etcd.advertise-client-urls: https://192.168.49.2:2379 kubernetes.io/config.hash: bd495b7643dfc9d3194bd002e968bc3d kubernetes.io/config.mirror: bd495b7643dfc9d3194bd002e968bc3d kubernetes.io/config.seen: 2022 -10-18T06:25:31.559325794Z kubernetes.io/config.source: file Status: Running IP: 192 .168.49.2 IPs: IP: 192 .168.49.2 Controlled By: Node/minikube ... # \u6700\u5e38\u67e5\u770b\u7684\u662f Events \u9879\uff0c\u53ef\u4ee5\u5e2e\u6211\u4eec\u5206\u6790 Pods \u95ee\u9898 Events: Type Reason Age From Message ---- ------ ---- ---- ------- Normal SandboxChanged 18m kubelet Pod sandbox changed, it will be killed and re-created. Normal Pulled 18m kubelet Container image \"registry.k8s.io/etcd:3.5.4-0\" already present on machine Normal Created 18m kubelet Created container etcd Normal Started 18m kubelet Started container etcd","title":"\u68c0\u67e5 Pods \u8be6\u7ec6\u4fe1\u606f"},{"location":"Chapter04/chapter04/#json-pods","text":"# \u8f93\u51fa namespace \u4e3a kube-system\uff0cpod \u4e3a etcd-minikube \u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f7f\u7528 JSON \u683c\u5f0f\u6253\u5370\u51fa\u6765 kubectl get -o json -n kube-system pod etcd-minikube { \"apiVersion\" : \"v1\" , \"kind\" : \"Pod\" , \"metadata\" : { \"annotations\" : { \"kubeadm.kubernetes.io/etcd.advertise-client-urls\" : \"https://192.168.49.2:2379\" , \"kubernetes.io/config.hash\" : \"bd495b7643dfc9d3194bd002e968bc3d\" , \"kubernetes.io/config.mirror\" : \"bd495b7643dfc9d3194bd002e968bc3d\" , \"kubernetes.io/config.seen\" : \"2022-10-18T06:25:31.559325794Z\" , \"kubernetes.io/config.source\" : \"file\" } , \"creationTimestamp\" : \"2022-10-18T06:25:40Z\" , \"labels\" : { \"component\" : \"etcd\" , \"tier\" : \"control-plane\" } , \"name\" : \"etcd-minikube\" , \"namespace\" : \"kube-system\" , \"ownerReferences\" : [ { \"apiVersion\" : \"v1\" , \"controller\" : true, \"kind\" : \"Node\" , \"name\" : \"minikube\" , \"uid\" : \"7e1475aa-5bf6-4c76-8180-ae8f006b6adf\" } ] , ...","title":"\u4ee5 JSON \u683c\u5f0f\u8f93\u51fa Pods \u4fe1\u606f"},{"location":"Chapter04/chapter04/#services","text":"# \u5217\u51fa\u6240\u6709\u7684 services\uff0c-o wide \u6253\u5370\u51fa\u6240\u6709\u7684\u4fe1\u606f kubectl get services -o wide NAME TYPE CLUSTER-IP EXTERNAL-IP PORT ( S ) AGE SELECTOR kubernetes ClusterIP 10 .96.0.1 <none> 443 /TCP 5d20h <none>","title":"\u5217\u51fa\u6240\u6709\u7684 Services"},{"location":"Chapter04/chapter04/#_9","text":"","title":"\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684\u670d\u52a1"},{"location":"Chapter04/chapter04/#_10","text":"\u8fd9\u91cc\u6211\u4eec\u5c1d\u8bd5\u521b\u5efa NGINX \u670d\u52a1\u7528\u4e8e\u9a8c\u8bc1\u96c6\u7fa4\u53ef\u7528\u6027 # \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8d44\u6e90\u5bf9\u8c61\uff0c\u547d\u540d\u4e3a nginx-master\uff0cpod \u6570\u91cf\u6307\u5b9a\u4e3a 2 \u4e2a kubectl create deployment nginx-master --image = docker.io/nginx:latest --replicas = 2 deployment.apps/nginx-master created # \u4f7f\u7528\u521a\u521a\u521b\u5efa\u7684 nginx-master \u521b\u5efa\u65b0\u7684 services kubectl expose deployment nginx-master --type = NodePort --port = 80 service/nginx-master exposed","title":"\u521b\u5efa\u8d44\u6e90\u5bf9\u8c61"},{"location":"Chapter04/chapter04/#_11","text":"\u521a\u521a\u521b\u5efa\u7684 NGINX \u670d\u52a1\u662f\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u4f7f\u7528\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4f7f\u7528 port-forward \u529f\u80fd\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1 # \u7531\u4e8e\u662f\u4e91\u670d\u52a1\u5668\u4e0d\u662f\u672c\u5730\u670d\u52a1\u5668\uff0c\u6240\u4ee5\u5b8c\u5168\u5f00\u653e\u7f51\u7edc\u4ee5\u4fbf\u9a8c\u8bc1\uff0c\u5bf9\u5916\u7aef\u53e3 7080 kubectl port-forward --address 0 .0.0.0 service/nginx-master 7080 :80 \u5982\u679c\u4e00\u5207\u6b63\u5e38\u4f1a\u8fd4\u56de\u5982\u4e0b\u9875\u9762","title":"\u5bf9\u5916\u5f00\u542f\u670d\u52a1"},{"location":"Chapter04/chapter04/#_12","text":"\u5bf9\u4e8e\u751f\u4ea7\u73af\u5883\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u662f\u975e\u5e38\u5b89\u5168\u7684\u65b9\u5f0f\uff0c\u8fd9\u91cc\u7b80\u5355\u7684\u4ecb\u7ecd\u8d1f\u8f7d\u5747\u8861\u7684\u914d\u7f6e\uff0c\u66f4\u8be6\u7ec6\u7684\u914d\u7f6e\u53ef\u4ee5\u53c2\u8003 Kubernetes \u8d1f\u8f7d\u5747\u8861 \u4e0e\u521a\u521a\u8fdb\u884c\u7684\u670d\u52a1\u90e8\u7f72\u7c7b\u4f3c\uff0c\u8fd9\u91cc\u6211\u4eec\u5728\u521b\u5efa\u8d1f\u8f7d\u5747\u8861\u7684\u65f6\u5019\u9700\u8981\u6307\u5b9a --type=LoadBalancer \uff0c\u4e4b\u540e\u4f7f\u7528 Minikube \u63d0\u4f9b\u7684 tunnel \u5de5\u5177\u53ef\u4ee5\u5feb\u901f\u5f00\u542f\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e # \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8d44\u6e90\u5bf9\u8c61\uff0c\u547d\u540d\u4e3a nginx-lb\uff0cpod \u6570\u91cf\u6307\u5b9a\u4e3a 2 \u4e2a # kubectl create deployment nginx-lb --image=docker.io/nginx:latest --replicas=2 deployment.apps/nginx-lb created # \u4f7f\u7528\u521a\u521a\u521b\u5efa\u7684 nginx-lb \u521b\u5efa\u65b0\u7684 services # kubectl expose deployment nginx-lb --type=LoadBalancer --port=80 service/nginx-lb exposed # sudoers \u6587\u4ef6\u4e2d\u6dfb\u52a0 minikube\uff0croot \u7528\u6237\u4e0b\u6267\u884c sudoedit /etc/sudoers # \u4e3a\u7528\u6237 minikube \u521b\u5efa\u4e00\u4e2a\u5bc6\u7801 passwd minikube # \u5f00\u542f\u8d1f\u8f7d\u5747\u8861 minikube tunnel # \u8d1f\u8f7d\u5747\u8861\u72b6\u6001\u8f93\u51fa Status: machine: minikube pid: 257973 route: 10 .96.0.0/12 -> 192 .168.49.2 minikube: Running services: [ nginx-lb ] errors: minikube: no errors router: no errors loadbalancer emulator: no errors","title":"\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861"},{"location":"Chapter04/chapter04/#_13","text":"\u81f3\u6b64\u6211\u4eec\u5df2\u7ecf\u5b66\u4e60\u4e86\u4f7f\u7528 Minikube \u642d\u5efa\u5355\u8282\u70b9\u96c6\u7fa4\u8bfe\u7a0b\u3001\u4e86\u89e3\u4e86\u57fa\u672c\u7684 K8s \u5e38\u7528\u7684\u64cd\u4f5c\u547d\u4ee4\uff0c\u5e76\u5b9e\u65bd\u90e8\u7f72\u4e86\u4e00\u6b21\u670d\u52a1\u642d\u5efa\uff0c\u4e4b\u540e\u7684\u8bfe\u7a0b\u6211\u4eec\u8bb2\u56f4\u7ed5 K8s \u7684\u5173\u952e\u7ec4\u4ef6\u8fdb\u884c\u66f4\u52a0\u7ec6\u81f4\u7684\u5b66\u4e60\uff0c\u6b22\u8fce\u7ee7\u7eed\u8fdb\u884c\u9605\u8bfb","title":"\u7ed3\u8bed"},{"location":"Chapter05/chapter05/","text":"Kubernetes \u5bb9\u5668","title":"Kubernetes \u5bb9\u5668"},{"location":"Chapter05/chapter05/#kubernetes","text":"","title":"Kubernetes \u5bb9\u5668"},{"location":"Chapter06/chapter06/","text":"Kubernetes \u5de5\u4f5c\u8d1f\u8f7d","title":"Kubernetes \u5de5\u4f5c\u8d1f\u8f7d"},{"location":"Chapter06/chapter06/#kubernetes","text":"","title":"Kubernetes \u5de5\u4f5c\u8d1f\u8f7d"},{"location":"Chapter07/chapter07/","text":"Kubernetes \u7f51\u7edc\u6a21\u578b","title":"Kubernetes \u7f51\u7edc\u6a21\u578b"},{"location":"Chapter07/chapter07/#kubernetes","text":"","title":"Kubernetes \u7f51\u7edc\u6a21\u578b"},{"location":"Chapter08/chapter08/","text":"Kubernetes \u670d\u52a1","title":"Kubernetes \u670d\u52a1"},{"location":"Chapter08/chapter08/#kubernetes","text":"","title":"Kubernetes \u670d\u52a1"},{"location":"Chapter09/chapter09/","text":"Kubernetes \u8d1f\u8f7d\u5747\u8861","title":"Kubernetes \u8d1f\u8f7d\u5747\u8861"},{"location":"Chapter09/chapter09/#kubernetes","text":"","title":"Kubernetes \u8d1f\u8f7d\u5747\u8861"},{"location":"Chapter10/chapter10/","text":"Kubernetes \u5377\u7ba1\u7406","title":"Kubernetes \u5377\u7ba1\u7406"},{"location":"Chapter10/chapter10/#kubernetes","text":"","title":"Kubernetes \u5377\u7ba1\u7406"},{"location":"Chapter11/chapter11/","text":"Kubernetes ConfigMap","title":"Kubernetes ConfigMap"},{"location":"Chapter11/chapter11/#kubernetes-configmap","text":"","title":"Kubernetes ConfigMap"},{"location":"Chapter12/chapter12/","text":"Kubernetes Secret","title":"Kubernetes Secret"},{"location":"Chapter12/chapter12/#kubernetes-secret","text":"","title":"Kubernetes Secret"},{"location":"Chapter13/chapter13/","text":"Kubernetes \u8d44\u6e90\u7ba1\u7406","title":"Kubernetes \u8d44\u6e90\u7ba1\u7406"},{"location":"Chapter13/chapter13/#kubernetes","text":"","title":"Kubernetes \u8d44\u6e90\u7ba1\u7406"},{"location":"Chapter14/chapter14/","text":"Kubernetes \u8c03\u5ea6","title":"Kubernetes \u8c03\u5ea6"},{"location":"Chapter14/chapter14/#kubernetes","text":"","title":"Kubernetes \u8c03\u5ea6"},{"location":"Chapter15/chapter15/","text":"Kubernetes \u6700\u4f73\u5b9e\u8df5","title":"Kubernetes \u5b9e\u8df5\u624b\u518c"},{"location":"Chapter15/chapter15/#kubernetes","text":"","title":"Kubernetes \u6700\u4f73\u5b9e\u8df5"},{"location":"about/changelog/","text":"Changelog \u672c\u9875\u9762\u4e3b\u8981\u8bb0\u5f55\u6587\u6863\u6846\u67b6\u7684\u53d8\u52a8\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7ee7\u627f TAM-Wiki \u9879\u76ee 20221022 - PALETTE AUTOCHANGE \u6dfb\u52a0\u767d\u5929\u9ed1\u591c\u81ea\u52a8\u5207\u6362 20221022 - INITIAL DOCS \u8bbe\u8ba1\u6587\u6863\u5927\u7eb2\u76ee\u5f55\uff0c\u65b9\u4fbf\u4ece\u6e90\u7801\u8fdb\u884c\u67e5\u9605 20221018 - ADD CHANGELOG \u589e\u52a0\u66f4\u65b0\u65e5\u5fd7\uff0c\u5e76\u540c\u6b65\u5230\u9876\u90e8\u516c\u544a\u680f","title":"\u66f4\u65b0\u65e5\u5fd7"},{"location":"about/changelog/#changelog","text":"\u672c\u9875\u9762\u4e3b\u8981\u8bb0\u5f55\u6587\u6863\u6846\u67b6\u7684\u53d8\u52a8\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7ee7\u627f TAM-Wiki \u9879\u76ee","title":"Changelog"},{"location":"about/changelog/#20221022-palette-autochange","text":"\u6dfb\u52a0\u767d\u5929\u9ed1\u591c\u81ea\u52a8\u5207\u6362","title":"\n  \n 20221022 - PALETTE AUTOCHANGE"},{"location":"about/changelog/#20221022-initial-docs","text":"\u8bbe\u8ba1\u6587\u6863\u5927\u7eb2\u76ee\u5f55\uff0c\u65b9\u4fbf\u4ece\u6e90\u7801\u8fdb\u884c\u67e5\u9605","title":"\n  \n 20221022 - INITIAL DOCS"},{"location":"about/changelog/#20221018-add-changelog","text":"\u589e\u52a0\u66f4\u65b0\u65e5\u5fd7\uff0c\u5e76\u540c\u6b65\u5230\u9876\u90e8\u516c\u544a\u680f","title":"\n  \n 20221018 - ADD CHANGELOG"},{"location":"about/contact/","text":"building...","title":"\u8054\u7cfb\u6211\u4eec"},{"location":"about/license/","text":"\u8bb8\u53ef\u4fe1\u606f \u5185\u5bb9\u8bb8\u53ef \u672c\u6587\u6863\u7684\u5185\u5bb9\u7531 ProjectTAM \u6240\u6709\uff0c\u91c7\u7528 \u77e5\u8bc6\u5171\u4eab\u7f72\u540d 4.0 \u56fd\u9645\u8bb8\u53ef\u534f\u8bae \u8fdb\u884c\u8bb8\u53ef\uff0c\u4f46\u53e6\u6709\u8bf4\u660e\u7684\u90e8\u5206\u6216\u5f15\u7528\u90e8\u5206\u9664\u5916 \u4ee3\u7801\u8bb8\u53ef \u672c\u6587\u6863\u7684\u4ee3\u7801\u91c7\u7528 MIT \u8bb8\u53ef\u8bc1\u6388\u6743\uff0c\u5176\u6761\u6b3e\u5982\u4e0b\uff1a The MIT License (MIT) Copyright (c) 2022 ProjectTAM Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. \u7b2c\u4e09\u65b9\u4ee3\u7801\u8bb8\u53ef \u672c\u6587\u6863\u4f7f\u7528\u4e86\u90e8\u5206\u7b2c\u4e09\u65b9\u4ee3\u7801\uff0c\u5176\u8bb8\u53ef\u8bc1\u5982\u4e0b\u8868\u5217\u793a\uff0c\u5e94\u89c6\u4e3a\u901a\u8fc7\u5f15\u8ff0\u7684\u65b9\u5f0f\u6210\u4e3a\u672c\u8282\u7684\u4e00\u90e8\u5206\uff1a \u9879\u76ee \u8bb8\u53ef\u8bc1 MkDocs BSD \u8bb8\u53ef\u8bc1 Material for MkDocs MIT \u8bb8\u53ef\u8bc1 Bootstrap Icons MIT \u8bb8\u53ef\u8bc1 Octicons \u81ea\u5b9a\u4e49\u8bb8\u53ef\u8bc1 Material Design Icons Pictogrammers Free License","title":"\u8bb8\u53ef\u534f\u8bae"},{"location":"about/license/#_1","text":"","title":"\u8bb8\u53ef\u4fe1\u606f"},{"location":"about/license/#_2","text":"\u672c\u6587\u6863\u7684\u5185\u5bb9\u7531 ProjectTAM \u6240\u6709\uff0c\u91c7\u7528 \u77e5\u8bc6\u5171\u4eab\u7f72\u540d 4.0 \u56fd\u9645\u8bb8\u53ef\u534f\u8bae \u8fdb\u884c\u8bb8\u53ef\uff0c\u4f46\u53e6\u6709\u8bf4\u660e\u7684\u90e8\u5206\u6216\u5f15\u7528\u90e8\u5206\u9664\u5916","title":"\u5185\u5bb9\u8bb8\u53ef"},{"location":"about/license/#_3","text":"\u672c\u6587\u6863\u7684\u4ee3\u7801\u91c7\u7528 MIT \u8bb8\u53ef\u8bc1\u6388\u6743\uff0c\u5176\u6761\u6b3e\u5982\u4e0b\uff1a The MIT License (MIT) Copyright (c) 2022 ProjectTAM Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"\u4ee3\u7801\u8bb8\u53ef"},{"location":"about/license/#_4","text":"\u672c\u6587\u6863\u4f7f\u7528\u4e86\u90e8\u5206\u7b2c\u4e09\u65b9\u4ee3\u7801\uff0c\u5176\u8bb8\u53ef\u8bc1\u5982\u4e0b\u8868\u5217\u793a\uff0c\u5e94\u89c6\u4e3a\u901a\u8fc7\u5f15\u8ff0\u7684\u65b9\u5f0f\u6210\u4e3a\u672c\u8282\u7684\u4e00\u90e8\u5206\uff1a \u9879\u76ee \u8bb8\u53ef\u8bc1 MkDocs BSD \u8bb8\u53ef\u8bc1 Material for MkDocs MIT \u8bb8\u53ef\u8bc1 Bootstrap Icons MIT \u8bb8\u53ef\u8bc1 Octicons \u81ea\u5b9a\u4e49\u8bb8\u53ef\u8bc1 Material Design Icons Pictogrammers Free License","title":"\u7b2c\u4e09\u65b9\u4ee3\u7801\u8bb8\u53ef"}]}